/* StreamRoot - v3.0.12 - 2016-04-28
* www.streamroot.io
* Copyright (c) 2016 StreamRoot */ 

(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.Streamroot || (g.Streamroot = {})).Downloader = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Conf=function(){this.SIGNALING_URL="wss://sig.streamroot.io/websocket/",this.TRACKER_URL="https://tracker.streamroot.io",this.ERRORS_URL="https://errors.streamroot.io",this.CLIENT_TRACKER_PROTOCOL_VERSION="2.0.0",this.ANALYTICS_RETRY_NUMBER=3,this.ANALYTICS_RETRY_DELAY=1e4,this.ANALYTICS_SERVER_URL="https://klara.streamroot.io",this.CHUNK_SIZE=15360,this.P2P_CACHE_MAX_SIZE=136314880,this.GETSEGMENTTIME_CACHE_MAX_SIZE=200,this.MAX_DL_REQUEST_SPEED=1e3,this.TIME_BETWEEN_CHUNK_DL=50,this.NB_CHUNK_DL_GROUP=10,this.MAX_CHUNK_BY_SEEDER=300,this.NB_SEGMENT_P2P_PREBUFFER=6,this.MAX_SEGMENT_REQUEST_STORE=this.NB_SEGMENT_P2P_PREBUFFER,this.NB_SEGMENT_P2P_SKIP=2,this.MAX_BUFFER_DURATION=300,this.MAX_UP_SPEED=600,this.CHUNK_UP_RETRY_DELAY=10,this.PEER_CONNECTION_TIMEOUT=5e4,this.PEER_UP_TIMEOUT=5e3,this.SEND_HEARTBEAT_INTERVAL=5e3,this.CHECK_HEARTBEAT_INTERVAL=1e4,this.MAX_USELESS_COUNT=100,this.MIN_USEFUL_SPEED=5,this.MIN_NUMBER_OF_PEERS=8,this.MAX_NUMBER_OF_PEERS=13,this.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE=10,this.ASK_PEERS_INTERVAL=6e4,this.CHECK_USELESS_INTERVAL=6e4,this.SPEED_MONITOR_INTERVAL=1e3,this.MEAN_SPEED_CALCULATION_INTERVAL=500,this.CHUNK_TIMEOUT=2500,this.CHUNK_UP_TIMEOUT=this.CHUNK_TIMEOUT-600,this.ICECANDIDATES_TIMEOUT=1e3,this.UP_MAX_BUFFERED_AMOUNT=10,this.OFFER_DECLINED_TIMEOUT=6e4,this.PEER_REMOVED_TIMEOUT=9e5,this.PEER_CONNEXION_ATTEMPT_TIMEOUT=9e5,this.GEOLOCATION_REQUEST_TIMEOUT=3e3,this.GEOLOCATION_REQUEST_MAX_RETRY=1,this.MAX_P2P_PREBUFFERING_TIME=720,this.RETRY_P2P_START_DL_SEGMENT_DELAY=5e3,this.ANALYTICS={DOWNLOAD_TRACK_INTERVAL:12e4,LATENCIES_TRACK_INTERVAL:3e5},this.RY_TRACK=!0,this.RY_TRACKER="srTracker",this.ABR_DEL_T=30,this.LIVE={P2P_CACHE_MAX_SIZE:62914560},this.ENABLE_TURN=!1,this.STUNSERVERS=[{urls:"stun:stun.l.google.com:19302"}],this.TURNSERVERS=[{urls:"turn:23.97.160.254:3478?transport=udp",credential:"streamroot",username:"streamroot"}],this.ALLOW_P2P=!0,this.RANGE_REQUEST_ALLOWED=!0,this.DISPLAY_ERROR=!1,this.PEER_INSTANT_SPEED_CALCULATION_INTERVAL=100,this.PEER_INSTANT_SPEED_CALCULATION_WINDOW=1e4,this.PEER_COMPUTE_RTT_INTERVAL=5e3,this.USE_SIGNALING_SERVER=!0,this.SIGNALING_DELAY_STEP=2e3,this.SIGNALING_DELAY_MAX=3e5,this.LOCKED_RETRY_INTERVAL=30,this.LOCKED_RETRY_TIMEOUT=this.TIMEOUT_GET_FULL_SEGMENT=500,this.RETURN_COPY_SEGMENT=!0},conf=new Conf;exports["default"]=conf,module.exports=exports["default"];

},{}],2:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _MetricSender=_dereq_("./MetricSender"),_MetricSender2=_interopRequireDefault(_MetricSender),_conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),rand1=Math.random().toString().substring(2),rand2=Math.random().toString().substring(2),rand3=Math.random().toString().substring(2);window.Streamroot=window.Streamroot||{},window.Streamroot.klaraToken=window.Streamroot.klaraToken||rand1+rand2+rand3;var AnalyticsClient=function(){function e(r){var t=r.serverURL,n=r.clientID,a=r.content,i=r.namespace;_classCallCheck(this,e),this._serverURL=t||_conf2["default"].ANALYTICS_SERVER_URL,this._clientID=n,this._namespace=i,this._content=a}return _createClass(e,[{key:"track",value:function(e,r){r.customer=this._clientID,r.content=this._content,r.label=e,r.version="3.0.12",r.token=window.Streamroot.klaraToken;var t=JSON.stringify(r),n=this._serverURL+"/"+this._namespace,a=new _MetricSender2["default"](n,t);a.send(t)}}]),e}();exports["default"]=AnalyticsClient,module.exports=exports["default"];

},{"../../conf":1,"./MetricSender":4,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/interop-require-default":92}],3:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_AnalyticsClient=_dereq_("./AnalyticsClient"),_AnalyticsClient2=_interopRequireDefault(_AnalyticsClient),ErrorAnalytics=function(){function e(r){_classCallCheck(this,e);var t=new _AnalyticsClient2["default"]({serverURL:_conf2["default"].ERRORS_URL,clientID:_conf2["default"].ID_CLIENT,content:r,namespace:"errors"}),n=function l(e){var r={origin:"browser",version:"3.0.12",message:e.message,url:e.filename,line:e.lineno,column:e.colno};window.removeEventListener("error",l),t.track("error",r)};window.addEventListener("error",n),this._errorHandler=n}return _createClass(e,[{key:"dispose",value:function(){window.removeEventListener("error",this._errorHandler)}}]),e}();exports["default"]=ErrorAnalytics,module.exports=exports["default"];

},{"../../conf":1,"./AnalyticsClient":2,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/interop-require-default":92}],4:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),MetricSender=function(){function e(t,r){_classCallCheck(this,e),this._serverURL=t,this._payload=r,this._retryCount=0}return _createClass(e,[{key:"_retry",value:function(){this._retryCount<_conf2["default"].ANALYTICS_RETRY_NUMBER&&setTimeout(this.send.bind(this),_conf2["default"].ANALYTICS_RETRY_DELAY)}},{key:"_onLoad",value:function(e){e.target.status>=500&&e.target.status<600&&this._retry()}},{key:"_onError",value:function(){this._retry()}},{key:"send",value:function(){var e=new XMLHttpRequest;e.open("POST",this._serverURL),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.onload=this._onLoad.bind(this),e.onerror=this._onError.bind(this),e.send(this._payload),this._retryCount++}}]),e}();exports["default"]=MetricSender,module.exports=exports["default"];

},{"../../conf":1,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/interop-require-default":92}],5:[function(_dereq_,module,exports){
(function (global){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_underscore=_dereq_("underscore"),_underscore2=_interopRequireDefault(_underscore),_p2pStatus=_dereq_("../p2p/status"),_p2pStatus2=_interopRequireDefault(_p2pStatus),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),_AnalyticsClient=_dereq_("./AnalyticsClient"),_AnalyticsClient2=_interopRequireDefault(_AnalyticsClient),_ErrorAnalytics=_dereq_("./ErrorAnalytics"),_ErrorAnalytics2=_interopRequireDefault(_ErrorAnalytics),_p2pGlobalEventBus=_dereq_("../p2p/GlobalEventBus"),_p2pGlobalEventBus2=_interopRequireDefault(_p2pGlobalEventBus),_utilsDelta=_dereq_("../utils/Delta"),_utilsObjectHelper=_dereq_("../utils/ObjectHelper"),VideoAnalytics=function(t,e,a,n,i,s){this._playerInterface=t,this.externalEventManager=e,this.apiStartTimestamp=Date.now(),this._timers=new _utilsTimers2["default"],this._p2pCache=n,this.peerPool=i,this.p2pDownloader=s,this.mediaStats="function"==typeof t.getMediaStats?t.getMediaStats():void 0,this.content=a,this.alreadyPlayed=!1,this.lastP2PDownloaded=0,this.lastP2PDownloadedNewAnalytics=0,this.lastP2PUploaded=0,this.lastCDNDownloaded=0,this.lastCDNCancelled=0,this.lastP2PDownloadedUncorrected=0,this.lastDataDlTwice=0,this.lastDataDlTwice_PP=0,this.lastDataDlTwice_PC=0,this.lastDataDlTwice_CP=0,this.lastDataDlTwice_CC=0,this.lastDataDlTwice_HP=0,this.lastDataDlTwice_HD=0,this.lastDataDlTwice_M=0,this.lastMinSwitchCount=0,this.lastLowerSwitchCount=0,this.lastUpperSwitchCount=0,this.lastInternalTrackSwitchCount=0,this.lastTrackerMsgCount=0,this.lastTrackerSgnCount=0,this.peerUpdateRequestDelta=new _utilsDelta.Delta,this.peerUpdateResponseDelta=new _utilsDelta.Delta,this.missedIceCandidateDelta=new _utilsDelta.Delta,this.newPeerConnectionCountDelta=new _utilsDelta.Delta,this.droppedFramesDelta=new _utilsDelta.Delta,this.downloadTrackCounter=0,this.uploadSaturation=0,this.sumDistance=0,this.maxDistance=0,this.nbDistance=0,this.peerConnecting=[],this.isUnloadPayloadSent=!1,this._timers.setInterval(this.sendDownloadAnalytics.bind(this),_conf2["default"].ANALYTICS.DOWNLOAD_TRACK_INTERVAL),global.RY=function(t){var e=["identify","track","page"],a="realytics",n=function(t,e){return function(){var a=Array.prototype.slice.call(arguments);t[e]||(t[e]=[]),t[e].push(a)}},i=function(i){for(var s=0;s<e.length;s++){var r=e[s];i?t[i][r]=n(t._q[i],r):t[r]=t[a][r]=n(t._q[a],r)}},s=function r(e,n){var r=e?e:a;t[r]||(t[r]={}),t._q[r]||(t._q[r]={}),n&&(t._q[r].init=[[n]]),i(e)};return t._q||(t._q={},s(null,null)),t.init=function(t,a){if(a&&e)for(var n=0;n<e.length;n++)if(a==e[n]||"init"==a)return;s(a,t);var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=("https:"==document.location.protocol?"https://":"http://")+"dcniko1cv0rz.cloudfront.net/realytics-0.2.min.js";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(i,r)},t}(global.RY||{}),RY.init(_conf2["default"].ID_CLIENT,_conf2["default"].RY_TRACKER),this.realytics_count=0,this.analyticsSender=new _AnalyticsClient2["default"]({clientID:_conf2["default"].ID_CLIENT,content:this.content,namespace:"viewers"}),this.errorAnalytics=new _ErrorAnalytics2["default"](this.content),this.externalEventManager.addWindowEventListener("beforeunload",this.onUnload.bind(this)),this.externalEventManager.addWindowEventListener("unload",this.onUnload.bind(this)),_p2pStatus2["default"].getEE().once("tracker_ready",this.onTrackerReady.bind(this)),_p2pStatus2["default"].getEE().once("tracker_ready",this.trackKlaraTrackerInit.bind(this)),this.track_realytics("video views"),_p2pGlobalEventBus2["default"].on("uploadSaturated",this.incrementUploadSaturation.bind(this))};VideoAnalytics.prototype.trackKlaraTrackerInit=function(){var t={trackerConnectionTime:_p2pStatus2["default"].getTrackerConnectionTime(),trackerConnected:1};this.analyticsSender.track("init",t)},VideoAnalytics.prototype.track_realytics=function(t,e,a){e=e||{},e.customerID="Integros",e.mpdURL=this.content,a&&(e.conf={p2pMaxCacheSize:_conf2["default"].P2P_CACHE_MAX_SIZE,maxDlRequestSpeed:_conf2["default"].MAX_DL_REQUEST_SPEED,maxChunkBySeed:_conf2["default"].MAX_CHUNK_BY_SEEDER,nbSegmentP2PPrebuffer:_conf2["default"].NB_SEGMENT_P2P_PREBUFFER,maxUpSpeed:_conf2["default"].MAX_UP_SPEED,chunkUpRetryDelay:_conf2["default"].CHUNK_UP_RETRY_DELAY,chunkTimeout:_conf2["default"].CHUNK_TIMEOUT,chunkUpTimeout:_conf2["default"].CHUNK_UP_TIMEOUT}),_conf2["default"].RY_TRACK&&(t+="1",RY.srTracker.track(t,e)),this.realytics_count++},VideoAnalytics.prototype.trackKlaraGlobal=function(t,e){var a=t.doubleDl;a.total=a.totalDlTwice,delete a.totalDlTwice;var n;t.peers&&(n={seeders:t.peers.seeders,leechers:t.peers.leechers,total:t.peers.totalPeers,useless:t.peers.uselessPeers,ready:t.peers.peerReady});var i=this.getPeersDetails(),s={id:_p2pStatus2["default"].getMyPeerId(),p2p:t.nP2p,cdn:t.cdn,upload:t.up,rawP2p:t.p2pUncorrected,multipleDl:a,fullP2P:e,peers:n,peersDetails:i,p2pSgtCheckSuccess:t.nbRightHashP2P,p2pSgtCheckFail:t.nbWrongHashP2P,hybridSgtCheckSuccess:t.nbRightHashDLM,hybridSgtCheckFail:t.nbWrongHashDLM,trackSwitchCount:t.abr.internalTrackSwitchCount,droppedFrameCount:t.droppedFrameCount,trackerConnected:t.trackerConnected,trackerUpgraded:t.trackerUpgraded,signalingServerConnected:t.signalingServerConnected,meanMissedIceCandidate:t.missedIceCandidateRate,newPeerConnectionCount:t.newPeerConnectionCount,counter:t.downloadTrackCounter,live:this._playerInterface.isLive()};this.analyticsSender.track("global",s)},VideoAnalytics.prototype.trackKlaraUnload=function(t){var e;t.qos.percentageTimeSpentPlaying&&(e=100-t.qos.percentageTimeSpentPlaying);var a;t.qos.avgBitrate&&(a=Math.round(1e3*t.qos.avgBitrate));var n={startup:t.qos.startupTime,rebuffering:e,avgBitrate:a,live:this._playerInterface.isLive(),dispose:!!t.dispose};this.analyticsSender.track("unload",n)},VideoAnalytics.prototype.sendDownloadAnalytics=function(){var t=_p2pStatus2["default"].getP2PDownloaded(),e=_p2pStatus2["default"].getp2pDownloadedNewAnalytics(),a=0>t?1:0,n=_p2pStatus2["default"].getP2PUploaded(),i=_p2pStatus2["default"].getCDNDownloaded(),s=_p2pStatus2["default"].getCdnCancelled(),r=_p2pStatus2["default"].getP2PDownloadedUncorrected(),o=_p2pStatus2["default"].getDataDownloadedTwice_PP(),l=_p2pStatus2["default"].getDataDownloadedTwice_PC(),d=_p2pStatus2["default"].getDataDownloadedTwice_CP(),c=_p2pStatus2["default"].getDataDownloadedTwice_CC(),u=_p2pStatus2["default"].getDataDownloadedTwice_HP(),p=_p2pStatus2["default"].getDataDownloadedTwice_HD(),h=_p2pStatus2["default"].getDataDownloadedTwice_M(),D=o+l+d+c+u+p+h,_=t-this.lastP2PDownloaded,f=e-this.lastP2PDownloadedNewAnalytics,C=n-this.lastP2PUploaded,S=i-this.lastCDNDownloaded,w=s-this.lastCDNCancelled,g=r-this.lastP2PDownloadedUncorrected,P=o-this.lastDataDlTwice_PP,y=l-this.lastDataDlTwice_PC,T=d-this.lastDataDlTwice_CP,m=c-this.lastDataDlTwice_CC,k=u-this.lastDataDlTwice_HP,v=p-this.lastDataDlTwice_HD,R=h-this.lastDataDlTwice_M,A=D-this.lastDataDlTwice,U=_p2pStatus2["default"].getNbRightHashP2P(),b=_p2pStatus2["default"].getNbWrongHashP2P(),M=_p2pStatus2["default"].getNbRightHashDLM(),E=_p2pStatus2["default"].getNbWrongHashDLM();_p2pStatus2["default"].setNbRightHashP2P(0),_p2pStatus2["default"].setNbWrongHashP2P(0),_p2pStatus2["default"].setNbRightHashDLM(0),_p2pStatus2["default"].setNbWrongHashDLM(0);var q=this.trackPeers(),H=this.trackTracker(),N=_p2pStatus2["default"].getConnectedToSignalingServer(),I=this.missedIceCandidateDelta.calcDelta(_p2pStatus2["default"].getMissedIceCandidateCount()),L=this.newPeerConnectionCountDelta.calcDelta(_p2pStatus2["default"].getNewPeerConnectionCount()),V=I?I/L:0;L===_p2pStatus2["default"].getNewPeerConnectionCount()&&(L=void 0);var B=this.trackABR(),x=0;if(this.mediaStats){var K=this.mediaStats.getStats();K.droppedFrameCount&&(x=this.droppedFramesDelta.calcDelta(this.mediaStats.getStats().droppedFrameCount))}var F=_p2pStatus2["default"].getConnected()?1:0,O=_p2pStatus2["default"].getUpgraded()?1:0;this.lastP2PDownloaded=t,this.lastP2PDownloadedNewAnalytics=e,this.lastP2PUploaded=n,this.lastCDNDownloaded=i,this.lastDataDlTwice=D;var W={missedIceCandidateRate:V,newPeerConnectionCount:L,p2p:_,nP2p:f,cdn:S,cdnCancelled:w,totalDl:_+S,up:C,p2pUncorrected:g,doubleDl:{PP:P,PC:y,CP:T,CC:m,HP:k,HD:v,M:R,totalDlTwice:A},testP2PNegative:a,peers:q,nbRightHashP2P:U,nbWrongHashP2P:b,nbRightHashDLM:M,nbWrongHashDLM:E,avgDistance:this.nbDistance>0?this.sumDistance/this.nbDistance:0,maxDistance:this.maxDistance,uploadSaturation:this.uploadSaturation,abr:B,tracker:H,droppedFrameCount:x,trackerConnected:F,trackerUpgraded:O,downloadTrackCounter:this.downloadTrackCounter,signalingServerConnected:N};this.track_realytics("download",W,!0),this.trackKlaraGlobal(W,t),this.lastCDNCancelled=s,this.lastP2PDownloadedUncorrected=r,this.lastDataDlTwice_PP=o,this.lastDataDlTwice_PC=l,this.lastDataDlTwice_CP=d,this.lastDataDlTwice_CC=c,this.lastDataDlTwice_HP=u,this.lastDataDlTwice_HD=p,this.lastDataDlTwice_M=h,this.uploadSaturation=0,this.downloadTrackCounter++},VideoAnalytics.prototype.trackSpeed=function(){return{avgDl:Math.round(_p2pStatus2["default"].getAvgDlSpeed()),maxDl:Math.round(_p2pStatus2["default"].getMaxDlSpeed()),avgUp:Math.round(_p2pStatus2["default"].getAvgUpSpeed()),maxUp:Math.round(_p2pStatus2["default"].getMaxUpSpeed())}},VideoAnalytics.prototype.incrementUploadSaturation=function(){this.uploadSaturation++},VideoAnalytics.prototype.sendUnloadPayload=function(t){if(this.p2pDownloader){this.sendDownloadAnalytics();var e=_p2pStatus2["default"].getP2PDownloaded(),a=_p2pStatus2["default"].getp2pDownloadedNewAnalytics(),n=_p2pStatus2["default"].getP2PUploaded(),i=_p2pStatus2["default"].getCDNDownloaded(),s=_p2pStatus2["default"].getP2PDownloadedUncorrected(),r=_p2pStatus2["default"].getDataDownloadedTwice_PP(),o=_p2pStatus2["default"].getDataDownloadedTwice_PC(),l=_p2pStatus2["default"].getDataDownloadedTwice_CP(),d=_p2pStatus2["default"].getDataDownloadedTwice_CC(),c=_p2pStatus2["default"].getDataDownloadedTwice_HP(),u=_p2pStatus2["default"].getDataDownloadedTwice_HD(),p=_p2pStatus2["default"].getDataDownloadedTwice_M(),h=r+o+l+d+c+u+p,D=this._p2pCache.doubleCheckP2PDownload_CDNDownload(),_=D.p2pDownloaded+D.cdnDownloaded,f=this.trackPeers(),C=this.trackSpeed(),S=this.trackTrackerConnection(),w=this.getRandomPeerLatency(),g=this.trackQoS(),P={timeBeforeTrackerReady:this.timeBeforeTrackerReady,p2p:e,nP2p:a,cdn:i,totalDl:e+i,up:n,p2pUncorrected:s,doubleDl:{PP:r,PC:o,CP:l,CC:d,HP:c,HD:u,M:p,totalDlTwice:h},tracker:{peerUpdateRequestCount:_p2pStatus2["default"].getPeerUpdateRequestCount(),peerUpdateResponseCount:_p2pStatus2["default"].getPeerUpdateResponseCount()},qos:g,connection:S,p2pCache:_,speeds:C,peers:f,peerConnectionLatency:w,dispose:t?1:0};this.trackKlaraUnload(P),this.track_realytics("unload",P,!0),this.isUnloadPayloadSent=!0}},VideoAnalytics.prototype.onUnload=function(t){this.isUnloadPayloadSent||this.sendUnloadPayload(!t)},VideoAnalytics.prototype.onTrackerReady=function(){this.timeBeforeTrackerReady=Date.now()-this.apiStartTimestamp},VideoAnalytics.prototype.trackPeers=function(){if(this.peerPool){var t=0,e=0,a=0,n=0,i=0;return _underscore2["default"].each(this.peerPool.getPeerArray(),function(s){a++,i++;var r=!0;s.getDataDownloaded()&&(t++,r=!1),s.getDataUploaded()&&(e++,r=!1),r&&n++},this),{seeders:t,leechers:e,totalPeers:a,uselessPeers:n,peerReady:i}}},VideoAnalytics.prototype.getPeersDetails=function(){if(this.peerPool){var t=[];return this.peerPool.getPeerArray().forEach(function(e){t.push({id:e.getId(),downloaded:e.getDataDownloaded(),uploaded:e.getDataUploaded(),bufferLevel:e.getBufferLevel(),rtt:e.getRtt()})}),t}},VideoAnalytics.prototype.findPeer=function(t){var e=_underscore2["default"].where(this.peerConnecting,{peer:t});return e.length?e[0]:!1},VideoAnalytics.prototype.getRandomPeerLatency=function(t){var e=_underscore2["default"].filter(this.peerConnecting,function(t){return t.timestampAnswer&&t.timeStampReady});if(e.length){var a=e[Math.floor(Math.random()*e.length)];return{answer:a.timestampAnswer-a.timestampOffer,ready:a.timeStampReady-a.timestampOffer,distance:a.peer.getDistance()}}return void 0},VideoAnalytics.prototype.trackABR=function(){var t,e=_p2pStatus2["default"].getTrackSwitchCount(),a={minSwitchCount:0,lowerSwitchCount:0,upperSwitchCount:0};this.mediaStats&&(t=this.mediaStats.getStats(),a=_utilsObjectHelper.overrideDefaults(a,t));var n=a.minSwitchCount-this.lastMinSwitchCount,i=a.lowerSwitchCount-this.lastLowerSwitchCount,s=a.upperSwitchCount-this.lastUpperSwitchCount,r=e-this.lastInternalTrackSwitchCount;return this.lastMinSwitchCount=a.minSwitchCount,this.lastLowerSwitchCount=a.lowerSwitchCount,this.lastUpperSwitchCount=a.upperSwitchCount,this.lastInternalTrackSwitchCount=e,{minSwitchCount:n,lowerSwitchCount:i,upperSwitchCount:s,internalTrackSwitchCount:r}},VideoAnalytics.prototype.trackQoS=function(){var t,e=_p2pStatus2["default"].getTrackSwitchCount(),a={startupTime:0,startupTimeLoad:0,rebufferingCount:0,timeSpentRebuffering:0,timeSpentPlaying:0,timeSpentSeeking:0,percentageTimeSpentPlaying:0,avgBitrate:0,bitrateSwitchCount:0,minSwitchCount:0,lowerSwitchCount:0,upperSwitchCount:0};return this.mediaStats&&(t=this.mediaStats.getStats(),a=_utilsObjectHelper.overrideDefaults(a,t)),a.internalTrackSwitchCount=e,a},VideoAnalytics.prototype.trackTracker=function(){var t=_p2pStatus2["default"].getTrackerMsgCount(),e=_p2pStatus2["default"].getTrackerSgnCount(),a=t-this.lastTrackerMsgCount,n=e-this.lastTrackerSgnCount;return this.lastTrackerMsgCount=t,this.lastTrackerSgnCount=e,{trackerMsgCount:a,trackerSgnCount:n,peerUpdateRequestCount:this.peerUpdateRequestDelta.calcDelta(_p2pStatus2["default"].getPeerUpdateRequestCount()),peerUpdateResponseCount:this.peerUpdateResponseDelta.calcDelta(_p2pStatus2["default"].getPeerUpdateResponseCount()),peerUpdateAvgRespTime:Math.round(_p2pStatus2["default"].getPeerUpdateAvgResponseTime())}},VideoAnalytics.prototype.trackTrackerConnection=function(){var t=_p2pStatus2["default"].getTrackerConnectionCount(),e=_p2pStatus2["default"].getTrackerDeconnectionCount(),a=_p2pStatus2["default"].getTrackerReconnectionCount();return{trackerConnectionCount:t,trackerDeconnectionCount:e,trackerReconnectionCount:a}},VideoAnalytics.prototype.dispose=function(){this.onUnload();var t=document.querySelectorAll('script[src*="realytics"');this._timers.clearAll();for(var e=0;e<t.length;e++)t[e].remove();delete this.peerPool,delete window.RY,this.errorAnalytics.dispose()},VideoAnalytics.prototype.isFake=function(){return this.fake},exports["default"]=VideoAnalytics,module.exports=exports["default"];

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../../conf":1,"../p2p/GlobalEventBus":14,"../p2p/status":45,"../utils/Delta":56,"../utils/ObjectHelper":58,"../utils/Timers":61,"./AnalyticsClient":2,"./ErrorAnalytics":3,"babel-runtime/helpers/interop-require-default":92,"underscore":239}],6:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _TimedValue=_dereq_("./TimedValue"),_TimedValue2=_interopRequireDefault(_TimedValue),MovingAverage=function(e){var t=[],r=e,u=function(){for(var e=-1,u=Date.now(),i=0;i<t.length&&u-t[i].timestamp()>r;i++)e=i;return e},i=function(){var e=u();e>-1&&t.splice(0,e+1)},a=function(e){if(0!==e){i();var r=new _TimedValue2["default"](e);t.push(r)}},n=function(){if(i(),!t.length)return 0;for(var e=0,r=0;r<t.length;r++)e+=t[r].value();return e/t.length};this.addPoint=a,this.compute=n};exports["default"]=MovingAverage,module.exports=exports["default"];

},{"./TimedValue":7,"babel-runtime/helpers/interop-require-default":92}],7:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var TimedValue=function(e){var t=e,u=Date.now();this.timestamp=function(){return u},this.value=function(){return t}};exports["default"]=TimedValue,module.exports=exports["default"];

},{}],8:[function(_dereq_,module,exports){
"use strict";var _getIterator=_dereq_("babel-runtime/core-js/get-iterator")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),ChunkDownloader=function(e,t){function r(){if(u()+_conf2["default"].NB_CHUNK_DL_GROUP*_conf2["default"].CHUNK_SIZE/1024<_conf2["default"].MAX_DL_REQUEST_SPEED)for(var e=0;e<_conf2["default"].NB_CHUNK_DL_GROUP;e++)n()}function n(){var e=l.getSegmentListToDownload().slice(0,_conf2["default"].NB_SEGMENT_P2P_PREBUFFER),t=!0,r=!1,n=void 0;try{for(var u,i=function(){var e=u.value,t=_.getOrCreateSegmentHandler(e),r=t.seeders.getNextSeeder(t.chunkManager.chunkNumber);if(r){var n=function(){var n=t.chunkManager.getNextChunk();return n>=0?(r.requestChunk(e,n),o(),f.setTimeout(function(){t.chunkManager.timeOut(n),r.getHeuristic().incrementNbChunkTimeOut()},_conf2["default"].CHUNK_TIMEOUT),{v:{v:void 0}}):void 0}();if("object"==typeof n)return n.v}},a=_getIterator(e);!(t=(u=a.next()).done);t=!0){var c=i();if("object"==typeof c)return c.v}}catch(s){r=!0,n=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(r)throw n}}}function u(){var e=i();return e===!1?c=[]:e>0&&c.splice(0,e),c.length*_conf2["default"].CHUNK_SIZE/1024}function i(){for(var e=Date.now(),t=0;t<c.length;t++)if(e-c[t]<=1e3)return t;return!1}function o(){var e=Date.now();c.push(e)}function a(){f.clearAll()}var f=new _utilsTimers2["default"],l=t,_=e,c=[];f.setInterval(r,_conf2["default"].TIME_BETWEEN_CHUNK_DL),this.addChunkRequest=o,this.dispose=a};exports["default"]=ChunkDownloader,module.exports=exports["default"];

},{"../../conf":1,"../utils/Timers":61,"babel-runtime/core-js/get-iterator":71,"babel-runtime/helpers/interop-require-default":92}],9:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _status=_dereq_("./status"),_status2=_interopRequireDefault(_status),_conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_PartialSegmentPartialSegmentP2P=_dereq_("./PartialSegment/PartialSegmentP2P"),_PartialSegmentPartialSegmentP2P2=_interopRequireDefault(_PartialSegmentPartialSegmentP2P),_eventemitter3=_dereq_("eventemitter3"),_eventemitter32=_interopRequireDefault(_eventemitter3),_securityCallHashWorker=_dereq_("../security/callHashWorker"),_securityCallHashWorker2=_interopRequireDefault(_securityCallHashWorker),ChunkManager=function(t,e,a,n){var o=new _eventemitter32["default"];this.p2pCache=e,this.dataLocked=!1,this._isEmpty=!0,this._segmentCoord=t,this.downloadStatus=[],this.getEE=function(){return o},this._segmentRequestQueue=a,this._segmentInfoMap=n};ChunkManager.prototype.addSegmentSize=function(t){if(!this.size){this.size=t,this.chunkNumber=Math.ceil(this.size/_conf2["default"].CHUNK_SIZE);for(var e=0;e<this.chunkNumber;e++)this.downloadStatus.push("pending");this.segment=new Uint8Array(this.size)}},ChunkManager.prototype.getChunk=function(t){return this.dataLocked||"downloaded"!=this.downloadStatus[t]&&"CDNdownloaded"!=this.downloadStatus[t]?(this.dataLocked,!1):t<this.chunkNumber-1?this.segment.buffer.slice(t*_conf2["default"].CHUNK_SIZE,(t+1)*_conf2["default"].CHUNK_SIZE):this.segment.buffer.slice(t*_conf2["default"].CHUNK_SIZE)},ChunkManager.prototype.getNextChunk=function(){var t=this.downloadStatus.indexOf("failed");return 0>t&&(t=this.downloadStatus.indexOf("pending")),t>=0&&(this.downloadStatus[t]="downloading"),t},ChunkManager.prototype.chunkDownloaded=function(t,e){if(this._isEmpty=!1,"downloaded"===this.downloadStatus[e])_status2["default"].correctP2PDownloaded(t.byteLength,"PP");else if("CDNdownloaded"===this.downloadStatus[e])_status2["default"].correctP2PDownloaded(t.byteLength,"CP");else if(this.downloadStatus[e]="downloaded",_status2["default"].setp2pDownloadedNewAnalytics(_status2["default"].getp2pDownloadedNewAnalytics()+t.byteLength),this.segment.set(new Uint8Array(t),e*_conf2["default"].CHUNK_SIZE),this.isSegmentDownloaded()){var a=this.segment.buffer,n=this.p2pCache.getSegmentHandler(this._segmentCoord);n.seeders.cleanAfterDownloaded(),this.lockSegmentData(),this._checkHashP2P(a)}},ChunkManager.prototype.timeOut=function(t){"downloading"===this.downloadStatus[t]&&(this.downloadStatus[t]="failed")},ChunkManager.prototype.isSegmentDownloaded=function(){if(this.size){for(var t=this.downloadStatus.length-1;t>=0;t--)if("downloaded"!==this.downloadStatus[t]&&"CDNdownloaded"!==this.downloadStatus[t])return!1;return!0}return!1},ChunkManager.prototype.shouldDownloadSegment=function(){return!(this.isSegmentDownloaded()||this.partialSegment)},ChunkManager.prototype.getPartialSegment=function(){if(this.size&&!this._isEmpty){var t=this.partialSegment||new _PartialSegmentPartialSegmentP2P2["default"](this._segmentCoord,this.p2pCache,this.segment,this.downloadStatus,this.size,this,this.isSegmentDownloaded(),this._segmentInfoMap);return this.dataLocked||(this.partialSegment=t),t}return!1},ChunkManager.prototype.getIndexLastChunkInARow=function(){for(var t=0;t<this.downloadStatus.length;t++)if("downloaded"!==this.downloadStatus[t]&&"CDNdownloaded"!==this.downloadStatus[t])return t-1;return this.downloadStatus.length-1},ChunkManager.prototype.storeSegment=function(t){this._isEmpty=!1,this.size||this.addSegmentSize(t.byteLength),this.segment=new Uint8Array(t),this._updateDownloadStatus()},ChunkManager.prototype._updateDownloadStatus=function(){var t;t={start:0,end:this.chunkNumber},this.partialSegment&&this.partialSegment.getCDNIndexRange()&&(t=this.partialSegment.getCDNIndexRange());for(var e=t.start;e<t.end;e++){if("downloaded"===this.downloadStatus[e]||"CDNdownloaded"===this.downloadStatus[e]){var a=_conf2["default"].CHUNK_SIZE;e===this.chunkNumber-1&&(a=this.size-(this.chunkNumber-1)*_conf2["default"].CHUNK_SIZE),"downloaded"===this.downloadStatus[e]?_status2["default"].correctP2PDownloaded(a,"PC"):"CDNdownloaded"===this.downloadStatus[e]&&_status2["default"].correctP2PDownloaded(a,"CC")}this.downloadStatus[e]="CDNdownloaded"}},ChunkManager.prototype.getP2PDownload_CDNDownload=function(){var t=0,e=0;if(this.size){for(var a=0,n=this.downloadStatus.length-1;n>a;a++)"downloaded"===this.downloadStatus[a]?t+=_conf2["default"].CHUNK_SIZE:"CDNdownloaded"===this.downloadStatus[a]&&(e+=_conf2["default"].CHUNK_SIZE);var o=this.size-(this.chunkNumber-1)*_conf2["default"].CHUNK_SIZE;"downloaded"===this.downloadStatus[this.chunkNumber-1]?t+=o:"CDNdownloaded"===this.downloadStatus[this.chunkNumber-1]&&(e+=o)}return{p2pDownloaded:t,cdnDownloaded:e}},ChunkManager.prototype.lockSegmentData=function(){this.dataLocked=!0},ChunkManager.prototype.unlockSegmentData=function(){this.dataLocked=!1},ChunkManager.prototype.removePartialSegment=function(){delete this.partialSegment},ChunkManager.prototype._checkHashP2P=function(t){var e=this,a=this._segmentInfoMap.getSegmentInfo(this._segmentCoord),n=function(t,n){a.hash===n?(_status2["default"].setNbRightHashP2P(_status2["default"].getNbRightHashP2P()+1),e.segment=new Uint8Array(t),e.unlockSegmentData(),e._segmentRequestQueue.answerRequests(a.segmentCoord,e.chunkNumber)):(_status2["default"].setNbWrongHashP2P(_status2["default"].getNbWrongHashP2P()+1),e.p2pCache.removeSegmentHandler(a.segmentCoord),_status2["default"].correctP2PDownloaded(e.size,"HP"))};_securityCallHashWorker2["default"](t,n)},exports["default"]=ChunkManager,module.exports=exports["default"];

},{"../../conf":1,"../security/callHashWorker":51,"./PartialSegment/PartialSegmentP2P":23,"./status":45,"babel-runtime/helpers/interop-require-default":92,"eventemitter3":195}],10:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _status=_dereq_("./status"),_status2=_interopRequireDefault(_status),ChunkReceivedObserver=function(e,t){function r(e,t,r,n){var a=u.getSegmentHandler(t).chunkManager;a?a.chunkDownloaded(n,r):_status2["default"].correctP2PDownloaded(n.byteLength,"M"),e.getHeuristic().incrementNbChunkDownloaded()}var u=e;t.getEE().on("chunkReceived",r)};exports["default"]=ChunkReceivedObserver,module.exports=exports["default"];

},{"./status":45,"babel-runtime/helpers/interop-require-default":92}],11:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _UploadQueue=_dereq_("./UploadQueue"),_UploadQueue2=_interopRequireDefault(_UploadQueue),ChunkUploader=function(e,u){function r(e,u,r){var o=Date.now(),l=t.getSegmentHandler(u).chunkManager;if(l){var n=l.getChunk(r);n&&a.add(e,u,r,n,o)}}var t=e,a=new _UploadQueue2["default"];u.getEE().on("chunkRequested",r)};exports["default"]=ChunkUploader,module.exports=exports["default"];

},{"./UploadQueue":33,"babel-runtime/helpers/interop-require-default":92}],12:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),ExclusionCollection=function(){function e(t){_classCallCheck(this,e),this._exclusionArray=[],this._timers=new _utilsTimers2["default"],this._retentionTime=t}return _createClass(e,[{key:"add",value:function(e){var t=this;this._exclusionArray.push(e),this._timers.setTimeout(function(){t._exclusionArray.splice(0,1)},this._retentionTime)}},{key:"getExclusionList",value:function(){return this._exclusionArray}},{key:"dispose",value:function(){this._timers.clearAll()}}]),e}();exports["default"]=ExclusionCollection,module.exports=exports["default"];

},{"../utils/Timers":61,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/interop-require-default":92}],13:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var MediaEventManager=function(e){var n=e,t={},r=[],a=[],i=function(e,t){r.push({eventName:e,fn:t}),n.addEventListener(e,t)},v=function(e,n){a.push({eventName:e,fn:n}),window.addEventListener(e,n)},o=function(){for(var e=0;e<r.length;e++){var t=r[e].eventName,a=r[e].fn;n.removeEventListener(t,a)}r=[]},s=function(){for(var e=0;e<a.length;e++){var n=a[e].eventName,t=a[e].fn;window.removeEventListener(n,t)}a=[]},d=function(){o(),s()},u=function(e){function n(){t[e].arguments=arguments}return t[e]={arguments:void 0,handler:n},n},f=function(e){n.addEventListener(e,u(e))},c=function(e,r){t[e]&&(n.removeEventListener(e,t[e].handler),t[e].arguments&&r.apply(void 0,t[e].arguments))};this.addMediaEventListener=i,this.addWindowEventListener=v,this.removeAllExternalEventListener=d,this.cacheMediaEvent=f,this.triggerCachedEvent=c};exports["default"]=MediaEventManager,module.exports=exports["default"];

},{}],14:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _eventemitter3=_dereq_("eventemitter3"),_eventemitter32=_interopRequireDefault(_eventemitter3),GlobalEventBus=new _eventemitter32["default"];exports["default"]=GlobalEventBus,module.exports=exports["default"];

},{"babel-runtime/helpers/interop-require-default":92,"eventemitter3":195}],15:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),Heuristic=function(){var e=.3,t=0,n=4e3,i=0,u=0,r=0,s=.5,o=0,c=new _utilsTimers2["default"],f=function(){i++},l=function(){u++},a=function(){r++},h=function(){var e,n=u/i;return e=isNaN(n)?t:Math.min(n,1),o=e,e},d=function(){var t;return 0!==i&&(t=(1-e)*s+e*h(),s=t),s},m=function(){i=0,u=0,r=0},p=function(){d(),m()},_=function(){c.setInterval(p,n)},b=function(){c.clearAll()};this.incrementNbChunkRequested=function(){return f()},this.incrementNbChunkDownloaded=function(){return l()},this.incrementNbChunkTimeOut=function(){return a()},this.heurisInst=function(){return h()},this.mean=function(){return d()},this.getNbChunkRequested=function(){return i},this.getHeuristicScore=function(){return s},this.getLastHeuristInst=function(){return o},this.dispose=function(){b()},_()};exports["default"]=Heuristic,module.exports=exports["default"];

},{"../utils/Timers":61,"babel-runtime/helpers/interop-require-default":92}],16:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Location=function(t,e,o,i){this.city=t,this.country=e,this.latitude=o,this.longitude=i};exports["default"]=Location,module.exports=exports["default"];

},{}],17:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_Map=_dereq_("babel-runtime/core-js/map")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _utilsDelta=_dereq_("../utils/Delta"),_conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),MediaMapCache=function(){function e(t){_classCallCheck(this,e),this._mediaMap=t,this._cachedSegmentList=new _Map,this._cachedSegmentTime=new _Map}return _createClass(e,[{key:"getSegmentList",value:function(e,t,i){var a=this._cachedSegmentList.get(e.viewToString());if(a&&a.beginTime===t&&a.duration===i)return a.cachedSegmentList;var r=this._mediaMap.getSegmentList(e,t,i);return this._cachedSegmentList.set(e.viewToString(),{beginTime:t,cachedSegmentList:r,duration:i}),r}},{key:"getSegmentTime",value:function(e){var t=this._cachedSegmentTime.get(e.viewToString());if(_utilsDelta.isNumeric(t))return t;var i=this._mediaMap.getSegmentTime(e);if(this._cachedSegmentTime.set(e.viewToString(),i),this._cachedSegmentTime.size>_conf2["default"].GETSEGMENTTIME_CACHE_MAX_SIZE){var a=this._cachedSegmentTime.keys(),r=a.next().value;this._cachedSegmentTime["delete"](r)}return i}}]),e}();exports["default"]=MediaMapCache,module.exports=exports["default"];

},{"../../conf":1,"../utils/Delta":56,"babel-runtime/core-js/map":73,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/interop-require-default":92}],18:[function(_dereq_,module,exports){
"use strict";var _slicedToArray=_dereq_("babel-runtime/helpers/sliced-to-array")["default"],_toConsumableArray=_dereq_("babel-runtime/helpers/to-consumable-array")["default"],_Map=_dereq_("babel-runtime/core-js/map")["default"],_getIterator=_dereq_("babel-runtime/core-js/get-iterator")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _structuresSegmentHandler=_dereq_("./structures/SegmentHandler"),_structuresSegmentHandler2=_interopRequireDefault(_structuresSegmentHandler),_conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_status=_dereq_("./status"),_status2=_interopRequireDefault(_status),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),P2PCache=function(e,r,t,n){function a(e){var r=v.get(e.viewToString());return r?r:!1}function o(e){var r=!0,t=!1,n=void 0;try{for(var a,o=_getIterator(v.values());!(r=(a=o.next()).done);r=!0){var u=a.value;u.seeders.removeSeeder(e)}}catch(i){t=!0,n=i}finally{try{!r&&o["return"]&&o["return"]()}finally{if(t)throw n}}}function u(e){var r=a(e);return r===!1&&(r=new _structuresSegmentHandler2["default"](e,this,h,S),v.set(r.segmentCoord.viewToString(),r),p.requestHasSegment(e),i()),r}function i(){var e,r=0,t=y()?_conf2["default"].LIVE.P2P_CACHE_MAX_SIZE:_conf2["default"].P2P_CACHE_MAX_SIZE,n=0,a=!0,o=!1,u=void 0;try{for(var i,s=_getIterator(v.values());!(a=(i=s.next()).done);a=!0){var l=i.value;if(l.chunkManager.size&&(r+=l.chunkManager.size),r>t){e=v.size-n;break}n++}}catch(d){o=!0,u=d}finally{try{!a&&s["return"]&&s["return"]()}finally{if(o)throw u}}if(e){var c=[],f=!0,g=!1,m=void 0;try{for(var _,h=_getIterator(v);!(f=(_=h.next()).done);f=!0){var p=_slicedToArray(_.value,2),w=p[0],C=p[1];if(0===e)break;c.push(C),v["delete"](w),S.removeSegmentInfo(C.segmentCoord),e--}}catch(d){g=!0,m=d}finally{try{!f&&h["return"]&&h["return"]()}finally{if(g)throw m}}}}function s(e){v["delete"](e.viewToString())}function l(){var e=0,r=0,t=!0,n=!1,a=void 0;try{for(var o,u=_getIterator(v.values());!(t=(o=u.next()).done);t=!0){var i=o.value,s=i.chunkManager.getP2PDownload_CDNDownload();e+=s.p2pDownloaded,r+=s.cdnDownloaded}}catch(l){n=!0,a=l}finally{try{!t&&u["return"]&&u["return"]()}finally{if(n)throw a}}return _status2["default"].setCDNDoubleCheck(r),_status2["default"].setP2PDoubleCheck(e),{p2pDownloaded:e,cdnDownloaded:r}}function d(e,r){var t=u(e,r.byteLength),n=t.chunkManager;n.storeSegment(r),h.answerRequests(e,r.byteLength,n.chunkNumber)}function c(e){var r=a(e).chunkManager;return r?r.getPartialSegment():!1}function f(e){return[].concat(_toConsumableArray(v)).filter(function(r){var t=_slicedToArray(r,2),n=(t[0],t[1]);return n.segmentCoord.isInTrack(e)&&!n.chunkManager.shouldDownloadSegment()}).map(function(e){var r=_slicedToArray(e,2),t=(r[0],r[1]);return t.segmentCoord})}function g(){return[].concat(_toConsumableArray(v)).map(function(e){var r=_slicedToArray(e,2),t=(r[0],r[1]);return{segmentcoord:t.segmentCoord,downloadStatusList:t.chunkManager.downloadStatus,seederCount:t.seeders.getLength()}})}function m(e){return[].concat(_toConsumableArray(v)).filter(function(r){var t=_slicedToArray(r,2),n=(t[0],t[1]);return n.segmentCoord.isInTrack(e)&&!n.chunkManager.isSegmentDownloaded()}).map(function(e){var r=_slicedToArray(e,2),t=(r[0],r[1]);return t.segmentCoord})}function _(){w.clearAll(),v=new _Map}var v=new _Map,h=e,y=r,S=n,p=t,w=new _utilsTimers2["default"];l(),w.setInterval(l,1e4),this.dispose=_,this.getOrCreateSegmentHandler=u,this.removeSegmentHandler=s,this.doubleCheckP2PDownload_CDNDownload=l,this.fillSegment=d,this.getSegmentHandler=a,this.getPartialSegment=c,this.removePeer=o,this.listSegmentsToSkipForTrack=f,this.listSegmentsDownloadStatus=g,this.listDownloadedSegmentsForTrack=m};exports["default"]=P2PCache,module.exports=exports["default"];

},{"../../conf":1,"../utils/Timers":61,"./status":45,"./structures/SegmentHandler":47,"babel-runtime/core-js/get-iterator":71,"babel-runtime/core-js/map":73,"babel-runtime/helpers/interop-require-default":92,"babel-runtime/helpers/sliced-to-array":93,"babel-runtime/helpers/to-consumable-array":94}],19:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _UploadQueue=_dereq_("./UploadQueue"),_UploadQueue2=_interopRequireDefault(_UploadQueue),P2PDownloader=function(e,r,t,o,u){var n=this,d=r,a=t,s=o,i=new _UploadQueue2["default"](n),l=function(){e.getEE().on("hasSegment",p),e.getEE().on("peerDestroyed",f)},p=function(e,r,t){if(u.addSegmentInfo(t),d.isSegmentRequested(t.segmentCoord)){var o=a.getSegmentHandler(t.segmentCoord);o&&(o.chunkManager.addSegmentSize(t.size),o.seeders.insertSeeder(e))}},f=function(e){a.removePeer(e),s.removePeerRequests(e)},g=function(){i.dispose()};n.dispose=g,l()};exports["default"]=P2PDownloader,module.exports=exports["default"];

},{"./UploadQueue":33,"babel-runtime/helpers/interop-require-default":92}],20:[function(_dereq_,module,exports){
"use strict";var _get=_dereq_("babel-runtime/helpers/get")["default"],_inherits=_dereq_("babel-runtime/helpers/inherits")["default"],_createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _PartialSegmentInterface2=_dereq_("./PartialSegmentInterface"),_PartialSegmentInterface3=_interopRequireDefault(_PartialSegmentInterface2),PartialSegmentDisableP2P=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._segmentCoord=e}return _inherits(t,e),_createClass(t,[{key:"getUpdatedRange",value:function(e){return e}},{key:"getFullSegment",value:function(e,t){t(e,this._segmentCoord)}},{key:"isComplete",value:function(){return!1}},{key:"isLocked",value:function(){return!1}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}}]),t}(_PartialSegmentInterface3["default"]);exports["default"]=PartialSegmentDisableP2P,module.exports=exports["default"];

},{"./PartialSegmentInterface":21,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/get":90,"babel-runtime/helpers/inherits":91,"babel-runtime/helpers/interop-require-default":92}],21:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var ERROR_MESSAGE="Method not implemented",PartialSegmentInterface=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getUpdatedRange",value:function(e){throw new Error(ERROR_MESSAGE)}},{key:"getFullSegment",value:function(e,r,t){throw new Error(ERROR_MESSAGE)}},{key:"isComplete",value:function(){throw new Error(ERROR_MESSAGE)}},{key:"isLocked",value:function(){throw new Error(ERROR_MESSAGE)}},{key:"p2pSpeed",get:function(){throw new Error(ERROR_MESSAGE)}},{key:"p2pAmount",get:function(){throw new Error(ERROR_MESSAGE)}}]),e}();exports["default"]=PartialSegmentInterface,module.exports=exports["default"];

},{"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88}],22:[function(_dereq_,module,exports){
"use strict";var _get=_dereq_("babel-runtime/helpers/get")["default"],_inherits=_dereq_("babel-runtime/helpers/inherits")["default"],_createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _PartialSegmentInterface2=_dereq_("./PartialSegmentInterface"),_PartialSegmentInterface3=_interopRequireDefault(_PartialSegmentInterface2),_status=_dereq_("../status"),_status2=_interopRequireDefault(_status),_securityCallHashWorker=_dereq_("../../security/callHashWorker"),_securityCallHashWorker2=_interopRequireDefault(_securityCallHashWorker),_GlobalEventBus=_dereq_("../GlobalEventBus"),_GlobalEventBus2=_interopRequireDefault(_GlobalEventBus),_structuresSegmentInfo=_dereq_("../structures/SegmentInfo"),_structuresSegmentInfo2=_interopRequireDefault(_structuresSegmentInfo),PartialSegmentNoP2P=function(e){function t(e,r,a,u){function l(e,t){function l(l,s){e.response=l;var i=r.getSegmentTime(n),o=new _structuresSegmentInfo2["default"](n,l.byteLength,s,i);u.addSegmentInfo(o),a.fillSegment(n,e.response),_GlobalEventBus2["default"].emit("piece_downloaded_prtl",n),t(e,n)}_securityCallHashWorker2["default"](e.response,l)}_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var n=e;this.getFullSegment=function(e,t){_GlobalEventBus2["default"].emit("CDNSegmentDownloaded",n);var r=e.response;_status2["default"].setCDNDownloaded(_status2["default"].getCDNDownloaded()+r.byteLength),l(e,t)}}return _inherits(t,e),_createClass(t,[{key:"isComplete",value:function(){return!1}},{key:"isLocked",value:function(){return!1}},{key:"getUpdatedRange",value:function(e){return e}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}}]),t}(_PartialSegmentInterface3["default"]);exports["default"]=PartialSegmentNoP2P,module.exports=exports["default"];

},{"../../security/callHashWorker":51,"../GlobalEventBus":14,"../status":45,"../structures/SegmentInfo":48,"./PartialSegmentInterface":21,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/get":90,"babel-runtime/helpers/inherits":91,"babel-runtime/helpers/interop-require-default":92}],23:[function(_dereq_,module,exports){
"use strict";var _get=_dereq_("babel-runtime/helpers/get")["default"],_inherits=_dereq_("babel-runtime/helpers/inherits")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_Object$defineProperties=_dereq_("babel-runtime/core-js/object/define-properties")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../../conf"),_conf2=_interopRequireDefault(_conf),_status=_dereq_("../status"),_status2=_interopRequireDefault(_status),_PartialSegmentInterface2=_dereq_("./PartialSegmentInterface"),_PartialSegmentInterface3=_interopRequireDefault(_PartialSegmentInterface2),_securityCallHashWorker=_dereq_("../../security/callHashWorker"),_securityCallHashWorker2=_interopRequireDefault(_securityCallHashWorker),_GlobalEventBus=_dereq_("../GlobalEventBus"),_GlobalEventBus2=_interopRequireDefault(_GlobalEventBus),PartialSegmentP2P=function(e){function t(e,r,n,a,u,s,o,l){function i(e,t,n,a){function u(u,s){t.hash===s?(_status2["default"].setNbRightHashDLM(_status2["default"].getNbRightHashDLM()+1),e.response=u,f(e),n(e,E)):(_status2["default"].setNbWrongHashDLM(_status2["default"].getNbWrongHashDLM()+1),_status2["default"].setCdnDataDiscarded(_status2["default"].getCdnDataDiscarded()+N),r.removeSegmentHandler(E),_status2["default"].correctP2PDownloaded(v,"HD"),a(e,E))}_securityCallHashWorker2["default"](e.response,u)}function f(e){P=e.response,r.fillSegment(E,e.response),_GlobalEventBus2["default"].emit("piece_downloaded_prtl",E),C=!1,s.unlockSegmentData(),s.removePartialSegment()}function d(){v=0;for(var e=0;e<q.length;e++)"downloaded"===q[e]&&(v+=e<q.length-1?_conf2["default"].CHUNK_SIZE:u-(q.length-1)*_conf2["default"].CHUNK_SIZE)}function c(){for(var e=0;e<q.length;e++)if("downloaded"!==q[e]&&"CDNdownloaded"!==q[e])return e}function _(){for(var e=q.length-1;e>=0;e--)if("downloaded"!==q[e]&&"CDNdownloaded"!==q[e])return e+1}function g(e){if(!_conf2["default"].RANGE_REQUEST_ALLOWED)return e;var t,r,n=c(),a=_();return void 0!==n&&void 0!==a?(t=e?e.start+n*_conf2["default"].CHUNK_SIZE:n*_conf2["default"].CHUNK_SIZE,a===q.length&&e?r=e.end:a<q.length&&(r=e?e.start+a*_conf2["default"].CHUNK_SIZE-1:a*_conf2["default"].CHUNK_SIZE-1),b={start:n,end:a},{start:t,end:r}):e?e:void 0}function h(){P=n.buffer.slice(),q=a.slice(),d(),D=_status2["default"].getMeanInstantSpeed(),S=o}function p(e){var t;if(void 0!==b&&void 0!==P){t=new Uint8Array(P);try{t.set(new Uint8Array(e),b.start*_conf2["default"].CHUNK_SIZE)}catch(r){throw new Error("Invalid configuration: The current stream has no range request enabled and the p2p configuration has range request set to true.")}}else t=new Uint8Array(e);return t.buffer}function m(e){_status2["default"].setCDNDownloaded(_status2["default"].getCDNDownloaded()+e.byteLength)}_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var b,v,D,S,C,P,q,E=e,H=l,N=0;this.getFullSegment=function(e,t,r){if(e.p2pMeanThroughput=_status2["default"].computeP2PThroughput(),this.isComplete())e.response=P,s.removePartialSegment(),t(e,null);else{_GlobalEventBus2["default"].emit("CDNSegmentDownloaded",E);var n=e.response;if(m(n),N=n.byteLength,e.response=p(n),0!==v){C=!0,s.lockSegmentData();var a=H.getSegmentInfo(E);i(e,a,t,r)}else f(e),t(e,E)}},this.getUpdatedRange=g,this.getCDNIndexRange=function(){return b},this.isComplete=function(){return S},this.isLocked=function(){return s.dataLocked},h(),_Object$defineProperties(this,{p2pSpeed:{get:function(){return D},set:void 0},p2pAmount:{get:function(){return v},set:void 0}})}return _inherits(t,e),t}(_PartialSegmentInterface3["default"]);exports["default"]=PartialSegmentP2P,module.exports=exports["default"];

},{"../../../conf":1,"../../security/callHashWorker":51,"../GlobalEventBus":14,"../status":45,"./PartialSegmentInterface":21,"babel-runtime/core-js/object/define-properties":76,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/get":90,"babel-runtime/helpers/inherits":91,"babel-runtime/helpers/interop-require-default":92}],24:[function(_dereq_,module,exports){
(function (global){
"use strict";function isP2PAvailable(){var e=window.RTCPeerConnection||window.webkitPeerConnection00||window.webkitRTCPeerConnection;return!(!e||uaHelper.isMobile())}var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _P2PDownloader=_dereq_("./P2PDownloader"),_P2PDownloader2=_interopRequireDefault(_P2PDownloader),_ChunkDownloader=_dereq_("./ChunkDownloader"),_ChunkDownloader2=_interopRequireDefault(_ChunkDownloader),_ExternalEventManager=_dereq_("./ExternalEventManager"),_ExternalEventManager2=_interopRequireDefault(_ExternalEventManager),_PartialSegmentPartialSegmentNoP2P=_dereq_("./PartialSegment/PartialSegmentNoP2P"),_PartialSegmentPartialSegmentNoP2P2=_interopRequireDefault(_PartialSegmentPartialSegmentNoP2P),_PartialSegmentPartialSegmentDisableP2P=_dereq_("./PartialSegment/PartialSegmentDisableP2P"),_PartialSegmentPartialSegmentDisableP2P2=_interopRequireDefault(_PartialSegmentPartialSegmentDisableP2P),_displayDisplayInterface=_dereq_("./display/DisplayInterface"),_displayDisplayInterface2=_interopRequireDefault(_displayDisplayInterface),_analyticsVideoAnalytics=_dereq_("../analytics/VideoAnalytics"),_analyticsVideoAnalytics2=_interopRequireDefault(_analyticsVideoAnalytics),_TrackerManager=_dereq_("./TrackerManager"),_TrackerManager2=_interopRequireDefault(_TrackerManager),_peerPool2=_dereq_("./peerPool"),_peerPool3=_interopRequireDefault(_peerPool2),_P2PCache=_dereq_("./P2PCache"),_P2PCache2=_interopRequireDefault(_P2PCache),_SegmentUploader=_dereq_("./SegmentUploader"),_SegmentUploader2=_interopRequireDefault(_SegmentUploader),_SegmentRequestQueue=_dereq_("./SegmentRequestQueue"),_SegmentRequestQueue2=_interopRequireDefault(_SegmentRequestQueue),_ChunkUploader=_dereq_("./ChunkUploader"),_ChunkUploader2=_interopRequireDefault(_ChunkUploader),_ChunkReceivedObserver2=_dereq_("./ChunkReceivedObserver"),_ChunkReceivedObserver3=_interopRequireDefault(_ChunkReceivedObserver2),_Scheduler=_dereq_("./Scheduler"),_Scheduler2=_interopRequireDefault(_Scheduler),_SegmentInfoMap=_dereq_("./SegmentInfoMap"),_SegmentInfoMap2=_interopRequireDefault(_SegmentInfoMap),_status=_dereq_("./status"),_status2=_interopRequireDefault(_status),_moduleState=_dereq_("./moduleState"),_moduleState2=_interopRequireDefault(_moduleState),_conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),_utilsConfHelper=_dereq_("../utils/confHelper"),_utilsConfHelper2=_interopRequireDefault(_utilsConfHelper),_SRModuleInterface=_dereq_("./SRModuleInterface"),_SRModuleInterface2=_interopRequireDefault(_SRModuleInterface),_graphsPrivateBufferDisplay=_dereq_("../../../graphs/private/BufferDisplay"),_graphsPrivateBufferDisplay2=_interopRequireDefault(_graphsPrivateBufferDisplay),_graphsPrivateChunkDisplay=_dereq_("../../../graphs/private/chunkDisplay"),_graphsPrivateChunkDisplay2=_interopRequireDefault(_graphsPrivateChunkDisplay),_expectedInterfacesSegmentCoordInterface=_dereq_("./expectedInterfaces/SegmentCoordInterface"),_expectedInterfacesSegmentCoordInterface2=_interopRequireDefault(_expectedInterfacesSegmentCoordInterface),_expectedInterfacesMapInterface=_dereq_("./expectedInterfaces/MapInterface"),_expectedInterfacesMapInterface2=_interopRequireDefault(_expectedInterfacesMapInterface),_expectedInterfacesTrackCoordInterface=_dereq_("./expectedInterfaces/TrackCoordInterface"),_expectedInterfacesTrackCoordInterface2=_interopRequireDefault(_expectedInterfacesTrackCoordInterface),_utilsInterface=_dereq_("../utils/Interface"),uaHelper=_dereq_("../utils/uaHelper"),SRModule=function(e,t,a,r,n){_utilsInterface.checkInterface(_expectedInterfacesMapInterface2["default"],a),_utilsInterface.checkInterface(_expectedInterfacesSegmentCoordInterface2["default"],n.prototype);var i,u,l,o,c,d,f,s,_,p,P,g,S,m,q,I=r,C=new _utilsTimers2["default"],D=!1,h=function(e){var a=e.audio,r=e.video;a&&_utilsInterface.checkInterface(_expectedInterfacesTrackCoordInterface2["default"],a),r&&_utilsInterface.checkInterface(_expectedInterfacesTrackCoordInterface2["default"],r),_moduleState2["default"].content=t,_status2["default"].incrementTrackSwitchCount(),q.updateCurrentTracks({audio:a,video:r}),_moduleState2["default"].updateCurrentTracks({video:r})},R=function(e){_status2["default"].setCdnCancelled(_status2["default"].getCdnCancelled()+e)},v=function(){p&&(m.addMediaEventListener("cdnCancelled",R),m.addMediaEventListener("onTrackChange",h),P=new _SegmentInfoMap2["default"],u=new _TrackerManager2["default"](_conf2["default"].TRACKER_URL,e),l=new _peerPool3["default"](u,n),d=new _SegmentRequestQueue2["default"](P),c=new _P2PCache2["default"](d,e.isLive.bind(e),l,P),f=new _ChunkReceivedObserver3["default"](c,l),s=new _SegmentUploader2["default"](l,d,P,c),_=new _ChunkUploader2["default"](c,l),q=new _Scheduler2["default"](a,c),i=new _ChunkDownloader2["default"](c,q),o=new _P2PDownloader2["default"](l,q,c,d,P),k(),m.triggerCachedEvent("onTrackChange",h),m.triggerCachedEvent("cdnCancelled",R),w()),D=!0},k=function(){S=new _analyticsVideoAnalytics2["default"](e,m,t,c,l,o)},w=function T(){!e.areBuffersInitialized||e.areBuffersInitialized()?_conf2["default"].DEBUG&&(g=new _displayDisplayInterface2["default"](l,e.isLive.bind(e))):C.setTimeout(T,300)},M=function(){_utilsConfHelper2["default"](_conf2["default"],I),p=isP2PAvailable()&&_conf2["default"].ALLOW_P2P,p&&(_status2["default"].reset(),m=new _ExternalEventManager2["default"](e),m.cacheMediaEvent("onMapUpdate"),m.cacheMediaEvent("cdnCancelled"),m.cacheMediaEvent("onTrackChange"))},y=function(e){if(!p)throw new Error("P2P is not activated, getP2PData can't be called");var t;return D?t=p?c.getPartialSegment(e)||new _PartialSegmentPartialSegmentNoP2P2["default"](e,a,c,P):new _PartialSegmentPartialSegmentDisableP2P2["default"](e):(v(),t=new _PartialSegmentPartialSegmentDisableP2P2["default"](e)),q.updateTrackEdge(e),t},b=function(e,t,a){return null!==a&&_utilsInterface.checkInterface(_expectedInterfacesSegmentCoordInterface2["default"],a),_SRModuleInterface2["default"].getSegment(this,e,t,a)},x=function(){p&&(D&&(m.removeAllExternalEventListener(),S.dispose(),i.dispose(),c.dispose(),C.clearAll(),l.dispose(),o.dispose(),g&&g.dispose()),_status2["default"].dispose())};M(),this.getSegment=b,this.getP2PData=y,this.dispose=x};exports["default"]=SRModule,global.Streamroot=global.Streamroot||{},global.Streamroot.uaHelper=uaHelper,Object.defineProperty(global.Streamroot,"p2pAvailable",{get:function(){return isP2PAvailable()}}),module.exports=exports["default"];

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../../../graphs/private/BufferDisplay":65,"../../../graphs/private/chunkDisplay":67,"../../conf":1,"../analytics/VideoAnalytics":5,"../utils/Interface":57,"../utils/Timers":61,"../utils/confHelper":63,"../utils/uaHelper":64,"./ChunkDownloader":8,"./ChunkReceivedObserver":10,"./ChunkUploader":11,"./ExternalEventManager":13,"./P2PCache":18,"./P2PDownloader":19,"./PartialSegment/PartialSegmentDisableP2P":20,"./PartialSegment/PartialSegmentNoP2P":22,"./SRModuleInterface":25,"./Scheduler":26,"./SegmentInfoMap":28,"./SegmentRequestQueue":29,"./SegmentUploader":30,"./TrackerManager":32,"./display/DisplayInterface":38,"./expectedInterfaces/MapInterface":39,"./expectedInterfaces/SegmentCoordInterface":40,"./expectedInterfaces/TrackCoordInterface":41,"./moduleState":42,"./peerPool":44,"./status":45,"babel-runtime/helpers/interop-require-default":92}],25:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_=_dereq_("underscore"),conf=_dereq_("../../conf"),noop=function(){},SegmentRequest=function(){function e(t,n,s,r){var a=n.url,o=n.headers,i=void 0===o?[]:o,l=n.withCredentials,u=this,_=s.onProgress,h=void 0===_?noop:_,d=s.onError,c=void 0===d?noop:d,g=s.onSuccess,m=void 0===g?noop:g;_classCallCheck(this,e),this._request={url:a,headers:i,withCredentials:l},this._handlers={onProgress:h,onError:c,onSuccess:m},conf.RETURN_COPY_SEGMENT&&!function(){var e=u._handlers.onSuccess;u._handlers.onSuccess=function(t,n,s){var r=t.slice(0);e(r,n,s)}}(),this._stats={cdnDownloaded:0,cdnDuration:0},this._srModule=t,this._segmentCoord=r}return _createClass(e,[{key:"getSegment",value:function(){try{null===this._segmentCoord?this._getFullSegmentFromCDN():(this._partialSegment=this._srModule.getP2PData(this._segmentCoord),this._setP2PStats(),this._handlers.onProgress(this._stats,this._request),this._partialSegment.isComplete()?this._getFullP2PSegment():this._getRemainingRangeFromCDN())}catch(e){this._getFullSegmentFromCDN()}return this._abort.bind(this)}},{key:"_abort",value:function(){this._xhr&&this._xhr.abort(),this._handlers.onSuccess=noop}},{key:"_getFullP2PSegment",value:function(){var e=this;this._waitSegmentUnlocked(function(t){t?e._fillSegment(void 0):e._getFullSegmentFromCDN()})}},{key:"_getRemainingRangeFromCDN",value:function(){var e=this,t=this._getRangeFromRequest();this._fallbackRange=t,this._rangeToDownload=this._partialSegment.getUpdatedRange(t),this._downloadFromCDN(this._rangeToDownload,function(t,n){return t?void e._handlers.onError(t,e._request):void e._fillSegment(n)})}},{key:"_downloadFromCDN",value:function(e,t){this._xhr=new XMLHttpRequest,this._xhr.open("GET",this._request.url,!0),this._xhr.responseType="arraybuffer",this._setXhrHandlers(t),this._setXhrHeaders(),this._setXhrUpdatedRange(e),this._xhr.withCredentials=!!this._request.withCredentials,this._xhr.send(),this._startDownloadCdn=new Date}},{key:"_setXhrHandlers",value:function(e){var t=this;this._xhr.onloadend=function(n){return t._xhr.status<200||t._xhr.status>206?void e(n):(t._stats.cdnDownloaded=t._xhr.response.byteLength||0,t._stats.cdnDuration=new Date-t._startDownloadCdn,void e(null,t._xhr.response))},this._xhr.onerror=e,this._xhr.onprogress=function(e){t._stats.cdnDownloaded=e.loaded,t._stats.cdnDuration=new Date-t._startDownloadCdn,t._handlers.onProgress(t._stats,t._request)}}},{key:"_setXhrHeaders",value:function(){var e=this;this._request.headers.forEach(function(t){"Range"===t[0]&&e._rangeToDownload||e._xhr.setRequestHeader(t[0],t[1])})}},{key:"_setXhrUpdatedRange",value:function(e){if(e){var t=e.start,n=e.end||"",s="bytes="+t+"-"+n;this._xhr.setRequestHeader("Range",s)}}},{key:"_fillSegment",value:function(e){var t=this,n=!1,s=function(e){return function(s,r){n||(n=!0,e.call(t,s,r))}};try{this._partialSegment.getFullSegment({response:e},s(this._onSuccessAsynchronous),s(this._getFullSegmentFromCDN))}catch(r){return void this._getFullSegmentFromCDN()}setTimeout(function(){n||(n=!0,t._getFullSegmentFromCDN())},conf.TIMEOUT_GET_FULL_SEGMENT)}},{key:"_waitSegmentUnlocked",value:function(e){var t=this;if(!this._partialSegment.isLocked())return void e(!0);var n=0,s=setInterval(function(){return t._partialSegment=t._srModule.getP2PData(t._segmentCoord),t._partialSegment.isLocked()?(n+=conf.LOCKED_RETRY_INTERVAL,void(n>conf.LOCKED_RETRY_TIMEOUT&&(clearInterval(s),e(!1)))):(clearInterval(s),void e(!0))},conf.LOCKED_RETRY_INTERVAL)}},{key:"_getRangeFromRequest",value:function(){var e=_.find(this._request.headers,function(e){return"Range"===e[0]});if(e){var t=e[1].split("="),n=t[1].split("-");return{start:parseInt(n[0],10),end:parseInt(n[1],10)}}}},{key:"_getFullSegmentFromCDN",value:function(){var e=this;this._stats={p2pDownloaded:0,p2pDuration:0},this._downloadFromCDN(this._fallbackRange,function(t,n){return t?void e._handlers.onError(t,e._request):void e._handlers.onSuccess(n,e._stats,e._request)})}},{key:"_setP2PStats",value:function(){this._stats.p2pDownloaded=this._partialSegment.p2pAmount,this._stats.p2pDuration=0===this._partialSegment.p2pSpeed?0:Math.round(this._partialSegment.p2pAmount/this._partialSegment.p2pSpeed*1e3)}},{key:"_onSuccessAsynchronous",value:function(e){var t=this;setTimeout(function(){t._handlers.onSuccess(e.response,t._stats,t._request)},0)}}]),e}();module.exports={getSegment:function(e,t,n,s){var r=new SegmentRequest(e,t,n,s);return r.getSegment()}};

},{"../../conf":1,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"underscore":239}],26:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_defineProperty=_dereq_("babel-runtime/helpers/define-property")["default"],_toConsumableArray=_dereq_("babel-runtime/helpers/to-consumable-array")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _underscore=_dereq_("underscore"),_underscore2=_interopRequireDefault(_underscore),_conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_structuresCurrentTracksStruct=_dereq_("./structures/CurrentTracksStruct"),_structuresCurrentTracksStruct2=_interopRequireDefault(_structuresCurrentTracksStruct),_utilsDelta=_dereq_("../utils/Delta"),_structuresTrackEdges=_dereq_("./structures/TrackEdges"),_structuresTrackEdges2=_interopRequireDefault(_structuresTrackEdges),_MediaMapCache=_dereq_("./MediaMapCache"),_MediaMapCache2=_interopRequireDefault(_MediaMapCache),Scheduler=function(){function e(r,t){_classCallCheck(this,e),this._p2pCache=t,this.currentTracks=new _structuresCurrentTracksStruct2["default"],this._edges=new _structuresTrackEdges2["default"],this._mediaMapCache=new _MediaMapCache2["default"](r)}return _createClass(e,[{key:"getSegmentListToDownload",value:function(){var e=this,r=[];return[].concat(_toConsumableArray(this.currentTracks)).forEach(function(t){var u=e._edges[t.type];if(_utilsDelta.isNumeric(u)){var a=e._mediaMapCache.getSegmentList(t.coord,u,_conf2["default"].MAX_BUFFER_DURATION),c=e._p2pCache.listSegmentsToSkipForTrack(t.coord),s=e._getDifference(a,c);r=r.concat(s)}}),r.sort(function(r,t){var u=e._mediaMapCache.getSegmentTime(r),a=e._mediaMapCache.getSegmentTime(t);return u-a})}},{key:"updateTrackEdge",value:function(e){var r=_underscore2["default"].find([].concat(_toConsumableArray(this.currentTracks)),function(r){return e.isInTrack(r.coord)});if(void 0!==r){var t=r.type,u=this._mediaMapCache.getSegmentTime(e);this._edges.update(_defineProperty({},t,u))}}},{key:"updateCurrentTracks",value:function(e){this.currentTracks.update(e)}},{key:"_getDifference",value:function(e,r){return _underscore2["default"].reject(e,function(e){return void 0!==_underscore2["default"].find(r,function(r){return e.isEqual(r)})})}},{key:"isSegmentRequested",value:function(e){return this.getSegmentListToDownload().reduce(function(r,t){return r||t.isEqual(e)},!1)}}]),e}();exports["default"]=Scheduler,module.exports=exports["default"];

},{"../../conf":1,"../utils/Delta":56,"./MediaMapCache":17,"./structures/CurrentTracksStruct":46,"./structures/TrackEdges":49,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/define-property":89,"babel-runtime/helpers/interop-require-default":92,"babel-runtime/helpers/to-consumable-array":94,"underscore":239}],27:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _underscore=_dereq_("underscore"),_underscore2=_interopRequireDefault(_underscore),Seeders=function(){var e=[],t=0,r=function(t){for(var r=0;r<e.length;){if(e[r].getHeuristic().getHeuristicScore()<=t.getHeuristic().getHeuristicScore())return void e.splice(r,0,t);r++}e.push(t)},i=function(t){e=_underscore2["default"].reject(e,function(e){return e===t})},u=function(){for(var t=0,r=0;r<e.length;r++)t+=e[r].getHeuristic().getHeuristicScore();return t},n=function(r){var i,n=Math.floor(Math.random()*e.length);switch(t){case 0:if(0!==e.length){i=e[n];for(var c=0;c<e.length;c++)if(e[c].getHeuristic().getNbChunkRequested()/e[c].getHeuristic().getHeuristicScore()<=e[e.length-1].getHeuristic().getNbChunkRequested()/e[e.length-1].getHeuristic().getHeuristicScore()&&e[c].canBeAskedChunk()){i=e[c];break}}break;case 1:if(0!==e.length){i=e[n];for(var c=0;c<e.length;c++)if(Math.random()<=e[c].getHeuristic().getHeuristicScore()&&e[c].canBeAskedChunk()){i=e[c];break}}break;case 2:if(0!==e.length){i=e[n];for(var c=0;c<e.length;c++)if(e[c].getHeuristic().getNbChunkRequested()<=Math.floor(e[c].getHeuristic().getHeuristicScore()/u()*r+1)&&e[c].canBeAskedChunk()){i=e[c];break}}break;case 3:if(0!==e.length){i=e[n];for(var c=0;c<e.length;c++)if(e[c].getHeuristic().getNbChunkRequested()/e[c].getHeuristic().getHeuristicScore()<=e[c+1].getHeuristic().getNbChunkRequested()/e[c+1].getHeuristic().getHeuristicScore()&&e[c].canBeAskedChunk()){i=e[c];break}}break;default:i=!1}return i},c=function(){e=[]};this.getNextSeeder=function(e){return n(e)},this.insertSeeder=function(e){r(e)},this.removeSeeder=function(e){i(e)},this.cleanAfterDownloaded=function(){c()},this.getLength=function(){return e.length}};exports["default"]=Seeders,module.exports=exports["default"];

},{"babel-runtime/helpers/interop-require-default":92,"underscore":239}],28:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_Map=_dereq_("babel-runtime/core-js/map")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var SegmentInfoMap=function(){function e(){_classCallCheck(this,e),this._map=new _Map}return _createClass(e,[{key:"addSegmentInfo",value:function(e){var t=e.segmentCoord.viewToString();this._map.set(t,e)}},{key:"getSegmentInfo",value:function(e){var t=e.viewToString(),a=this._map.get(t);if(!a)throw new Error("segmentInfo not found in the map");return a}},{key:"removeSegmentInfo",value:function(e){var t=e.viewToString();this._map["delete"](t)}}]),e}();exports["default"]=SegmentInfoMap,module.exports=exports["default"];

},{"babel-runtime/core-js/map":73,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88}],29:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _=_dereq_("underscore"),SegmentRequestQueue=function(e){this._segmentInfoMap=e,this.segmentRequests=[],this.peerTimeouts={}};SegmentRequestQueue.prototype.queue=function(e,t){this.segmentRequests.push({segmentCoord:t,peer:e})},SegmentRequestQueue.prototype.answerRequests=function(e,t){var s,u=_.filter(this.segmentRequests,function(t){return e.isEqual(t.segmentCoord)},this),n=this._segmentInfoMap.getSegmentInfo(e);for(s=0;s<u.length;s++)u[s].peer.answerHasSegment(n,t);this.segmentRequests=_.reject(this.segmentRequests,function(t){return e.isEqual(t.segmentCoord)},this)},SegmentRequestQueue.prototype.removePeerRequests=function(e){this.segmentRequests=_.reject(this.segmentRequests,function(t){return t.peer===e},this)},exports["default"]=SegmentRequestQueue,module.exports=exports["default"];

},{"underscore":239}],30:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var SegmentUploader=function(e,t,n,r){function a(e,t){var n=s.getSegmentHandler(t).chunkManager;if(n){var r=n.getIndexLastChunkInARow();if(r>-1){var a=o.getSegmentInfo(t);return void e.answerHasSegment(a,r)}}d.queue(e,t)}var o=n,u=e,s=r,d=t;u.getEE().on("segmentRequested",a)};exports["default"]=SegmentUploader,module.exports=exports["default"];

},{}],31:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),SpeedCalculator=function(){this.transferedChunks=[]};SpeedCalculator.prototype.calculateSpeed=function(){var e=this.getIndexTransferOneSecondAgo();return e===!1?this.transferedChunks=[]:e>0&&this.transferedChunks.splice(0,e),this.transferedChunks.length*_conf2["default"].CHUNK_SIZE/1024},SpeedCalculator.prototype.getIndexTransferOneSecondAgo=function(){for(var e=Date.now(),r=0;r<this.transferedChunks.length;r++)if(e-this.transferedChunks[r]<=1e3)return r;return!1},SpeedCalculator.prototype.addChunkTransfer=function(){var e=Date.now();this.transferedChunks.push(e)},exports["default"]=SpeedCalculator,module.exports=exports["default"];

},{"../../conf":1,"babel-runtime/helpers/interop-require-default":92}],32:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_socketIoClient=_dereq_("socket.io-client"),_socketIoClient2=_interopRequireDefault(_socketIoClient),_status=_dereq_("./status"),_status2=_interopRequireDefault(_status),_eventemitter3=_dereq_("eventemitter3"),_eventemitter32=_interopRequireDefault(_eventemitter3),_Location=_dereq_("./Location"),_Location2=_interopRequireDefault(_Location),_moduleState=_dereq_("./moduleState"),_moduleState2=_interopRequireDefault(_moduleState),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),TrackerManager=function(e,t){var n=new _eventemitter32["default"];this.p2pProtocolVersion="2.0.0",this.client2ClientProtocolVersion="2.0.0",this._playerInterface=t,this.trackerURL=e,this.connect(),this._timers=new _utilsTimers2["default"],this.instantiatedTime=Date.now(),this.getEE=function(){return n}};TrackerManager.prototype.connect=function(){this.socket||(this.socket=_socketIoClient2["default"].connect(this.trackerURL,{"force new connection":!0,query:{protocol_version:_conf2["default"].CLIENT_TRACKER_PROTOCOL_VERSION,client_id:_conf2["default"].ID_CLIENT},reconnectionDelay:2e3,reconnectionDelayMax:3e5}),this.socket.on("connect",this.onTrackerConnected.bind(this)),this.socket.on("reconnecting",this.onTrackerReconnecting.bind(this)),this.socket.on("disconnect",this.onTrackerDisconnected.bind(this)),this.socket.on("reconnect",this.onTrackerReconnect.bind(this)),this.socket.on("get_current_tracks",this.onGetCurrentTracks.bind(this)))};var _updateCount=function(e){switch(e){case"offer":case"answer":case"icecandidate":_status2["default"].setTrackerSgnCount(_status2["default"].getTrackerSgnCount()+1);break;default:_status2["default"].setTrackerMsgCount(_status2["default"].getTrackerMsgCount()+1)}};TrackerManager.prototype.sockEmit=function(e,t,n){(_status2["default"].getConnected()||"init"===e)&&(void 0===t?this.socket.emit(e,n):this.socket.emit(e,t,n),_updateCount(e))},TrackerManager.prototype.onTrackerConnected=function(){var e={manifest_url:_moduleState2["default"].content,p2p_protocol:this.client2ClientProtocolVersion,client_id:_conf2["default"].ID_CLIENT};this._playerInterface.isLive()&&(e.buffer_level_max=this._playerInterface.getBufferLevelMax()),this.sockEmit("init",e,this.onTrackerReady.bind(this)),_status2["default"].incrementTrackerConnectionCount(),this._timers.setTimeout(this._inspectUsedTransport.bind(this),15e3)},TrackerManager.prototype._inspectUsedTransport=function(){"websocket"==this.socket.io.engine.transport.name&&_status2["default"].setUpgraded()},TrackerManager.prototype.onTrackerReady=function(e,t){if(!e){var n=Date.now()-this.instantiatedTime;_status2["default"].setTrackerConnectionTime(n),_status2["default"].setConnected(!0),this._playerInterface.isLive()&&(_status2["default"].setBufferLevel(t.buffer_level),this._playerInterface.setBufferMarginLive(t.buffer_level)),_status2["default"].setMyPeerId(t.peer_id),this.askGeolocation(_conf2["default"].GEOLOCATION_REQUEST_MAX_RETRY),this.getEE().emit("tracker_ready")}},TrackerManager.prototype.askGeolocation=function(e){var t=this;this._timers.setTimeout(function(){t.sockEmit("geolocation",void 0,t.makeGeolocationAnswerHandler(e))},_conf2["default"].GEOLOCATION_REQUEST_TIMEOUT)},TrackerManager.prototype.makeGeolocationAnswerHandler=function(e){var t=this;return function(n,r){if(n)0!==e&&(e--,t.askGeolocation(e));else{var o=new _Location2["default"](r.city,r.country,r.latitude,r.longitude);_status2["default"].setMyLocation(o)}}},TrackerManager.prototype.onTrackerReconnecting=function(){_status2["default"].setConnected(!1)},TrackerManager.prototype.onTrackerDisconnected=function(){!this.socketClosed,_status2["default"].setConnected(!1),_status2["default"].incrementTrackerDeconnectionCount(),this.getEE().emit("tracker_disconnected")},TrackerManager.prototype.onTrackerReconnect=function(){_status2["default"].incrementTrackerReconnectionCount()},TrackerManager.prototype.onGetCurrentTracks=function(e){var t={tracks:[{track_hash:_moduleState2["default"].getVideoTrackHash()}]};this._playerInterface.isLive()||(t.time_position=_moduleState2["default"].videoCurrentTime),e(null,t)},TrackerManager.prototype.askPeers=function(e,t){var n={tracks:[{track_hash:_moduleState2["default"].getVideoTrackHash()}],exclusions:e,peer_number:_conf2["default"].MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE};this._playerInterface.isLive()?n.buffer_level=_status2["default"].getBufferLevel():n.time_position=_moduleState2["default"].videoCurrentTime,this.sockEmit("get_peers",n,t)},TrackerManager.prototype.dispose=function(){this.socketClosed=!0,this._timers.clearAll(),this.socket.close()},exports["default"]=TrackerManager,module.exports=exports["default"];

},{"../../conf":1,"../utils/Timers":61,"./Location":16,"./moduleState":42,"./status":45,"babel-runtime/helpers/interop-require-default":92,"eventemitter3":195,"socket.io-client":204}],33:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_underscore=_dereq_("underscore"),_underscore2=_interopRequireDefault(_underscore),_SpeedCalculator=_dereq_("./SpeedCalculator"),_SpeedCalculator2=_interopRequireDefault(_SpeedCalculator),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),_GlobalEventBus=_dereq_("./GlobalEventBus"),_GlobalEventBus2=_interopRequireDefault(_GlobalEventBus),_utilsDelta=_dereq_("../utils/Delta"),UploadQueue=function(){this.queue=[],this.peerTimeouts={},this.saturated=!1,this.uploadSpeedCalculator=new _SpeedCalculator2["default"],this.uploadLimitation=_conf2["default"].MAX_UP_SPEED,this._timers=new _utilsTimers2["default"]};UploadQueue.prototype.add=function(e,t,u,i,r){this.queue.push({peer:e,segmentCoord:t,id_chunk:u,chunk:i,timeStamp:r}),this.resetPeerTimeout(e),this.sendChunk()},UploadQueue.prototype.removeFirstChunk=function(){this.queue.splice(0,1)},UploadQueue.prototype.getChunkToSend=function(){for(var e=Date.now();this.queue.length>0;){if(e-this.queue[0].timeStamp<_conf2["default"].CHUNK_UP_TIMEOUT)return this.queue[0];this.removeFirstChunk(),_GlobalEventBus2["default"].emit("uploadSaturated")}},UploadQueue.prototype.sendChunk=function(e){var t=this.uploadSpeedCalculator.calculateSpeed();if(t<this.uploadLimitation&&(!this.saturated||e)){var u=this.getChunkToSend();if(!u)return void this.unsetSaturated();var i=u.peer.getBufferedAmount();if(_utilsDelta.isNumeric(i)&&i<_conf2["default"].UP_MAX_BUFFERED_AMOUNT){this.uploadSpeedCalculator.addChunkTransfer();try{return u.peer.sendChunk(u.segmentCoord,u.id_chunk,u.chunk),this.removeFirstChunk(),this.resetPeerTimeout(u.peer),this.unsetSaturated(),void(this.uploadLimitation+=5)}catch(r){this.uploadLimitation>_conf2["default"].MAX_UP_SPEED&&(this.uploadLimitation=_conf2["default"].MAX_UP_SPEED),this.uploadLimitation>400?this.uploadLimitation-=200:this.uploadLimitation>100?this.uploadLimitation-=50:this.uploadLimitation=Math.ceil(this.uploadLimitation/2),this.setSaturated()}this.checkPeerTimeout(u.peer)}else this.uploadLimitation>30&&(this.uploadLimitation-=20,this.setSaturated())}this.setSaturated()},UploadQueue.prototype.checkPeerTimeout=function(e){var t=Date.now();this.peerTimeouts[e.getId()]?t-this.peerTimeouts[e.getId()]>_conf2["default"].PEER_UP_TIMEOUT&&this.clearChunksForPeer(e.getId()):this.peerTimeouts[e.getId()]=t},UploadQueue.prototype.resetPeerTimeout=function(e){delete this.peerTimeouts[e.getId()]},UploadQueue.prototype.clearChunksForPeer=function(e){this.queue=_underscore2["default"].reject(this.queue,function(t){return t.peer.getId()===e})},UploadQueue.prototype.setSaturated=function(){if(!this.saturated){this.saturated=!0;var e=_conf2["default"].CHUNK_SIZE/1024/(_conf2["default"].MAX_UP_SPEED/1e3);void 0===this.sendInterval&&(this.sendInterval=this._timers.setInterval(function(){this.sendChunk(!0)}.bind(this),e))}},UploadQueue.prototype.unsetSaturated=function(){this.saturated===!0,this.saturated=!1,this.queue.length||(this._timers.clearInterval(this.sendInterval),this.sendInterval=void 0)},UploadQueue.prototype.dispose=function(){this._timers.clearAll()},exports["default"]=UploadQueue,module.exports=exports["default"];

},{"../../conf":1,"../utils/Delta":56,"../utils/Timers":61,"./GlobalEventBus":14,"./SpeedCalculator":31,"babel-runtime/helpers/interop-require-default":92,"underscore":239}],34:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var DestroyedPeerConnection=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"sendMessage",value:function(){throw new Error("One should not call sendMessage on a PeerConnection that has already been destroyed")}},{key:"sendBinaryData",value:function(){throw new Error("One should not call sendBinaryData on a PeerConnection that has already been destroyed")}},{key:"getRtt",value:function(){throw new Error("One should not call getRtt on a PeerConnection that has already been destroyed")}},{key:"getBufferedAmount",value:function(){throw new Error("One should not call getBufferedAmount on a PeerConnection that has already been destroyed")}},{key:"destroy",value:function(){throw new Error("One should not call destroy on a PeerConnection that has already been destroyed")}},{key:"close",value:function(){throw new Error("One should not call close on a PeerConnection that has already been destroyed")}},{key:"on",value:function(){throw new Error("One should not call on on a PeerConnection that has already been destroyed")}}]),e}();exports["default"]=DestroyedPeerConnection,module.exports=exports["default"];

},{"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88}],35:[function(_dereq_,module,exports){
"use strict";function PeerConnection(e,t){function n(){t.onclose=function(){g.emit("disconnected")},t.onerror=function(e){g.emit("disconnected")},t.onmessage=l,_(),v.setInterval(o,_conf2["default"].PEER_COMPUTE_RTT_INTERVAL)}function r(e,n){if("open"===t.readyState){var r=JSON.stringify({type:e,args:n});_status2["default"].setRawDataUploaded(_status2["default"].getRawDataUploaded()+r.length),t.send(r)}else g.emit("disconnected")}function a(e){return"open"===t.readyState?(t.send(e),!0):(g.emit("disconnected"),!1)}function i(){return p}function o(){var t;e&&(navigator.mozGetUserMedia?e.getStats(null,function(e){for(var t in e){var n=e[t];if(void 0!==n.mozRtt){p=n.mozRtt;break}}},function(){}):e.getStats(function(e){var n,r,a=e.result();for(r=0;r<a.length;r++)if(n=a[r],""!==n.stat("googRtt")){t=n.stat("googRtt"),p=parseFloat(t);break}}))}function s(){return t.bufferedAmount}function u(){t.close(),e.close(),this.destroy()}function c(){v.clearAll(),_Object$assign(this,new _DestroyedPeerConnection2["default"])}function d(e,t){g.on(e,t)}function f(e,t){g.once(e,t)}function l(e){if(_status2["default"].setRawDataDownloaded(_status2["default"].getRawDataDownloaded()+e.data.length),m=!0,"string"==typeof e.data){var t=JSON.parse(e.data);switch(t.type){case"heartbeat":break;default:g.emit("message_received",t.type,t.args)}}else g.emit("binarydata_received",e.data)}function _(){v.setInterval(function(){m===!0?m=!1:(g.emit("disconnected"),"open"===t.readyState&&(t.close(),e.close()))},_conf2["default"].CHECK_HEARTBEAT_INTERVAL),v.setInterval(function(){return r("heartbeat")},_conf2["default"].SEND_HEARTBEAT_INTERVAL)}this.sendMessage=r,this.sendBinaryData=a,this.getRtt=i,this.getBufferedAmount=s,this.destroy=c,this.close=u,this.on=d,this.once=f;var m=!0,g=new _eventemitter32["default"],p=-1,v=new _utilsTimers2["default"];n()}var _Object$assign=_dereq_("babel-runtime/core-js/object/assign")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _eventemitter3=_dereq_("eventemitter3"),_eventemitter32=_interopRequireDefault(_eventemitter3),_utilsTimers=_dereq_("../../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),_conf=_dereq_("../../../conf"),_conf2=_interopRequireDefault(_conf),_status=_dereq_("../status"),_status2=_interopRequireDefault(_status),_DestroyedPeerConnection=_dereq_("./DestroyedPeerConnection"),_DestroyedPeerConnection2=_interopRequireDefault(_DestroyedPeerConnection);exports["default"]=PeerConnection,module.exports=exports["default"];

},{"../../../conf":1,"../../utils/Timers":61,"../status":45,"./DestroyedPeerConnection":34,"babel-runtime/core-js/object/assign":74,"babel-runtime/helpers/interop-require-default":92,"eventemitter3":195}],36:[function(_dereq_,module,exports){
"use strict";function errorHandler(e){}var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_Object$keys=_dereq_("babel-runtime/core-js/object/keys")["default"],_getIterator=_dereq_("babel-runtime/core-js/get-iterator")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _SignalingClient=_dereq_("./SignalingClient"),_SignalingClient2=_interopRequireDefault(_SignalingClient),_PeerConnection=_dereq_("./PeerConnection"),_PeerConnection2=_interopRequireDefault(_PeerConnection),_conf=_dereq_("../../../conf"),_conf2=_interopRequireDefault(_conf),_utilsWebRTC=_dereq_("../../utils/WebRTC"),_utilsWebRTC2=_interopRequireDefault(_utilsWebRTC),_status=_dereq_("../status"),_status2=_interopRequireDefault(_status),_utilsBucket=_dereq_("../../utils/Bucket"),_utilsBucket2=_interopRequireDefault(_utilsBucket),_utilsTimers=_dereq_("../../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),PeerConnector=function(){function e(n,t){_classCallCheck(this,e),this._signalingClient=new _SignalingClient2["default"],this._myPeerId=n,this._peerPool=t,this._signalingClient.connect(_conf2["default"].SIGNALING_URL,n),this._signalingClient.on("webrtc_offer",this._onOffer.bind(this)),this._signalingClient.on("webrtc_answer",this._onAnswer.bind(this)),this._signalingClient.on("webrtc_icecandidate",this._onIceCandidate.bind(this)),this._peerConnectionCollection={},this._timers=new _utilsTimers2["default"]}return _createClass(e,[{key:"createPeerConnection",value:function(e){var n=this,t=Math.random().toString().substr(2),i=_utilsWebRTC2["default"].createPeerConnection(),r=i.createDataChannel("comm",{ordered:!1,maxPacketLifeTime:1e3});r.binaryType="arraybuffer";var o=this._timers.setTimeout(function(){n._onConnexionTimeout(e,t)},_conf2["default"].PEER_CONNECTION_TIMEOUT),a=this._createOpenDataChannelHandler(i,r,o,e,t);r.onopen=a,this._peerConnectionCollection[t]={pc:i,connectionTimeout:o,dataChannel:r},i.createOffer(function(r){i.setLocalDescription(r,function(){var i=_utilsWebRTC2["default"].transformOutgoingSdp(r.sdp),o={type:"webrtc_offer",connexion_id:t,sender_id:n._myPeerId,receiver_id:e,sdp:i};n._signalingClient.send(o)},errorHandler)},errorHandler),this._manageIceCandidate(i,e,t)}},{key:"_manageIceCandidate",value:function(e,n,t){var i=this._createIceCandidateBucket(this._myPeerId,n,t);e.onicecandidate=function(e){e.candidate&&i.addElement(e.candidate)}}},{key:"_onConnexionRefused",value:function(e,n){var t=this._peerConnectionCollection[n].pc;t.close(),delete this._peerConnectionCollection[n],this._peerPool.offerDeclined(e)}},{key:"_onConnexionTimeout",value:function(e,n){var t=this._peerConnectionCollection[n].pc;t.close(),delete this._peerConnectionCollection[n],this._peerPool.connectionAttemptTimeout(e)}},{key:"_onOffer",value:function(e){var n=this,t=e.sender_id,i=e.connexion_id;if(this._peerPool.isFull()){var r={type:"webrtc_answer",connexion_id:i,sender_id:this._myPeerId,receiver_id:t,accepted:!1};return void this._signalingClient.send(r)}var o=_utilsWebRTC2["default"].createPeerConnection();this._peerConnectionCollection[i]={pc:o},this._manageIceCandidate(o,t,i);var a={sdp:e.sdp,type:"offer"},c=new _utilsWebRTC2["default"].SessionDescription(a);o.setRemoteDescription(c,function(){o.createAnswer(function(e){o.setLocalDescription(e,function(){e.sdp=_utilsWebRTC2["default"].transformOutgoingSdp(e.sdp);var r={type:"webrtc_answer",connexion_id:i,sender_id:n._myPeerId,receiver_id:t,accepted:!0,sdp:e.sdp};n._signalingClient.send(r)},errorHandler)},errorHandler)},errorHandler);var l=this._timers.setTimeout(function(){n._onConnexionTimeout(t,i)},_conf2["default"].PEER_CONNECTION_TIMEOUT);o.ondatachannel=function(e){var r=e.channel||e;r.binaryType="arraybuffer",r=r;var a=n._createOpenDataChannelHandler(o,r,l,t,i);"connecting"==r.readyState?r.onopen=a:a(),r.onerror=errorHandler}}},{key:"_createOpenDataChannelHandler",value:function(e,n,t,i,r){var o=this;return function(){if(o._peerConnectionCollection[r]){delete o._peerConnectionCollection[r],o._timers.clearTimeout(t);var a=new _PeerConnection2["default"](e,n);o._peerPool.addPeerConnection(i,a)}}}},{key:"_onAnswer",value:function(e){var n=e.sender_id,t=e.connexion_id;if(this._peerConnectionCollection[t]){var i=this._peerConnectionCollection[t],r=i.pc,o=i.connectionTimeout;if(r)if(e.accepted){var a={sdp:e.sdp,type:"answer"},c=new _utilsWebRTC2["default"].SessionDescription(a);r.setRemoteDescription(c,function(){},errorHandler)}else this._timers.clearTimeout(o),this._onConnexionRefused(n,t)}}},{key:"_onIceCandidate",value:function(e){var n=this,t=e.connexion_id;if(this._peerConnectionCollection[t]){var i=this._peerConnectionCollection[t].pc;e.icecandidate_array.forEach(function(e){n._addIceCandidate(i,e)})}}},{key:"_addIceCandidate",value:function(e,n){try{e.addIceCandidate(new _utilsWebRTC2["default"].IceCandidate(n))}catch(t){}}},{key:"_createIceCandidateBucket",value:function(e,n,t){var i=this,r=function(r){var o={type:"webrtc_icecandidate",connexion_id:t,sender_id:e,receiver_id:n,icecandidate_array:r};i._signalingClient.send(o)},o=new _utilsBucket2["default"](r,_status2["default"].incrementMissedIceCandidateCount,_conf2["default"].ICECANDIDATES_TIMEOUT);return o}},{key:"dispose",value:function(){this._signalingClient.close(),this._timers.clearAll();var e=_Object$keys(this._peerConnectionCollection),n=!0,t=!1,i=void 0;try{for(var r,o=_getIterator(e);!(n=(r=o.next()).done);n=!0){var a=r.value,c=this._peerConnectionCollection[a].pc;c.close()}}catch(l){t=!0,i=l}finally{try{!n&&o["return"]&&o["return"]()}finally{if(t)throw i}}}}]),e}();exports["default"]=PeerConnector,module.exports=exports["default"];

},{"../../../conf":1,"../../utils/Bucket":52,"../../utils/Timers":61,"../../utils/WebRTC":62,"../status":45,"./PeerConnection":35,"./SignalingClient":37,"babel-runtime/core-js/get-iterator":71,"babel-runtime/core-js/object/keys":81,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/interop-require-default":92}],37:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../../conf"),_conf2=_interopRequireDefault(_conf),_underscore=_dereq_("underscore"),_underscore2=_interopRequireDefault(_underscore),_status=_dereq_("../status"),_status2=_interopRequireDefault(_status),SignalingClient=function(){function e(){_classCallCheck(this,e),this._init()}return _createClass(e,[{key:"connect",value:function(e,t){this._url=e,this._id=t,this._createConnection()}},{key:"send",value:function(e){if(this._connection&&this._connection.readyState===WebSocket.OPEN){var t=e.receiver_id+","+JSON.stringify(_underscore2["default"].omit(e,"receiver_id"));this._connection.send(t)}else this._msgBuffer.push(e)}},{key:"on",value:function(e,t){this._handlers[e]=t}},{key:"close",value:function(){this._disposing=!0,_status2["default"].setDisconnectedToSignalingServer(),this._stopReconnectionLoop(),this._connection&&this._connection.close(),void 0!==this._connectionTimeout&&(clearTimeout(this._connectionTimeout),delete this._connectionTimeout),void 0!==this._nextReconnectAttempt&&(clearTimeout(this._nextReconnectAttempt),delete this._nextReconnectAttempt),this._init()}},{key:"_createConnection",value:function(){!this._connection||this._connection.readyState!=WebSocket.CONNECTING&&this._connection.readyState!=WebSocket.OPEN||this.close();var e="3.0.12";this._connection=new WebSocket(this._url+"?id="+this._id+"&p2pVersion="+e+"&client_id="+_conf2["default"].ID_CLIENT);var t=this._connection;this._connectionTimeout=setTimeout(function(){t.close()},1e4),this._handleConnectionSuccess(),this._handleErrorAndClose(),this._handleMessages()}},{key:"_handleErrorAndClose",value:function(){var e=this,t=this._connection,n=function(){t===e._connection&&(_status2["default"].setDisconnectedToSignalingServer(),e._tryReconnect())};this._connection.onerror=n,this._connection.onclose=n}},{key:"_tryReconnect",value:function(){var e=this,t=function(){delete e._nextReconnectAttempt,e._createConnection(),e._updateDelay()};void 0!==this._nextReconnectAttempt||this._disposing||(this._nextReconnectAttempt=setTimeout(t,this._delayReconnection))}},{key:"_updateDelay",value:function(){this._delayReconnection=Math.min(this._delayReconnection+_conf2["default"].SIGNALING_DELAY_STEP,_conf2["default"].SIGNALING_DELAY_MAX)}},{key:"_handleConnectionSuccess",value:function(){var e=this;this._connection.onopen=function(){_status2["default"].setConnectedToSignalingServer(),clearTimeout(e._connectionTimeout),delete e._connectionTimeout,e._stopReconnectionLoop(),e._sendMessagesInBuffer()}}},{key:"_handleMessages",value:function(){var e=this;this._connection.onmessage=function(t){var n=JSON.parse(t.data);if(e._handlers[n.type]){var i=_underscore2["default"].omit(n,"type");e._handlers[n.type](i)}}}},{key:"_init",value:function(){this._handlers={},this._delayReconnection=0,this._msgBuffer=[]}},{key:"_stopReconnectionLoop",value:function(){this._delayReconnection=0}},{key:"_sendMessagesInBuffer",value:function(){this._msgBuffer.forEach(this.send.bind(this)),this._msgBuffer=[]}}]),e}();exports["default"]=SignalingClient,module.exports=exports["default"];

},{"../../../conf":1,"../status":45,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/interop-require-default":92,"underscore":239}],38:[function(_dereq_,module,exports){
(function (global){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _status=_dereq_("../status"),_status2=_interopRequireDefault(_status),DisplayInterface=function(e,t){var a=function(){var a,u={download:{p2pDownloaded:_status2["default"].getP2PDownloaded(),p2pDownloadedNewAnalytics:_status2["default"].getp2pDownloadedNewAnalytics(),p2pUploaded:_status2["default"].getP2PUploaded(),cdnDownloaded:_status2["default"].getCDNDownloaded(),dlSpeed:_status2["default"].getDlSpeed(),upSpeed:_status2["default"].getUpSpeed()},peers:{count:0},bufferLevel:_status2["default"].getBufferLevel(),tracker:{connected:_status2["default"].getConnected()},trackerConnected:_status2["default"].getConnected(),sigConnected:_status2["default"].getConnectedToSignalingServer(),isLive:t()},d=[];for(a=0;a<e.getPeerArray().length;a++){var s=e.getPeerArray()[a];s.getId()&&u.peers.count++,d.push(s.getDebugInfos())}return u.peerList=d,u},u=function(){global.SR_DISPLAY_INTERFACE={getStats:a}};u(),this.dispose=function(){delete window.SR_DISPLAY_INTERFACE}};exports["default"]=DisplayInterface,module.exports=exports["default"];

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../status":45,"babel-runtime/helpers/interop-require-default":92}],39:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var MapInterface=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getSegmentTime",value:function(e){}},{key:"getSegmentList",value:function(e,t,a){}}]),e}();exports["default"]=MapInterface,module.exports=exports["default"];

},{"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88}],40:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var SegmentCoordInterface=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isEqual",value:function(e){}},{key:"viewToString",value:function(){}},{key:"toArrayBuffer",value:function(){}},{key:"isInTrack",value:function(e){}}]),e}();SegmentCoordInterface.fromArrayBuffer=function(e){},exports["default"]=SegmentCoordInterface,module.exports=exports["default"];

},{"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88}],41:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var TrackCoordInterface=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"viewToString",value:function(){}},{key:"isEqual",value:function(e){}}]),e}();exports["default"]=TrackCoordInterface,module.exports=exports["default"];

},{"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88}],42:[function(_dereq_,module,exports){
"use strict";var _Object$defineProperties=_dereq_("babel-runtime/core-js/object/define-properties")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _utilsDelta=_dereq_("../utils/Delta"),moduleState=_Object$defineProperties({updateCurrentTracks:function(e){var t=e.video;t&&(this._currentVideoTrack=t)},getVideoTrackHash:function(){return this._currentVideoTrack?this._currentVideoTrack.viewToString():"defaultTrackHash"}},{videoCurrentTime:{set:function(e){this._videoCurrentTime=e},get:function(){if(_utilsDelta.isNumeric(this._videoCurrentTime))return this._videoCurrentTime;throw new Error("Attempt to use a track video currentTime before setting it")},configurable:!0,enumerable:!0},content:{set:function(e){this._content=e},get:function(){if(this._content)return this._content;throw new Error("Attempt to use the content identifier before setting it")},configurable:!0,enumerable:!0}});exports["default"]=moduleState,module.exports=exports["default"];

},{"../utils/Delta":56,"babel-runtime/core-js/object/define-properties":76}],43:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _status=_dereq_("./status"),_status2=_interopRequireDefault(_status),_conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_Heuristic=_dereq_("./Heuristic"),_Heuristic2=_interopRequireDefault(_Heuristic),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),_utilsCartography=_dereq_("../utils/Cartography"),_utilsCartography2=_interopRequireDefault(_utilsCartography),_utilsChunkMetadata=_dereq_("../utils/ChunkMetadata"),_metricsMovingAverage=_dereq_("../metrics/MovingAverage"),_metricsMovingAverage2=_interopRequireDefault(_metricsMovingAverage),_structuresSegmentInfo=_dereq_("./structures/SegmentInfo"),_structuresSegmentInfo2=_interopRequireDefault(_structuresSegmentInfo),Peer=function(e,t,n,u){var a,r,s,o,i,d=0,f=0,c=0,l=0,_=Date.now(),g=0,m=0,p=Date.now(),h=t,v=e,D=0,y=0,C=new _Heuristic2["default"],L=this,S=new _utilsTimers2["default"],q=0,E=new _metricsMovingAverage2["default"](_conf2["default"].PEER_INSTANT_SPEED_CALCULATION_WINDOW),I=function(){return _utilsCartography2["default"].getDistanceFromLatitudeLongitude(s,_status2["default"].getMyLocation().latitude,o,_status2["default"].getMyLocation().longitude)},M=function(){var e=Date.now(),t=e-_;D=c/1024/(t/1e3),y=l/1024/(t/1e3),c=0,l=0,_=e},A=function(){E.addPoint(d-q),q=d},P=function(){return E.compute()/(_conf2["default"].PEER_INSTANT_SPEED_CALCULATION_INTERVAL/1e3)},w=function(){var e=Date.now(),n=(e-p)/1e3,u=d+f-(g+m);u<_conf2["default"].MIN_USEFUL_SPEED*n&&(t.emit("remove_peer",L,!1),U()),g=d,m=f,p=e},R=function F(){_status2["default"].getMyLocation().city?u.sendMessage("info",{bufferLevel:_status2["default"].getBufferLevel(),city:_status2["default"].getMyLocation().city,country:_status2["default"].getMyLocation().country,latitude:_status2["default"].getMyLocation().latitude,longitude:_status2["default"].getMyLocation().longitude}):_status2["default"].getEE().once("location_updated",F)},b=function(e){u.sendMessage("requestHasSegment",e)},k=function(e,t){u.sendMessage("hasSegment",{segmentInfo:e,progress:t})},N=function(e,t){u.sendMessage("requestChunk",{segmentCoord:e,id_chunk:t}),C.incrementNbChunkRequested()},T=function(){return C.getNbChunkRequested()<_conf2["default"].MAX_CHUNK_BY_SEEDER},U=function(){S.clearAll(),C.dispose(),u.close()},H=function(){S.clearAll(),C.dispose(),u.destroy()},B=function(){S.setInterval(M,1e3),S.setInterval(w,_conf2["default"].CHECK_USELESS_INTERVAL),S.setInterval(A,_conf2["default"].PEER_INSTANT_SPEED_CALCULATION_INTERVAL),R(),_status2["default"].incrementNewPeerConnectionCount(),u.once("disconnected",function(){t.emit("remove_peer",L,!1),H()}),u.on("binarydata_received",x),u.on("message_received",O)},O=function(e,t){switch(e){case"info":a=t.city,r=t.country,s=t.latitude,o=t.longitude,i=t.bufferLevel;break;case"requestHasSegment":h.emit("segmentRequested",L,new n(t));break;case"hasSegment":var u=new n(t.segmentInfo.segmentCoord),d=new _structuresSegmentInfo2["default"](u,t.segmentInfo.size,t.segmentInfo.hash,t.segmentInfo.time);h.emit("hasSegment",L,t.progress,d);break;case"requestChunk":h.emit("chunkRequested",L,new n(t.segmentCoord),t.id_chunk);break;default:throw new Error("wrong message sent by peerConnection")}},x=function(e){var u=_utilsChunkMetadata.parseMetaData(e,n.fromArrayBuffer);c+=u.data.byteLength,d+=u.data.byteLength,_status2["default"].setP2PDownloadedUncorrected(_status2["default"].getP2PDownloadedUncorrected()+u.data.byteLength),_status2["default"].setP2PDownloaded(_status2["default"].getP2PDownloaded()+u.data.byteLength),t.emit("chunkReceived",L,u.segmentCoord,u.id_chunk,u.data)},V=function(e,t,n){var a=n.byteLength,r=_utilsChunkMetadata.encodeMetaData(e,t,n),s=u.sendBinaryData(r);return s?(l+=a,f+=a,_status2["default"].setP2PUploaded(_status2["default"].getP2PUploaded()+a),void 0):!1};L.getRtt=u.getRtt.bind(u),L.getDistance=I,L.requestHasSegment=b,L.answerHasSegment=k,L.requestChunk=N,L.sendChunk=V,L.canBeAskedChunk=T,L.close=U,L.getDataDownloaded=function(){return d},L.getDataUploaded=function(){return f},L.getBufferLevel=function(){return i},L.getId=function(){return v},L.getDlSpeed=function(){return D},L.getUpSpeed=function(){return y},L.getBufferedAmount=u.getBufferedAmount.bind(u),L.getHeuristic=function(){return C},L.getDebugInfos=function(){return{country:r,city:a,bufferLevel:i,dlSpeed:D,upSpeed:y,dataDownloaded:d,dataUploaded:f,rtt:u.getRtt(),distance:I()}},this.getMeanInstantSpeed=P,B()};exports["default"]=Peer,module.exports=exports["default"];

},{"../../conf":1,"../metrics/MovingAverage":6,"../utils/Cartography":54,"../utils/ChunkMetadata":55,"../utils/Timers":61,"./Heuristic":15,"./status":45,"./structures/SegmentInfo":48,"babel-runtime/helpers/interop-require-default":92}],44:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),_underscore=_dereq_("underscore"),_underscore2=_interopRequireDefault(_underscore),_status=_dereq_("./status"),_status2=_interopRequireDefault(_status),_eventemitter3=_dereq_("eventemitter3"),_eventemitter32=_interopRequireDefault(_eventemitter3),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),_peer=_dereq_("./peer"),_peer2=_interopRequireDefault(_peer),_communicationPeerConnector=_dereq_("./communication/PeerConnector"),_communicationPeerConnector2=_interopRequireDefault(_communicationPeerConnector),_ExclusionCollection=_dereq_("./ExclusionCollection"),_ExclusionCollection2=_interopRequireDefault(_ExclusionCollection),PeerPool=function(e,t){var n,o,r=e,u=!1,i=[],a=this,s=new _eventemitter32["default"],c=new _ExclusionCollection2["default"](_conf2["default"].OFFER_DECLINED_TIMEOUT),l=new _ExclusionCollection2["default"](_conf2["default"].PEER_REMOVED_TIMEOUT),f=new _ExclusionCollection2["default"](_conf2["default"].PEER_CONNEXION_ATTEMPT_TIMEOUT),_=new _utilsTimers2["default"],d=function(){_.setInterval(E,_conf2["default"].SPEED_MONITOR_INTERVAL),s.on("remove_peer",R),_.setInterval(m,_conf2["default"].MEAN_SPEED_CALCULATION_INTERVAL),r.getEE().on("tracker_ready",P,a),r.getEE().on("tracker_disconnected",v,a)},E=function(){var e=0,t=0;_underscore2["default"].forEach(i,function(n){e+=n.getDlSpeed(),t+=n.getUpSpeed()}),_status2["default"].setDlSpeed(e),_status2["default"].setUpSpeed(t),_status2["default"].computeMaxAndAvgSpeed()},p=function(){var e=0;_underscore2["default"].forEach(i,function(t){e+=t.getMeanInstantSpeed()});var t=Math.max(0,_status2["default"].getp2pDownloadedNewAnalytics()),n=_status2["default"].getP2PDownloadedUncorrected();return n&&(e*=t/n),e},m=function(){var e=p();_status2["default"].setMeanInstantSpeed(e)},P=function(){o=new _communicationPeerConnector2["default"](_status2["default"].getMyPeerId(),this),n||(n=_.setInterval(D,_conf2["default"].ASK_PEERS_INTERVAL)),u||D(),u=!0},v=function(){n&&(_.clearInterval(n),n=void 0)},R=function(e){l.add(e.getId()),s.emit("peerDestroyed",e),i=_underscore2["default"].without(i,e)},D=function(){if(i.length<_conf2["default"].MIN_NUMBER_OF_PEERS){var e=g();_status2["default"].onPeerUpdateRequest();var t=Date.now();r.askPeers(e,function(e,n){var r=Date.now()-t;_status2["default"].onPeerUpdateResponse(r);var u=0;n.forEach(function(e){e.peers.forEach(function(e){i.length+u<_conf2["default"].MIN_NUMBER_OF_PEERS&&(o.createPeerConnection(e),u++)})})})}},g=function(){var e,t=[];for(e=0;e<i.length;e++)t.push(i[e].getId());return t=t.concat(l.getExclusionList(),c.getExclusionList(),f.getExclusionList())},q=function(){return i.length>=_conf2["default"].MAX_NUMBER_OF_PEERS},I=function(e){i.forEach(function(t){t.requestHasSegment(e)})},T=function(){i.forEach(function(e){e.close(),s.emit("peerDestroyed",e)}),i=[]},h=function(e,n){if(q())n.destroy();else{var o=new _peer2["default"](e,s,t,n);i.push(o)}},M=function(e){c.add(e)},C=function(e){f.add(e)},x=function(){r.dispose(),_.clearAll(),T(),c.dispose(),l.dispose(),f.dispose()};a.getPeerArray=function(){return i},a.requestHasSegment=I,a.getEE=function(){return s},a.isFull=q,a.addPeerConnection=h,this.offerDeclined=M,this.connectionAttemptTimeout=C,a.dispose=x,d()};exports["default"]=PeerPool,module.exports=exports["default"];

},{"../../conf":1,"../utils/Timers":61,"./ExclusionCollection":12,"./communication/PeerConnector":36,"./peer":43,"./status":45,"babel-runtime/helpers/interop-require-default":92,"eventemitter3":195,"underscore":239}],45:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _eventemitter3=_dereq_("eventemitter3"),_eventemitter32=_interopRequireDefault(_eventemitter3),_utilsTimers=_dereq_("../utils/Timers"),_utilsTimers2=_interopRequireDefault(_utilsTimers),conf=_dereq_("../../conf"),Status=function(){var e,n,t,o,u,r,i,c,a,d,f,s,l,g,D,p,w,C,P,T,m,_,h,v,S,N,M,k,R,b,U,H,y,q,A,L,x,I,W,B,E,j,O,z,F,G,J,K,Q,V,X,Y,Z,$=this,ee=function(){e=!1,t={city:null,country:null,latitude:null,longitude:null},o=void 0,u=0,r=0,i=0,c=0,a=0,d=0,f=0,s=0,l=0,g=0,D=0,p=0,w=0,C=0,P=0,T=[],m=0,_=0,h=0,v=0,S=0,N=0,M=0,k=0,R=0,b=0,U=0,H=0,y=0,q=0,A=0,L=0,x=0,I=0,W=0,B=0,E=0,j=0,O=0,z=[],F=-1,G=0,J=0,$=this,K=void 0,Q=void 0,V=void 0,X=new _eventemitter32["default"],Y=void 0,Z=new _utilsTimers2["default"],Z.setInterval(te.bind($),1e3)},ne=function(){var e,n,t,o;u&&(u>i&&(i=u),e=r?(r*Q+u)/(Q+1):u,n=Q?Q+1:1,Q=n,r=e),c&&(c>d&&(d=c),t=a?(a*V+c)/(V+1):c,o=V?V+1:1,V=o,a=t)},te=function(){var e,n=T,t=Date.now();for(n.push({p2pDownloaded:s,timeStamp:t}),e=n.length-1;e>=0;e--)t-n[e].timeStamp>1e3*conf.ABR_DEL_T&&n.splice(e,1)},oe=function(){var e,n,t,o,u=T;return u.length?(e=u[0],n=u[u.length-1],t=n.p2pDownloaded-e.p2pDownloaded,o=(n.timeStamp-e.timeStamp)/1e3,o>0&&t>0?t/o:0):0},ue=function(){F++},re=function(){j++},ie=function(){return j},ce=function(e){O++,z.push(e)},ae=function(){return O},de=function(){var e=0,n=0;if(z.length>0){for(var t=0;t<z.length;t++)e+=z[t];n=e/z.length}return z=[],n},fe=function(){Z.clearAll()};$.getMyPeerId=function(){return o},$.setMyPeerId=function(e){o!==e&&(o=e)},$.getMyLocation=function(){return t},$.setMyLocation=function(e){t=e,X.emit("location_updated",e)},$.getDataDownloadedTwice=function(){return K},$.correctP2PDownloaded=function(e,n){isNaN(e)||("PP"===n?(m+=e,s-=e):"PC"===n?(_+=e,s-=e,s=l-e):"CP"===n?(h+=e,s-=e):"CC"===n?v+=e:"HP"===n?(S+=e,s-=e):"HD"===n?(N+=e,s-=e):"M"===n&&(M+=e,s-=e))},$.getDlSpeed=function(){return u},$.setDlSpeed=function(e){u=e},$.getAvgDlSpeed=function(){return r},$.getMaxDlSpeed=function(){return i},$.getUpSpeed=function(){return c},$.setUpSpeed=function(e){c=e},$.getAvgUpSpeed=function(){return a},$.getMaxUpSpeed=function(){return d},$.getP2PDownloaded=function(){return s},$.setP2PDownloaded=function(e){"number"!=typeof e||isNaN(e)||(s=e)},$.getp2pDownloadedNewAnalytics=function(){return l},$.setp2pDownloadedNewAnalytics=function(e){"number"!=typeof e||isNaN(e)||(l=e)},$.getP2PDownloadedUncorrected=function(){return g},$.setP2PDownloadedUncorrected=function(e){g=e},$.getP2PUploaded=function(){return D},$.setP2PUploaded=function(e){D=e},$.getRawDataDownloaded=function(){return p},$.setRawDataDownloaded=function(e){p=e},$.getRawDataUploaded=function(){return w},$.setRawDataUploaded=function(e){w=e},$.getCDNDownloaded=function(){return C},$.setCDNDownloaded=function(e){C=e},$.getCdnCancelled=function(){return P},$.setCdnCancelled=function(e){P=e},$.getDataDownloadedTwice_PP=function(){return m},$.setDataDownloadedTwice_PP=function(e){m=e},$.getDataDownloadedTwice_PC=function(){return _},$.setDataDownloadedTwice_PC=function(e){_=e},$.getDataDownloadedTwice_CP=function(){return h},$.setDataDownloadedTwice_CP=function(e){h=e},$.getDataDownloadedTwice_CC=function(){return v},$.setDataDownloadedTwice_CC=function(e){v=e},$.getDataDownloadedTwice_HP=function(){return S},$.setDataDownloadedTwice_HP=function(e){S=e},$.getDataDownloadedTwice_HD=function(){return N},$.setDataDownloadedTwice_HD=function(e){N=e},$.getDataDownloadedTwice_M=function(){return M},$.setDataDownloadedTwice_M=function(e){M=e},$.getCdnDataDiscarded=function(){return k},$.setCdnDataDiscarded=function(e){k=e},$.getP2PDoubleCheck=function(){return R},$.setP2PDoubleCheck=function(e){R=e},$.getCDNDoubleCheck=function(){return b},$.setCDNDoubleCheck=function(e){b=e},$.getNbRightHashP2P=function(){return U},$.setNbRightHashP2P=function(e){U=e},$.getNbWrongHashP2P=function(){return H},$.setNbWrongHashP2P=function(e){H=e},$.getNbRightHashDLM=function(){return y},$.setNbRightHashDLM=function(e){y=e},$.getNbWrongHashDLM=function(){return q},$.setNbWrongHashDLM=function(e){q=e},$.getTrackerMsgCount=function(){return A},$.setTrackerMsgCount=function(e){A=e},$.getTrackerSgnCount=function(){return L},$.setTrackerSgnCount=function(e){L=e},$.getTrackerConnectionCount=function(){return x},$.incrementTrackerConnectionCount=function(){x++},$.getTrackerReconnectionCount=function(){return W},$.incrementTrackerReconnectionCount=function(){W++},$.getTrackerDeconnectionCount=function(){return I},$.incrementTrackerDeconnectionCount=function(){I++},$.incrementNewPeerConnectionCount=function(){J++},$.getNewPeerConnectionCount=function(){return J},$.getConnected=function(){return e},$.getUpgraded=function(){return n},$.setTrackerConnectionTime=function(e){B=e},$.getTrackerConnectionTime=function(){return B},$.incrementMissedIceCandidateCount=function(){G++},$.getMissedIceCandidateCount=function(){return G},$.setConnected=function(n){n!==e&&(e=n,X.emit("change:connected"),n===!0&&X.emit("tracker_ready"))},$.setUpgraded=function(){n=!0},$.getEE=function(){return X},$.setConnectedToSignalingServer=function(){E=1},$.setDisconnectedToSignalingServer=function(){E=0},$.getConnectedToSignalingServer=function(){return E},$.computeMaxAndAvgSpeed=ne,$.computeP2PThroughput=oe,$.setMeanInstantSpeed=function(e){f=e},$.getMeanInstantSpeed=function(){return f},$.setBufferLevel=function(e){Y=e},$.getBufferLevel=function(){return Y},$.incrementTrackSwitchCount=ue,$.getTrackSwitchCount=function(){return F},$.onPeerUpdateRequest=re,$.getPeerUpdateRequestCount=ie,$.onPeerUpdateResponse=ce,$.getPeerUpdateResponseCount=ae,$.getPeerUpdateAvgResponseTime=de,$.dispose=fe,$.reset=ee},_status=new Status;exports["default"]=_status,module.exports=exports["default"];

},{"../../conf":1,"../utils/Timers":61,"babel-runtime/helpers/interop-require-default":92,"eventemitter3":195}],46:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_Object$seal=_dereq_("babel-runtime/core-js/object/seal")["default"],_Symbol$iterator=_dereq_("babel-runtime/core-js/symbol/iterator")["default"],_regeneratorRuntime=_dereq_("babel-runtime/regenerator")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var CurrentTracksStruct=function(){function e(){_classCallCheck(this,e),this.audio=void 0,this.video=void 0,_Object$seal(this)}return _createClass(e,[{key:"update",value:function(e){var t=e.audio,r=e.video;if(!t&&!r)throw new Error("There must be at least one updated track");this.audio=t||this.audio,this.video=r||this.video}},{key:_Symbol$iterator,value:_regeneratorRuntime.mark(function t(){return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.video){e.next=3;break}return e.next=3,{coord:this.video,type:"video"};case 3:if(!this.audio){e.next=6;break}return e.next=6,{coord:this.audio,type:"audio"};case 6:case"end":return e.stop()}},t,this)})}]),e}();exports["default"]=CurrentTracksStruct,module.exports=exports["default"];

},{"babel-runtime/core-js/object/seal":82,"babel-runtime/core-js/symbol/iterator":86,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/regenerator":95}],47:[function(_dereq_,module,exports){
"use strict";var _classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_Object$freeze=_dereq_("babel-runtime/core-js/object/freeze")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _ChunkManager=_dereq_("../ChunkManager"),_ChunkManager2=_interopRequireDefault(_ChunkManager),_Seeders=_dereq_("../Seeders"),_Seeders2=_interopRequireDefault(_Seeders),_expectedInterfacesSegmentCoordInterface=_dereq_("../expectedInterfaces/SegmentCoordInterface"),_expectedInterfacesSegmentCoordInterface2=_interopRequireDefault(_expectedInterfacesSegmentCoordInterface),_utilsInterface=_dereq_("../../utils/Interface"),SegmentHandler=function e(r,t,a,n){_classCallCheck(this,e),_utilsInterface.checkInterface(_expectedInterfacesSegmentCoordInterface2["default"],r),this.segmentCoord=r,this.chunkManager=new _ChunkManager2["default"](r,t,a,n),this.seeders=new _Seeders2["default"],_Object$freeze(this)};exports["default"]=SegmentHandler,module.exports=exports["default"];

},{"../../utils/Interface":57,"../ChunkManager":9,"../Seeders":27,"../expectedInterfaces/SegmentCoordInterface":40,"babel-runtime/core-js/object/freeze":78,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/interop-require-default":92}],48:[function(_dereq_,module,exports){
"use strict";var _classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_Object$freeze=_dereq_("babel-runtime/core-js/object/freeze")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _utilsDelta=_dereq_("../../utils/Delta"),_expectedInterfacesSegmentCoordInterface=_dereq_("../expectedInterfaces/SegmentCoordInterface"),_expectedInterfacesSegmentCoordInterface2=_interopRequireDefault(_expectedInterfacesSegmentCoordInterface),_utilsInterface=_dereq_("../../utils/Interface"),SegmentInfo=function e(t,r,a,i){if(_classCallCheck(this,e),_utilsInterface.checkInterface(_expectedInterfacesSegmentCoordInterface2["default"],t),!_utilsDelta.isNumeric(i))throw new Error("Invalid value for time");if(!_utilsDelta.isNumeric(r))throw new Error("Invalid value for size");if(!a)throw new Error("No hash");this.segmentCoord=t,this.time=i,this.size=r,this.hash=a,_Object$freeze(this)};exports["default"]=SegmentInfo,module.exports=exports["default"];

},{"../../utils/Delta":56,"../../utils/Interface":57,"../expectedInterfaces/SegmentCoordInterface":40,"babel-runtime/core-js/object/freeze":78,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/interop-require-default":92}],49:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],_Object$seal=_dereq_("babel-runtime/core-js/object/seal")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _utilsDelta=_dereq_("../../utils/Delta"),_moduleState=_dereq_("../moduleState"),_moduleState2=_interopRequireDefault(_moduleState),TrackEdges=function(){function e(){_classCallCheck(this,e),this._audio=void 0,this._video=void 0,_Object$seal(this)}return _createClass(e,[{key:"update",value:function(e){var t=e.audio,i=e.video;if(!_utilsDelta.isNumeric(t)&&!_utilsDelta.isNumeric(i))throw new Error("There must be at least one updated track edge");_utilsDelta.isNumeric(t)&&(this._audio=t),_utilsDelta.isNumeric(i)&&(this._video=i,_moduleState2["default"].videoCurrentTime=i)}},{key:"audio",get:function(){return this._audio}},{key:"video",get:function(){return this._video}}]),e}();exports["default"]=TrackEdges,module.exports=exports["default"];

},{"../../utils/Delta":56,"../moduleState":42,"babel-runtime/core-js/object/seal":82,"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88,"babel-runtime/helpers/interop-require-default":92}],50:[function(_dereq_,module,exports){
"use strict";function HashWorker(){var e={mul32:function(e,t){var a=65535&t,s=t-a;return(s*e|0)+(a*e|0)|0},hashBytes:function(e,t,a){for(var s=3432918353,r=461845907,n=a,o=-4&t,u=0;o>u;u+=4){var h=255&e[u]|(255&e[u+1])<<8|(255&e[u+2])<<16|(255&e[u+3])<<24;h=this.mul32(h,s),h=(131071&h)<<15|h>>>17,h=this.mul32(h,r),n^=h,n=(524287&n)<<13|n>>>19,n=5*n+3864292196|0}switch(h=0,t%4){case 3:h=(255&e[o+2])<<16;case 2:h|=(255&e[o+1])<<8;case 1:h|=255&e[o],h=this.mul32(h,s),h=(131071&h)<<15|h>>>17,h=this.mul32(h,r),n^=h}return n^=t,n^=n>>>16,n=this.mul32(n,2246822507),n^=n>>>13,n=this.mul32(n,3266489909),n^=n>>>16}};self.onmessage=function(t){var a=new Uint8Array(t.data.segmentData),s=e.hashBytes(a,a.length,0).toString();self.postMessage({segmentData:t.data.segmentData,jobIndex:t.data.jobIndex,hash:s},[t.data.segmentData])}}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=HashWorker,module.exports=exports["default"];

},{}],51:[function(_dereq_,module,exports){
"use strict";function createWorker(){var e=URL.createObjectURL(new Blob(["("+_HashWorker2["default"].toString()+")()"],{type:"application/javascript"})),r=new Worker(e);return URL.revokeObjectURL(e),r}function onMessage(e){var r=e.data,a=r.jobIndex,t=r.segmentData,o=r.hash,u=_queue[a];delete _queue[a],u(t,o)}function callHashWorker(e,r){var a=_queue.push(r)-1;_worker.postMessage({segmentData:e,jobIndex:a},[e])}var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _HashWorker=_dereq_("./HashWorker"),_HashWorker2=_interopRequireDefault(_HashWorker),_queue=[],_worker=createWorker();_worker.onmessage=onMessage,exports["default"]=callHashWorker,module.exports=exports["default"];

},{"./HashWorker":50,"babel-runtime/helpers/interop-require-default":92}],52:[function(_dereq_,module,exports){
"use strict";var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _Timers=_dereq_("./Timers"),_Timers2=_interopRequireDefault(_Timers),Bucket=function(e,t,r){var u=[],i=!1,s=new _Timers2["default"],n=function(e){i?t(e):u.push(e)},o=function(){s.setTimeout(function(){i=!0,e(u),u=[]},r)};o(),this.addElement=n};exports["default"]=Bucket,module.exports=exports["default"];

},{"./Timers":61,"babel-runtime/helpers/interop-require-default":92}],53:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var uint16ToUint8Array2=function(r){var t=Math.floor(r/256),n=r%256;return new Uint8Array([n,t])},numToUint8Array4=function(r){var t=uint16ToUint8Array2(Math.floor(r/65536)),n=uint16ToUint8Array2(r%65536);return new Uint8Array([n[0],n[1],t[0],t[1]])};exports.uint16ToUint8Array2=uint16ToUint8Array2,exports.numToUint8Array4=numToUint8Array4;

},{}],54:[function(_dereq_,module,exports){
"use strict";var getDistanceFromLatitudeLongitude=function(t,a,e,i){var n=6371,s=(t-a)*Math.PI/180,h=(e-i)*Math.PI/180,M=t*Math.PI/180,o=a*Math.PI/180,r=Math.sin(s/2)*Math.sin(s/2)+Math.sin(h/2)*Math.sin(h/2)*Math.cos(M)*Math.cos(o),u=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),c=n*u;return c};module.exports={getDistanceFromLatitudeLongitude:getDistanceFromLatitudeLongitude};

},{}],55:[function(_dereq_,module,exports){
"use strict";function encodeMetaData(e,t,r){var a=e.toArrayBuffer(),n=_Bytes.numToUint8Array4(t),s=r.byteLength,i=_Bytes.uint16ToUint8Array2(s),y=new Uint8Array(n.byteLength+i.byteLength+s+a.byteLength);return y.set(n,0),y.set(i,4),y.set(new Uint8Array(r),6),y.set(new Uint8Array(a),6+s),y.buffer}function parseMetaData(e,t){var r=e.slice(0,4),a=e.slice(4,6),n=new Uint16Array(a)[0],s=e.slice(6,6+n),i=e.slice(6+n),y=new Uint32Array(r)[0],o=t(i);return{segmentCoord:o,id_chunk:y,data:s}}Object.defineProperty(exports,"__esModule",{value:!0});var _Bytes=_dereq_("./Bytes");exports.encodeMetaData=encodeMetaData,exports.parseMetaData=parseMetaData;

},{"./Bytes":53}],56:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var isNumeric=function(e){return"number"==typeof e&&!isNaN(e)},Delta=function(){var e=0,r=function(r){if(isNumeric(r)){var t=r-e;return e=r,t}throw new TypeError("Delta object expects numerical values")};this.calcDelta=r};exports.Delta=Delta,exports.isNumeric=isNumeric;

},{}],57:[function(_dereq_,module,exports){
"use strict";function checkInterface(e,t){var r=e.prototype,o=!0,n=!1,a=void 0;try{for(var c,y=_getIterator(_getEveryPropertyNames(r));!(o=(c=y.next()).done);o=!0){var f=c.value;if(typeof t[f]!=typeof r[f]){var p=t.constructor.name;throw new Error("The method "+f+" of "+e.name+" is not defined in "+p)}}}catch(i){n=!0,a=i}finally{try{!o&&y["return"]&&y["return"]()}finally{if(n)throw a}}}function _getEveryPropertyNames(e){var t=_Object$getOwnPropertyNames(e).filter(function(e){return"constructor"!==e});if(Object.getPrototypeOf(e)===Object.prototype)return t;var r=Object.getPrototypeOf(e);return t.concat(_getEveryPropertyNames(r))}var _getIterator=_dereq_("babel-runtime/core-js/get-iterator")["default"],_Object$getOwnPropertyNames=_dereq_("babel-runtime/core-js/object/get-own-property-names")["default"];Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkInterface=checkInterface,exports._getEveryPropertyNames=_getEveryPropertyNames;

},{"babel-runtime/core-js/get-iterator":71,"babel-runtime/core-js/object/get-own-property-names":80}],58:[function(_dereq_,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var overrideDefaults=function(e,r){for(var t in e)e.hasOwnProperty(t)&&void 0!==r[t]&&(e[t]=r[t]);return e};exports.overrideDefaults=overrideDefaults;

},{}],59:[function(_dereq_,module,exports){
"use strict";function createWorker(){var e=URL.createObjectURL(new Blob(["("+_TimerWorker2["default"].toString()+")()"],{type:"application/javascript"})),r=new Worker(e);return URL.revokeObjectURL(e),r}function onMessage(e){var r=e.data,t=r.id,a=r.type,l=_callbacks[t];"setTimeout"===a&&delete _callbacks[t],l&&l()}function setTimer(e,r,t){return jobIndex++,_callbacks[jobIndex]=r,_worker.postMessage({time:t,id:jobIndex,type:e}),jobIndex}function clearTimer(e,r){delete _callbacks[r],_worker.postMessage({id:r,type:e})}function reliableSetTimeout(e,r){return setTimer("setTimeout",e,r)}function reliableSetInterval(e,r){return setTimer("setInterval",e,r)}function reliableClearTimeout(e){clearTimer("clearTimeout",e)}function reliableClearInterval(e){clearTimer("clearInterval",e)}var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0}),exports.reliableSetTimeout=reliableSetTimeout,exports.reliableSetInterval=reliableSetInterval,exports.reliableClearTimeout=reliableClearTimeout,exports.reliableClearInterval=reliableClearInterval;var _TimerWorker=_dereq_("./TimerWorker"),_TimerWorker2=_interopRequireDefault(_TimerWorker),_callbacks={},_worker=void 0;_worker=createWorker(),_worker.onmessage=onMessage;var jobIndex=0;

},{"./TimerWorker":60,"babel-runtime/helpers/interop-require-default":92}],60:[function(_dereq_,module,exports){
"use strict";function TimerWorker(){function e(e,t){return function(){return self.postMessage({id:e,type:t})}}self.onmessage=function(t){var r=t.data,a=r.type,s=r.id;switch(a){case"setTimeout":var o=r.time;setTimeout(e(s,a),o);break;case"setInterval":var o=r.time;setInterval(e(s,a),o);break;case"clearTimeout":clearTimeout(s);break;case"clearInterval":clearInterval(s)}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=TimerWorker,module.exports=exports["default"];

},{}],61:[function(_dereq_,module,exports){
"use strict";var _Map=_dereq_("babel-runtime/core-js/map")["default"],_TimerAbstraction=_dereq_("./TimerAbstraction"),Timers=function(){var e=this,r=[],t=[],i=new _Map,a=new _Map,n=function(e,t){var i=_TimerAbstraction.reliableSetTimeout(function(){l(i),e()},t);return r.push(i),i},l=function(e){for(var t in r)if(r[t]===e){_TimerAbstraction.reliableClearTimeout(e),r.splice(t,1);break}},o=function(e,r){var i=_TimerAbstraction.reliableSetInterval(e,r);return t.push(i),i},u=function(e){for(var r in t)if(t[r]===e){_TimerAbstraction.reliableClearInterval(e),t.splice(r,1);break}},c=function(e,r,t){if(!i.get(e)){var a=_TimerAbstraction.reliableSetTimeout(function(){m(e),r()},t);return i.set(e,a),a}return!1},m=function(e){var r=i.get(e);r&&(_TimerAbstraction.reliableClearTimeout(r),i["delete"](e))},f=function(e,r,t){if(!a.get(e)){var i=_TimerAbstraction.reliableSetInterval(r,t);return a.set(e,i),i}return!1},s=function(e){var r=a.get(e);r&&(_TimerAbstraction.reliableClearInterval(r),a["delete"](e))},b=function(){r.forEach(function(e){_TimerAbstraction.reliableClearTimeout(e)}),r=[],t.forEach(function(e){_TimerAbstraction.reliableClearInterval(e)}),t=[],a.forEach(function(e){_TimerAbstraction.reliableClearInterval(e)}),a.clear(),i.forEach(function(e){_TimerAbstraction.reliableClearTimeout(e)}),i.clear()};e.setTimeout=n,e.clearTimeout=l,e.setInterval=o,e.clearInterval=u,e.clearAll=b,e.setNamedTimeout=c,e.clearNamedTimeout=m,e.setNamedInterval=f,e.clearNamedInterval=s,e._getTimeoutArray=function(){return r},e._getIntervalArray=function(){return t},e._getNamedTimeoutMap=function(){return i},e._getNamedIntervalMap=function(){return a}};module.exports=Timers;

},{"./TimerAbstraction":59,"babel-runtime/core-js/map":73}],62:[function(_dereq_,module,exports){
"use strict";function createPeerConnection(){return new PeerConnection(getStunTurnServers(),{optional:[{DtlsSrtpKeyAgreement:!0}]})}var _interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _conf=_dereq_("../../conf"),_conf2=_interopRequireDefault(_conf),transformOutgoingSdp=function(e){return e=e.replace(/b=AS([^\r\n]+\r\n)/g,""),e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:50\r\n"),e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:256\r\n"),e=e.replace(/a=mid:data\r\n/g,"a=mid:data\r\nb=AS:1638400\r\n")},PeerConnection=window.RTCPeerConnection||window.webkitRTCPeerConnection,IceCandidate=window.RTCIceCandidate,SessionDescription=window.RTCSessionDescription,getStunTurnServers=function(){return _conf2["default"].ENABLE_TURN?{iceServers:_conf2["default"].TURNSERVERS.concat(_conf2["default"].STUNSERVERS)}:{iceServers:_conf2["default"].STUNSERVERS}};exports["default"]={transformOutgoingSdp:transformOutgoingSdp,createPeerConnection:createPeerConnection,IceCandidate:IceCandidate,SessionDescription:SessionDescription},module.exports=exports["default"];

},{"../../conf":1,"babel-runtime/helpers/interop-require-default":92}],63:[function(_dereq_,module,exports){
"use strict";function overloadP2PConfig(e,r){if(r.cacheSize&&(e.P2P_CACHE_MAX_SIZE=1024*r.cacheSize*1024,e.LIVE.P2P_CACHE_MAX_SIZE=e.P2P_CACHE_MAX_SIZE),void 0!==r.activateP2P&&(e.ALLOW_P2P=r.activateP2P),void 0!==r.debug&&(e.DEBUG=r.debug),r.signalingUrl&&(e.SIGNALING_URL=r.signalingUrl),r.trackerUrl&&(e.TRACKER_URL=r.trackerUrl),r.analyticsUrl&&(e.ANALYTICS_SERVER_URL=r.analyticsUrl),r.errorsUrl&&(e.ERRORS_URL=r.errorsUrl),void 0!==r.rangeRequestEnabled&&(e.RANGE_REQUEST_ALLOWED=r.rangeRequestEnabled),!r.streamrootKey)throw new Error("There must be a streamrootKey in the option object");e.ID_CLIENT=r.streamrootKey}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=overloadP2PConfig,module.exports=exports["default"];

},{}],64:[function(_dereq_,module,exports){
"use strict";var UAParser=_dereq_("ua-parser-js"),parser=new UAParser;parser.setUA(window.navigator.userAgent);var uaObject=parser.getResult();module.exports.isMobile=function(){var e="mobile"===uaObject.device.type||"tablet"===uaObject.device.type||"console"===uaObject.device.type||"Android"===uaObject.os.name||"iOS"===uaObject.os.name;return e},module.exports.uaObject=uaObject;

},{"ua-parser-js":238}],65:[function(_dereq_,module,exports){
"use strict";function init(e,r,t){var a=document.getElementsByTagName("video");if(1!==a.length)throw new Error("BufferDisplay debug tool requiresa page with a single video");var i=a[0],n=document.createElement("canvas");n.width=i.clientWidth||CANVAS_WIDTH;var l=document.getElementById("bufferDisplay");l||(l=document.createElement("div"),document.getElementsByTagName("body")[0].appendChild(l)),l.appendChild(n);var o=refreshCanvas.bind(null,n,i,e,r,t);setInterval(o,30)}function refreshCanvas(e,r,t,a,i){var n=gatherCachedState(t,a);render(e,{video:r,cacheState:n,currentTracks:i})}function gatherCachedState(e,r){var t=r.getTracksList(),a=[],i=!0,n=!1,l=void 0;try{for(var o,u=_getIterator(t);!(i=(o=u.next()).done);i=!0){var c=o.value,d=new _VirtualBufferedManager2["default"](r),f=e.listDownloadedSegmentsForTrack(c),T=!0,v=!1,h=void 0;try{for(var _,C=_getIterator(f);!(T=(_=C.next()).done);T=!0){var s=_.value;d.addSegmentCoord(s)}}catch(E){v=!0,h=E}finally{try{!T&&C["return"]&&C["return"]()}finally{if(v)throw h}}a.push({vbm:d,coord:c})}}catch(E){n=!0,l=E}finally{try{!i&&u["return"]&&u["return"]()}finally{if(n)throw l}}return a}function render(e,r){var t=r.video,a=r.cacheState,i=r.currentTracks,n=t.buffered,l=t.currentTime,o=e.getContext("2d");e.height=(CACHE_HEIGHT+TRACK_TOP_MARGIN)*a.length;var u=1/0,c=0,d=!0,f=!1,T=void 0;try{for(var v,h=_getIterator(a);!(d=(v=h.next()).done);d=!0){var _=v.value.vbm;if(_.length){var C=_.start(0),s=_.end(_.length-1);u>C&&(u=C),s>c&&(c=s)}}}catch(E){f=!0,T=E}finally{try{!d&&h["return"]&&h["return"]()}finally{if(f)throw T}}if(n.length){var g=n.start(0),m=n.end(n.length-1);u>g&&(u=g),m>c&&(c=m)}for(var H={min:u,max:c,canvasWidth:e.width},R=0;R<a.length;R++){var I=a[R],_=I.vbm,y=I.coord,A=(CACHE_HEIGHT+TRACK_TOP_MARGIN)*R,x={scale:H,height:CACHE_HEIGHT,yPosition:A,color:CACHE_COLOR};drawVBM(o,x,_);var O=A+CACHE_HEIGHT/2;if(writeTrackName(o,y.viewToString(),O),checkIfCurrentTrack(y,i)){var p={scale:H,height:BUFFER_HEIGHT,yPosition:A+(CACHE_HEIGHT-BUFFER_HEIGHT),color:BUFFERED_COLOR};drawVBM(o,p,n)}}var w={height:e.height,color:CURRENT_TIME_COLOR,scale:H};drawCurrentTimeLine(o,w,l)}function checkIfCurrentTrack(e,r){return e.isEqual(r.video)||e.isEqual(r.audio)}function writeTrackName(e,r,t){e.fillStyle="green",e.font=FONT_STYLE,e.fillText(r,0,t)}function drawVBM(e,r,t){for(var a=r.scale,i=r.height,n=r.yPosition,l=r.color,o=0;o<t.length;o++){var u=convertTimeToPixel(a,t.start(o)),c=convertTimeToPixel(a,t.end(o)),d=c-u>1?c-u:1;e.fillStyle=l,e.fillRect(u,n,d,i)}}function drawCurrentTimeLine(e,r,t){var a=r.color,i=r.scale,n=r.height,l=convertTimeToPixel(i,t);e.fillStyle=a,e.fillRect(l,0,1,n),e.fillStyle=a,e.font=FONT_STYLE,e.fillText(t.toFixed(3),0,n)}var _getIterator=_dereq_("babel-runtime/core-js/get-iterator")["default"],_interopRequireDefault=_dereq_("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var _VirtualBufferedManager=_dereq_("./VirtualBufferedManager"),_VirtualBufferedManager2=_interopRequireDefault(_VirtualBufferedManager),CACHE_HEIGHT=30,BUFFER_HEIGHT=10,TRACK_TOP_MARGIN=3,CACHE_COLOR="#97b9e2",BUFFERED_COLOR="#202429",CURRENT_TIME_COLOR="#bf0101",CANVAS_WIDTH=460,TRACK_NAME_WIDTH=60,FONT_STYLE="12px Arial",convertTimeToPixel=function(e,r){var t=e.min,a=e.max,i=e.canvasWidth,n=i-TRACK_NAME_WIDTH,l=Math.max(a-t,180);return TRACK_NAME_WIDTH+(r-t)*n/l};exports["default"]=init,module.exports=exports["default"];

},{"./VirtualBufferedManager":66,"babel-runtime/core-js/get-iterator":71,"babel-runtime/helpers/interop-require-default":92}],66:[function(_dereq_,module,exports){
"use strict";var _createClass=_dereq_("babel-runtime/helpers/create-class")["default"],_classCallCheck=_dereq_("babel-runtime/helpers/class-call-check")["default"],VBM=function(){function e(t){_classCallCheck(this,e),this._buffered=[],this._mapManager=t}return _createClass(e,null,[{key:"LAST_SEGMENT_DURATION",get:function(){return 3}}]),_createClass(e,[{key:"start",value:function(e){return e in this._buffered?this._buffered[e].start:0}},{key:"end",value:function(e){return e in this._buffered?this._buffered[e].end:0}},{key:"addSegmentCoord",value:function(t){var r=this._mapManager.getNextSegmentView(t),a=void 0,n=void 0;try{a=this._mapManager.getSegmentTime(t),n=r?this._mapManager.getSegmentTime(r):a+e.LAST_SEGMENT_DURATION}catch(s){return}if(!this._buffered.length)return void this._buffered.push({start:a,end:n});for(var i=void 0,f=void 0,u=0;u<this._buffered.length;u++){var d=this._buffered[u],l=this._buffered[u+1]||{start:1/0,end:1/0};if(d.end===a&&n===l.start){d.end=l.end,i=u+1;break}if(d.end===a&&n!==l.start){d.end=n;break}if(d.end!==a&&n===l.start){l.start=a;break}if(d.end<=a&&n<=l.start){f=u+1;break}}void 0!==i&&this._buffered.splice(i,1),void 0!==f&&this._buffered.splice(f,0,{start:a,end:n})}},{key:"length",get:function(){return this._buffered.length}}]),e}();module.exports=VBM;

},{"babel-runtime/helpers/class-call-check":87,"babel-runtime/helpers/create-class":88}],67:[function(_dereq_,module,exports){
"use strict";function init(e,t){var r=document.getElementsByTagName("video");if(1!==r.length)throw new Error("BufferDisplay debug tool requiresa page with a single video");var n=r[0],a=document.createElement("canvas"),o=document.getElementById("chunkDisplay");o||(o=document.createElement("div"),document.getElementsByTagName("body")[0].appendChild(o)),o.appendChild(a);var i=refreshCanvas.bind(null,a,e,t,n);setInterval(i,30)}function refreshCanvas(e,t,r,n){for(var a=r.getTracksList(),o=new _Map,i=0;i<a.length;i++){var l=a[i];o.set(l,[])}for(var d=t.listSegmentsDownloadStatus(),i=0;i<d.length;i++)for(var T=d[i],u=T.segmentcoord,s=T.downloadStatusList,E=T.seederCount,_=0;_<a.length;_++){var l=a[_];if(u.isInTrack(l)){var f=computeSegmentAreas(s);try{var c=r.getSegmentTime(u);o.get(l).push({segmentAreas:f,id:u.viewToString(),time:c,length:s.length,seederCount:E})}catch(S){}}}render(e,o,n.currentTime)}function render(e,t,r){e.height=1e3,e.width=ROW_WIDTH*t.size;var n=void 0,a=e.getContext("2d"),o=0,i=!0,l=!1,d=void 0;try{for(var T,u=_getIterator(t);!(i=(T=u.next()).done);i=!0){var s=_slicedToArray(T.value,2),E=s[0],_=s[1];n=FONT_SIZE,drawTrackCoord(a,E,n,o);var f=!0,c=!1,S=void 0;try{for(var g,v=_getIterator(_);!(f=(g=v.next()).done);f=!0){var I=g.value,m=I.id,N=I.time,h=I.segmentAreas,C=I.length,y=I.seederCount;N>r-TIME_KEPT_DISPLAYED&&(n+=SEGMENT_SPACING,drawSegment(a,h,C,n,o),drawSegmentInfo(a,{id:m,time:N,seederCount:y},n,o),n+=SEGMENT_HEIGHT)}}catch(G){c=!0,S=G}finally{try{!f&&v["return"]&&v["return"]()}finally{if(c)throw S}}o++}}catch(G){l=!0,d=G}finally{try{!i&&u["return"]&&u["return"]()}finally{if(l)throw d}}}function drawTrackCoord(e,t,r,n){var a=ROW_WIDTH*n;e.fillStyle=TRACK_COORD_COLOR,e.font=FONT_STYLE,e.fillText(t.viewToString(),a,r)}function drawSegmentInfo(e,t,r,n){var a=t.id,o=t.time,i=t.seederCount,l=ROW_WIDTH*n;e.fillStyle=SEGMENT_TIME_COLOR,e.font=FONT_STYLE,e.fillText(a+"  --  "+o.toFixed(1)+" -- "+i,l,r+SEGMENT_HEIGHT)}function drawSegment(e,t,r,n,a){var o=ROW_WIDTH*a,i=0,l=!0,d=!1,T=void 0;try{for(var u,s=_getIterator(t);!(l=(u=s.next()).done);l=!0){var E=u.value,_=(E.end-E.start)*SEGMENT_WIDTH/r;e.fillStyle=getColorForStatus(E.status),e.fillRect(o+SEGMENT_LEFT_SPACING+i,n,_,SEGMENT_HEIGHT),i+=_}}catch(f){d=!0,T=f}finally{try{!l&&s["return"]&&s["return"]()}finally{if(d)throw T}}t.length||(e.fillStyle="#D490D4",e.fillRect(o+SEGMENT_LEFT_SPACING,n,SEGMENT_WIDTH,SEGMENT_HEIGHT))}function getColorForStatus(e){switch(e){case"pending":return"gray";case"downloading":return"blue";case"downloaded":return"green";case"CDNdownloaded":return"orange";case"failed":return"red"}}function computeSegmentAreas(e){for(var t=void 0,r=[],n=0;n<e.length;n++){var a=e[n];if(t===a)r[r.length-1].end++;else{var o={start:n,end:n+1,status:a};t=a,r.push(o)}}return r}var _slicedToArray=_dereq_("babel-runtime/helpers/sliced-to-array")["default"],_Map=_dereq_("babel-runtime/core-js/map")["default"],_getIterator=_dereq_("babel-runtime/core-js/get-iterator")["default"];Object.defineProperty(exports,"__esModule",{value:!0});var SEGMENT_LEFT_SPACING=100,SEGMENT_WIDTH=100,SEGMENT_HEIGHT=15,TRACK_COORD_COLOR="red",SEGMENT_TIME_COLOR="black",FONT_SIZE=15,FONT_STYLE=FONT_SIZE+"px Arial",SEGMENT_SPACING=5,TIME_KEPT_DISPLAYED=10,ROW_WIDTH=SEGMENT_LEFT_SPACING+SEGMENT_WIDTH+20;exports["default"]=init,module.exports=exports["default"];

},{"babel-runtime/core-js/get-iterator":71,"babel-runtime/core-js/map":73,"babel-runtime/helpers/sliced-to-array":93}],68:[function(_dereq_,module,exports){
function after(o,n,t){function r(o,e){if(r.count<=0)throw new Error("after called too many times");--r.count,o?(u=!0,n(o),n=t):0!==r.count||u||n(null,e)}var u=!1;return t=t||noop,r.count=o,0===o?n():r}function noop(){}module.exports=after;

},{}],69:[function(_dereq_,module,exports){
module.exports=function(r,e,n){var t=r.byteLength;if(e=e||0,n=n||t,r.slice)return r.slice(e,n);if(0>e&&(e+=t),0>n&&(n+=t),n>t&&(n=t),e>=t||e>=n||0===t)return new ArrayBuffer(0);for(var f=new Uint8Array(r),i=new Uint8Array(n-e),u=e,a=0;n>u;u++,a++)i[a]=f[u];return i.buffer};

},{}],70:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/array/from"),__esModule:!0};

},{"core-js/library/fn/array/from":102}],71:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/get-iterator"),__esModule:!0};

},{"core-js/library/fn/get-iterator":103}],72:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/is-iterable"),__esModule:!0};

},{"core-js/library/fn/is-iterable":104}],73:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/map"),__esModule:!0};

},{"core-js/library/fn/map":105}],74:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/assign"),__esModule:!0};

},{"core-js/library/fn/object/assign":106}],75:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/create"),__esModule:!0};

},{"core-js/library/fn/object/create":107}],76:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/define-properties"),__esModule:!0};

},{"core-js/library/fn/object/define-properties":108}],77:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/define-property"),__esModule:!0};

},{"core-js/library/fn/object/define-property":109}],78:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/freeze"),__esModule:!0};

},{"core-js/library/fn/object/freeze":110}],79:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/get-own-property-descriptor"),__esModule:!0};

},{"core-js/library/fn/object/get-own-property-descriptor":111}],80:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/get-own-property-names"),__esModule:!0};

},{"core-js/library/fn/object/get-own-property-names":112}],81:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/keys"),__esModule:!0};

},{"core-js/library/fn/object/keys":113}],82:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/seal"),__esModule:!0};

},{"core-js/library/fn/object/seal":114}],83:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/object/set-prototype-of"),__esModule:!0};

},{"core-js/library/fn/object/set-prototype-of":115}],84:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/promise"),__esModule:!0};

},{"core-js/library/fn/promise":116}],85:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/symbol"),__esModule:!0};

},{"core-js/library/fn/symbol":117}],86:[function(_dereq_,module,exports){
module.exports={"default":_dereq_("core-js/library/fn/symbol/iterator"),__esModule:!0};

},{"core-js/library/fn/symbol/iterator":118}],87:[function(_dereq_,module,exports){
"use strict";exports["default"]=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},exports.__esModule=!0;

},{}],88:[function(_dereq_,module,exports){
"use strict";var _Object$defineProperty=_dereq_("babel-runtime/core-js/object/define-property")["default"];exports["default"]=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),_Object$defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),exports.__esModule=!0;

},{"babel-runtime/core-js/object/define-property":77}],89:[function(_dereq_,module,exports){
"use strict";var _Object$defineProperty=_dereq_("babel-runtime/core-js/object/define-property")["default"];exports["default"]=function(e,r,t){return r in e?_Object$defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},exports.__esModule=!0;

},{"babel-runtime/core-js/object/define-property":77}],90:[function(_dereq_,module,exports){
"use strict";var _Object$getOwnPropertyDescriptor=_dereq_("babel-runtime/core-js/object/get-own-property-descriptor")["default"];exports["default"]=function(e,r,t){for(var o=!0;o;){var i=e,u=r,n=t;o=!1,null===i&&(i=Function.prototype);var v=_Object$getOwnPropertyDescriptor(i,u);if(void 0!==v){if("value"in v)return v.value;var a=v.get;return void 0===a?void 0:a.call(n)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;e=c,r=u,t=n,o=!0,v=c=void 0}},exports.__esModule=!0;

},{"babel-runtime/core-js/object/get-own-property-descriptor":79}],91:[function(_dereq_,module,exports){
"use strict";var _Object$create=_dereq_("babel-runtime/core-js/object/create")["default"],_Object$setPrototypeOf=_dereq_("babel-runtime/core-js/object/set-prototype-of")["default"];exports["default"]=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=_Object$create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(_Object$setPrototypeOf?_Object$setPrototypeOf(e,t):e.__proto__=t)},exports.__esModule=!0;

},{"babel-runtime/core-js/object/create":75,"babel-runtime/core-js/object/set-prototype-of":83}],92:[function(_dereq_,module,exports){
"use strict";exports["default"]=function(e){return e&&e.__esModule?e:{"default":e}},exports.__esModule=!0;

},{}],93:[function(_dereq_,module,exports){
"use strict";var _getIterator=_dereq_("babel-runtime/core-js/get-iterator")["default"],_isIterable=_dereq_("babel-runtime/core-js/is-iterable")["default"];exports["default"]=function(){function r(r,e){var t=[],n=!0,a=!1,i=void 0;try{for(var u,o=_getIterator(r);!(n=(u=o.next()).done)&&(t.push(u.value),!e||t.length!==e);n=!0);}catch(l){a=!0,i=l}finally{try{!n&&o["return"]&&o["return"]()}finally{if(a)throw i}}return t}return function(e,t){if(Array.isArray(e))return e;if(_isIterable(Object(e)))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),exports.__esModule=!0;

},{"babel-runtime/core-js/get-iterator":71,"babel-runtime/core-js/is-iterable":72}],94:[function(_dereq_,module,exports){
"use strict";var _Array$from=_dereq_("babel-runtime/core-js/array/from")["default"];exports["default"]=function(r){if(Array.isArray(r)){for(var e=0,a=Array(r.length);e<r.length;e++)a[e]=r[e];return a}return _Array$from(r)},exports.__esModule=!0;

},{"babel-runtime/core-js/array/from":70}],95:[function(_dereq_,module,exports){
(function (global){
var g="object"==typeof global?global:"object"==typeof window?window:"object"==typeof self?self:this,hadRuntime=g.regeneratorRuntime&&Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime")>=0,oldRuntime=hadRuntime&&g.regeneratorRuntime;if(g.regeneratorRuntime=void 0,module.exports=_dereq_("./runtime"),hadRuntime)g.regeneratorRuntime=oldRuntime;else try{delete g.regeneratorRuntime}catch(e){g.regeneratorRuntime=void 0}module.exports={"default":module.exports,__esModule:!0};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./runtime":96}],96:[function(_dereq_,module,exports){
(function (process,global){
"use strict";var _Symbol=_dereq_("babel-runtime/core-js/symbol")["default"],_Object$create=_dereq_("babel-runtime/core-js/object/create")["default"],_Object$setPrototypeOf=_dereq_("babel-runtime/core-js/object/set-prototype-of")["default"],_Promise=_dereq_("babel-runtime/core-js/promise")["default"];!function(t){function e(t,e,r,o){var i=_Object$create((e||n).prototype),a=new h(o||[]);return i._invoke=f(t,r,a),i}function r(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(n){return{type:"throw",arg:n}}}function n(){}function o(){}function i(){}function a(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function c(t){this.arg=t}function u(t){function e(n,o,i,a){var u=r(t[n],t,o);if("throw"!==u.type){var f=u.arg,l=f.value;return l instanceof c?_Promise.resolve(l.arg).then(function(t){e("next",t,i,a)},function(t){e("throw",t,i,a)}):_Promise.resolve(l).then(function(t){f.value=t,i(f)},a)}a(u.arg)}function n(t,r){function n(){return new _Promise(function(n,o){e(t,r,n,o)})}return o=o?o.then(n,n):n()}"object"==typeof process&&process.domain&&(e=process.domain.bind(e));var o;this._invoke=n}function f(t,e,n){var o=x;return function(i,a){if(o===_)throw new Error("Generator is already running");if(o===j){if("throw"===i)throw a;return y()}for(;;){var c=n.delegate;if(c){if("return"===i||"throw"===i&&c.iterator[i]===v){n.delegate=null;var u=c.iterator["return"];if(u){var f=r(u,c.iterator,a);if("throw"===f.type){i="throw",a=f.arg;continue}}if("return"===i)continue}var f=r(c.iterator[i],c.iterator,a);if("throw"===f.type){n.delegate=null,i="throw",a=f.arg;continue}i="next",a=v;var l=f.arg;if(!l.done)return o=E,l;n[c.resultName]=l.value,n.next=c.nextLoc,n.delegate=null}if("next"===i)o===E?n.sent=a:n.sent=v;else if("throw"===i){if(o===x)throw o=j,a;n.dispatchException(a)&&(i="next",a=v)}else"return"===i&&n.abrupt("return",a);o=_;var f=r(t,e,n);if("normal"===f.type){o=n.done?j:E;var l={value:f.arg,done:n.done};if(f.arg!==O)return l;n.delegate&&"next"===i&&(a=v)}else"throw"===f.type&&(o=j,i="throw",a=f.arg)}}}function l(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function s(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function h(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(l,this),this.reset(!0)}function p(t){if(t){var e=t[m];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function o(){for(;++r<t.length;)if(d.call(t,r))return o.value=t[r],o.done=!1,o;return o.value=v,o.done=!0,o};return n.next=n}}return{next:y}}function y(){return{value:v,done:!0}}var v,d=Object.prototype.hasOwnProperty,g="function"==typeof _Symbol?_Symbol:{},m=g.iterator||"@@iterator",w=g.toStringTag||"@@toStringTag",b="object"==typeof module,L=t.regeneratorRuntime;if(L)return void(b&&(module.exports=L));L=t.regeneratorRuntime=b?module.exports:{},L.wrap=e;var x="suspendedStart",E="suspendedYield",_="executing",j="completed",O={},k=i.prototype=n.prototype;o.prototype=k.constructor=i,i.constructor=o,i[w]=o.displayName="GeneratorFunction",L.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return e?e===o||"GeneratorFunction"===(e.displayName||e.name):!1},L.mark=function(t){return _Object$setPrototypeOf?_Object$setPrototypeOf(t,i):(t.__proto__=i,w in t||(t[w]="GeneratorFunction")),t.prototype=_Object$create(k),t},L.awrap=function(t){return new c(t)},a(u.prototype),L.async=function(t,r,n,o){var i=new u(e(t,r,n,o));return L.isGeneratorFunction(r)?i:i.next().then(function(t){return t.done?t.value:i.next()})},a(k),k[m]=function(){return this},k[w]="Generator",k.toString=function(){return"[object Generator]"},L.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},L.values=p,h.prototype={constructor:h,reset:function(t){if(this.prev=0,this.next=0,this.sent=v,this.done=!1,this.delegate=null,this.tryEntries.forEach(s),!t)for(var e in this)"t"===e.charAt(0)&&d.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,n){return i.type="throw",i.arg=t,r.next=e,!!n}if(this.done)throw t;for(var r=this,n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=d.call(o,"catchLoc"),c=d.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&d.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?this.next=o.finallyLoc:this.complete(i),O},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),s(r),O}},"catch":function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;s(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:p(t),resultName:e,nextLoc:r},O}}}("object"==typeof global?global:"object"==typeof window?window:"object"==typeof self?self:void 0);

}).call(this,_dereq_('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":203,"babel-runtime/core-js/object/create":75,"babel-runtime/core-js/object/set-prototype-of":83,"babel-runtime/core-js/promise":84,"babel-runtime/core-js/symbol":85}],97:[function(_dereq_,module,exports){
function Backoff(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}module.exports=Backoff,Backoff.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var o=Math.random(),i=Math.floor(o*this.jitter*t);t=0==(1&Math.floor(10*o))?t-i:t+i}return 0|Math.min(t,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(t){this.ms=t},Backoff.prototype.setMax=function(t){this.max=t},Backoff.prototype.setJitter=function(t){this.jitter=t};

},{}],98:[function(_dereq_,module,exports){
!function(n){"use strict";exports.encode=function(e){var r,t=new Uint8Array(e),i=t.length,f="";for(r=0;i>r;r+=3)f+=n[t[r]>>2],f+=n[(3&t[r])<<4|t[r+1]>>4],f+=n[(15&t[r+1])<<2|t[r+2]>>6],f+=n[63&t[r+2]];return i%3===2?f=f.substring(0,f.length-1)+"=":i%3===1&&(f=f.substring(0,f.length-2)+"=="),f},exports.decode=function(e){var r,t,i,f,g,o=.75*e.length,u=e.length,s=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var d=new ArrayBuffer(o),h=new Uint8Array(d);for(r=0;u>r;r+=4)t=n.indexOf(e[r]),i=n.indexOf(e[r+1]),f=n.indexOf(e[r+2]),g=n.indexOf(e[r+3]),h[s++]=t<<2|i>>4,h[s++]=(15&i)<<4|f>>2,h[s++]=(3&f)<<6|63&g;return d}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");

},{}],99:[function(_dereq_,module,exports){
var slice=[].slice;module.exports=function(n,r){if("string"==typeof r&&(r=n[r]),"function"!=typeof r)throw new Error("bind() requires a function");var e=slice.call(arguments,2);return function(){return r.apply(n,e.concat(slice.call(arguments)))}};

},{}],100:[function(_dereq_,module,exports){
function Emitter(t){return t?mixin(t):void 0}function mixin(t){for(var e in Emitter.prototype)t[e]=Emitter.prototype[e];return t}module.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},Emitter.prototype.once=function(t,e){function i(){r.off(t,i),e.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},i.fn=e,this.on(t,i),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks[t];if(!i)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var r,s=0;s<i.length;s++)if(r=i[s],r===e||r.fn===e){i.splice(s,1);break}return this},Emitter.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks[t];if(i){i=i.slice(0);for(var r=0,s=i.length;s>r;++r)i[r].apply(this,e)}return this},Emitter.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},Emitter.prototype.hasListeners=function(t){return!!this.listeners(t).length};

},{}],101:[function(_dereq_,module,exports){
module.exports=function(o,t){var p=function(){};p.prototype=t.prototype,o.prototype=new p,o.prototype.constructor=o};

},{}],102:[function(_dereq_,module,exports){
_dereq_("../../modules/es6.string.iterator"),_dereq_("../../modules/es6.array.from"),module.exports=_dereq_("../../modules/$.core").Array.from;

},{"../../modules/$.core":127,"../../modules/es6.array.from":179,"../../modules/es6.string.iterator":191}],103:[function(_dereq_,module,exports){
_dereq_("../modules/web.dom.iterable"),_dereq_("../modules/es6.string.iterator"),module.exports=_dereq_("../modules/core.get-iterator");

},{"../modules/core.get-iterator":177,"../modules/es6.string.iterator":191,"../modules/web.dom.iterable":194}],104:[function(_dereq_,module,exports){
_dereq_("../modules/web.dom.iterable"),_dereq_("../modules/es6.string.iterator"),module.exports=_dereq_("../modules/core.is-iterable");

},{"../modules/core.is-iterable":178,"../modules/es6.string.iterator":191,"../modules/web.dom.iterable":194}],105:[function(_dereq_,module,exports){
_dereq_("../modules/es6.object.to-string"),_dereq_("../modules/es6.string.iterator"),_dereq_("../modules/web.dom.iterable"),_dereq_("../modules/es6.map"),_dereq_("../modules/es7.map.to-json"),module.exports=_dereq_("../modules/$.core").Map;

},{"../modules/$.core":127,"../modules/es6.map":181,"../modules/es6.object.to-string":189,"../modules/es6.string.iterator":191,"../modules/es7.map.to-json":193,"../modules/web.dom.iterable":194}],106:[function(_dereq_,module,exports){
_dereq_("../../modules/es6.object.assign"),module.exports=_dereq_("../../modules/$.core").Object.assign;

},{"../../modules/$.core":127,"../../modules/es6.object.assign":182}],107:[function(_dereq_,module,exports){
var $=_dereq_("../../modules/$");module.exports=function(e,r){return $.create(e,r)};

},{"../../modules/$":152}],108:[function(_dereq_,module,exports){
var $=_dereq_("../../modules/$");module.exports=function(e,r){return $.setDescs(e,r)};

},{"../../modules/$":152}],109:[function(_dereq_,module,exports){
var $=_dereq_("../../modules/$");module.exports=function(e,r,u){return $.setDesc(e,r,u)};

},{"../../modules/$":152}],110:[function(_dereq_,module,exports){
_dereq_("../../modules/es6.object.freeze"),module.exports=_dereq_("../../modules/$.core").Object.freeze;

},{"../../modules/$.core":127,"../../modules/es6.object.freeze":183}],111:[function(_dereq_,module,exports){
var $=_dereq_("../../modules/$");_dereq_("../../modules/es6.object.get-own-property-descriptor"),module.exports=function(e,r){return $.getDesc(e,r)};

},{"../../modules/$":152,"../../modules/es6.object.get-own-property-descriptor":184}],112:[function(_dereq_,module,exports){
var $=_dereq_("../../modules/$");_dereq_("../../modules/es6.object.get-own-property-names"),module.exports=function(e){return $.getNames(e)};

},{"../../modules/$":152,"../../modules/es6.object.get-own-property-names":185}],113:[function(_dereq_,module,exports){
_dereq_("../../modules/es6.object.keys"),module.exports=_dereq_("../../modules/$.core").Object.keys;

},{"../../modules/$.core":127,"../../modules/es6.object.keys":186}],114:[function(_dereq_,module,exports){
_dereq_("../../modules/es6.object.seal"),module.exports=_dereq_("../../modules/$.core").Object.seal;

},{"../../modules/$.core":127,"../../modules/es6.object.seal":187}],115:[function(_dereq_,module,exports){
_dereq_("../../modules/es6.object.set-prototype-of"),module.exports=_dereq_("../../modules/$.core").Object.setPrototypeOf;

},{"../../modules/$.core":127,"../../modules/es6.object.set-prototype-of":188}],116:[function(_dereq_,module,exports){
_dereq_("../modules/es6.object.to-string"),_dereq_("../modules/es6.string.iterator"),_dereq_("../modules/web.dom.iterable"),_dereq_("../modules/es6.promise"),module.exports=_dereq_("../modules/$.core").Promise;

},{"../modules/$.core":127,"../modules/es6.object.to-string":189,"../modules/es6.promise":190,"../modules/es6.string.iterator":191,"../modules/web.dom.iterable":194}],117:[function(_dereq_,module,exports){
_dereq_("../../modules/es6.symbol"),_dereq_("../../modules/es6.object.to-string"),module.exports=_dereq_("../../modules/$.core").Symbol;

},{"../../modules/$.core":127,"../../modules/es6.object.to-string":189,"../../modules/es6.symbol":192}],118:[function(_dereq_,module,exports){
_dereq_("../../modules/es6.string.iterator"),_dereq_("../../modules/web.dom.iterable"),module.exports=_dereq_("../../modules/$.wks")("iterator");

},{"../../modules/$.wks":175,"../../modules/es6.string.iterator":191,"../../modules/web.dom.iterable":194}],119:[function(_dereq_,module,exports){
module.exports=function(o){if("function"!=typeof o)throw TypeError(o+" is not a function!");return o};

},{}],120:[function(_dereq_,module,exports){
module.exports=function(){};

},{}],121:[function(_dereq_,module,exports){
var isObject=_dereq_("./$.is-object");module.exports=function(e){if(!isObject(e))throw TypeError(e+" is not an object!");return e};

},{"./$.is-object":145}],122:[function(_dereq_,module,exports){
var cof=_dereq_("./$.cof"),TAG=_dereq_("./$.wks")("toStringTag"),ARG="Arguments"==cof(function(){return arguments}());module.exports=function(e){var n,r,t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=(n=Object(e))[TAG])?r:ARG?cof(n):"Object"==(t=cof(n))&&"function"==typeof n.callee?"Arguments":t};

},{"./$.cof":123,"./$.wks":175}],123:[function(_dereq_,module,exports){
var toString={}.toString;module.exports=function(t){return toString.call(t).slice(8,-1)};

},{}],124:[function(_dereq_,module,exports){
"use strict";var $=_dereq_("./$"),hide=_dereq_("./$.hide"),redefineAll=_dereq_("./$.redefine-all"),ctx=_dereq_("./$.ctx"),strictNew=_dereq_("./$.strict-new"),defined=_dereq_("./$.defined"),forOf=_dereq_("./$.for-of"),$iterDefine=_dereq_("./$.iter-define"),step=_dereq_("./$.iter-step"),ID=_dereq_("./$.uid")("id"),$has=_dereq_("./$.has"),isObject=_dereq_("./$.is-object"),setSpecies=_dereq_("./$.set-species"),DESCRIPTORS=_dereq_("./$.descriptors"),isExtensible=Object.isExtensible||isObject,SIZE=DESCRIPTORS?"_s":"size",id=0,fastKey=function(e,t){if(!isObject(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!$has(e,ID)){if(!isExtensible(e))return"F";if(!t)return"E";hide(e,ID,++id)}return"O"+e[ID]},getEntry=function(e,t){var r,i=fastKey(t);if("F"!==i)return e._i[i];for(r=e._f;r;r=r.n)if(r.k==t)return r};module.exports={getConstructor:function(e,t,r,i){var n=e(function(e,s){strictNew(e,n,t),e._i=$.create(null),e._f=void 0,e._l=void 0,e[SIZE]=0,void 0!=s&&forOf(s,r,e[i],e)});return redefineAll(n.prototype,{clear:function(){for(var e=this,t=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete t[r.i];e._f=e._l=void 0,e[SIZE]=0},"delete":function(e){var t=this,r=getEntry(t,e);if(r){var i=r.n,n=r.p;delete t._i[r.i],r.r=!0,n&&(n.n=i),i&&(i.p=n),t._f==r&&(t._f=i),t._l==r&&(t._l=n),t[SIZE]--}return!!r},forEach:function(e){for(var t,r=ctx(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(r(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!getEntry(this,e)}}),DESCRIPTORS&&$.setDesc(n.prototype,"size",{get:function(){return defined(this[SIZE])}}),n},def:function(e,t,r){var i,n,s=getEntry(e,t);return s?s.v=r:(e._l=s={i:n=fastKey(t,!0),k:t,v:r,p:i=e._l,n:void 0,r:!1},e._f||(e._f=s),i&&(i.n=s),e[SIZE]++,"F"!==n&&(e._i[n]=s)),e},getEntry:getEntry,setStrong:function(e,t,r){$iterDefine(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?step(0,r.k):"values"==t?step(0,r.v):step(0,[r.k,r.v]):(e._t=void 0,step(1))},r?"entries":"values",!r,!0),setSpecies(t)}};

},{"./$":152,"./$.ctx":128,"./$.defined":129,"./$.descriptors":130,"./$.for-of":135,"./$.has":138,"./$.hide":139,"./$.is-object":145,"./$.iter-define":148,"./$.iter-step":150,"./$.redefine-all":159,"./$.set-species":163,"./$.strict-new":167,"./$.uid":174}],125:[function(_dereq_,module,exports){
var forOf=_dereq_("./$.for-of"),classof=_dereq_("./$.classof");module.exports=function(r){return function(){if(classof(this)!=r)throw TypeError(r+"#toJSON isn't generic");var o=[];return forOf(this,!1,o.push,o),o}};

},{"./$.classof":122,"./$.for-of":135}],126:[function(_dereq_,module,exports){
"use strict";var $=_dereq_("./$"),global=_dereq_("./$.global"),$export=_dereq_("./$.export"),fails=_dereq_("./$.fails"),hide=_dereq_("./$.hide"),redefineAll=_dereq_("./$.redefine-all"),forOf=_dereq_("./$.for-of"),strictNew=_dereq_("./$.strict-new"),isObject=_dereq_("./$.is-object"),setToStringTag=_dereq_("./$.set-to-string-tag"),DESCRIPTORS=_dereq_("./$.descriptors");module.exports=function(e,r,t,i,o,s){var n=global[e],c=n,u=o?"set":"add",a=c&&c.prototype,f={};return DESCRIPTORS&&"function"==typeof c&&(s||a.forEach&&!fails(function(){(new c).entries().next()}))?(c=r(function(r,t){strictNew(r,c,e),r._c=new n,void 0!=t&&forOf(t,o,r[u],r)}),$.each.call("add,clear,delete,forEach,get,has,set,keys,values,entries".split(","),function(e){var r="add"==e||"set"==e;e in a&&(!s||"clear"!=e)&&hide(c.prototype,e,function(t,i){if(!r&&s&&!isObject(t))return"get"==e?void 0:!1;var o=this._c[e](0===t?0:t,i);return r?this:o})}),"size"in a&&$.setDesc(c.prototype,"size",{get:function(){return this._c.size}})):(c=i.getConstructor(r,e,o,u),redefineAll(c.prototype,t)),setToStringTag(c,e),f[e]=c,$export($export.G+$export.W+$export.F,f),s||i.setStrong(c,e,o),c};

},{"./$":152,"./$.descriptors":130,"./$.export":133,"./$.fails":134,"./$.for-of":135,"./$.global":137,"./$.hide":139,"./$.is-object":145,"./$.redefine-all":159,"./$.set-to-string-tag":164,"./$.strict-new":167}],127:[function(_dereq_,module,exports){
var core=module.exports={version:"1.2.6"};"number"==typeof __e&&(__e=core);

},{}],128:[function(_dereq_,module,exports){
var aFunction=_dereq_("./$.a-function");module.exports=function(n,r,t){if(aFunction(n),void 0===r)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)}}return function(){return n.apply(r,arguments)}};

},{"./$.a-function":119}],129:[function(_dereq_,module,exports){
module.exports=function(o){if(void 0==o)throw TypeError("Can't call method on  "+o);return o};

},{}],130:[function(_dereq_,module,exports){
module.exports=!_dereq_("./$.fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a});

},{"./$.fails":134}],131:[function(_dereq_,module,exports){
var isObject=_dereq_("./$.is-object"),document=_dereq_("./$.global").document,is=isObject(document)&&isObject(document.createElement);module.exports=function(e){return is?document.createElement(e):{}};

},{"./$.global":137,"./$.is-object":145}],132:[function(_dereq_,module,exports){
var $=_dereq_("./$");module.exports=function(e){var r=$.getKeys(e),t=$.getSymbols;if(t)for(var u,l=t(e),n=$.isEnum,o=0;l.length>o;)n.call(e,u=l[o++])&&r.push(u);return r};

},{"./$":152}],133:[function(_dereq_,module,exports){
var global=_dereq_("./$.global"),core=_dereq_("./$.core"),ctx=_dereq_("./$.ctx"),PROTOTYPE="prototype",$export=function(o,r,e){var t,n,p,x=o&$export.F,c=o&$export.G,$=o&$export.S,l=o&$export.P,i=o&$export.B,P=o&$export.W,u=c?core:core[r]||(core[r]={}),O=c?global:$?global[r]:(global[r]||{})[PROTOTYPE];c&&(e=r);for(t in e)n=!x&&O&&t in O,n&&t in u||(p=n?O[t]:e[t],u[t]=c&&"function"!=typeof O[t]?e[t]:i&&n?ctx(p,global):P&&O[t]==p?function(o){var r=function(r){return this instanceof o?new o(r):o(r)};return r[PROTOTYPE]=o[PROTOTYPE],r}(p):l&&"function"==typeof p?ctx(Function.call,p):p,l&&((u[PROTOTYPE]||(u[PROTOTYPE]={}))[t]=p))};$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,module.exports=$export;

},{"./$.core":127,"./$.ctx":128,"./$.global":137}],134:[function(_dereq_,module,exports){
module.exports=function(r){try{return!!r()}catch(t){return!0}};

},{}],135:[function(_dereq_,module,exports){
var ctx=_dereq_("./$.ctx"),call=_dereq_("./$.iter-call"),isArrayIter=_dereq_("./$.is-array-iter"),anObject=_dereq_("./$.an-object"),toLength=_dereq_("./$.to-length"),getIterFn=_dereq_("./core.get-iterator-method");module.exports=function(e,r,t,i){var o,a,n,l=getIterFn(e),c=ctx(t,i,r?2:1),u=0;if("function"!=typeof l)throw TypeError(e+" is not iterable!");if(isArrayIter(l))for(o=toLength(e.length);o>u;u++)r?c(anObject(a=e[u])[0],a[1]):c(e[u]);else for(n=l.call(e);!(a=n.next()).done;)call(n,c,a.value,r)};

},{"./$.an-object":121,"./$.ctx":128,"./$.is-array-iter":143,"./$.iter-call":146,"./$.to-length":172,"./core.get-iterator-method":176}],136:[function(_dereq_,module,exports){
var toIObject=_dereq_("./$.to-iobject"),getNames=_dereq_("./$").getNames,toString={}.toString,windowNames="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(e){try{return getNames(e)}catch(t){return windowNames.slice()}};module.exports.get=function(e){return windowNames&&"[object Window]"==toString.call(e)?getWindowNames(e):getNames(toIObject(e))};

},{"./$":152,"./$.to-iobject":171}],137:[function(_dereq_,module,exports){
var global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global);

},{}],138:[function(_dereq_,module,exports){
var hasOwnProperty={}.hasOwnProperty;module.exports=function(r,e){return hasOwnProperty.call(r,e)};

},{}],139:[function(_dereq_,module,exports){
var $=_dereq_("./$"),createDesc=_dereq_("./$.property-desc");module.exports=_dereq_("./$.descriptors")?function(e,r,t){return $.setDesc(e,r,createDesc(1,t))}:function(e,r,t){return e[r]=t,e};

},{"./$":152,"./$.descriptors":130,"./$.property-desc":158}],140:[function(_dereq_,module,exports){
module.exports=_dereq_("./$.global").document&&document.documentElement;

},{"./$.global":137}],141:[function(_dereq_,module,exports){
module.exports=function(e,r,l){var a=void 0===l;switch(r.length){case 0:return a?e():e.call(l);case 1:return a?e(r[0]):e.call(l,r[0]);case 2:return a?e(r[0],r[1]):e.call(l,r[0],r[1]);case 3:return a?e(r[0],r[1],r[2]):e.call(l,r[0],r[1],r[2]);case 4:return a?e(r[0],r[1],r[2],r[3]):e.call(l,r[0],r[1],r[2],r[3])}return e.apply(l,r)};

},{}],142:[function(_dereq_,module,exports){
var cof=_dereq_("./$.cof");module.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==cof(e)?e.split(""):Object(e)};

},{"./$.cof":123}],143:[function(_dereq_,module,exports){
var Iterators=_dereq_("./$.iterators"),ITERATOR=_dereq_("./$.wks")("iterator"),ArrayProto=Array.prototype;module.exports=function(r){return void 0!==r&&(Iterators.Array===r||ArrayProto[ITERATOR]===r)};

},{"./$.iterators":151,"./$.wks":175}],144:[function(_dereq_,module,exports){
var cof=_dereq_("./$.cof");module.exports=Array.isArray||function(r){return"Array"==cof(r)};

},{"./$.cof":123}],145:[function(_dereq_,module,exports){
module.exports=function(o){return"object"==typeof o?null!==o:"function"==typeof o};

},{}],146:[function(_dereq_,module,exports){
var anObject=_dereq_("./$.an-object");module.exports=function(r,t,e,a){try{return a?t(anObject(e)[0],e[1]):t(e)}catch(c){var n=r["return"];throw void 0!==n&&anObject(n.call(r)),c}};

},{"./$.an-object":121}],147:[function(_dereq_,module,exports){
"use strict";var $=_dereq_("./$"),descriptor=_dereq_("./$.property-desc"),setToStringTag=_dereq_("./$.set-to-string-tag"),IteratorPrototype={};_dereq_("./$.hide")(IteratorPrototype,_dereq_("./$.wks")("iterator"),function(){return this}),module.exports=function(r,t,e){r.prototype=$.create(IteratorPrototype,{next:descriptor(1,e)}),setToStringTag(r,t+" Iterator")};

},{"./$":152,"./$.hide":139,"./$.property-desc":158,"./$.set-to-string-tag":164,"./$.wks":175}],148:[function(_dereq_,module,exports){
"use strict";var LIBRARY=_dereq_("./$.library"),$export=_dereq_("./$.export"),redefine=_dereq_("./$.redefine"),hide=_dereq_("./$.hide"),has=_dereq_("./$.has"),Iterators=_dereq_("./$.iterators"),$iterCreate=_dereq_("./$.iter-create"),setToStringTag=_dereq_("./$.set-to-string-tag"),getProto=_dereq_("./$").getProto,ITERATOR=_dereq_("./$.wks")("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this};module.exports=function(e,r,t,i,n,s,u){$iterCreate(t,r,i);var o,a,T=function(e){if(!BUGGY&&e in E)return E[e];switch(e){case KEYS:return function(){return new t(this,e)};case VALUES:return function(){return new t(this,e)}}return function(){return new t(this,e)}},R=r+" Iterator",h=n==VALUES,A=!1,E=e.prototype,$=E[ITERATOR]||E[FF_ITERATOR]||n&&E[n],f=$||T(n);if($){var I=getProto(f.call(new e));setToStringTag(I,R,!0),!LIBRARY&&has(E,FF_ITERATOR)&&hide(I,ITERATOR,returnThis),h&&$.name!==VALUES&&(A=!0,f=function(){return $.call(this)})}if(LIBRARY&&!u||!BUGGY&&!A&&E[ITERATOR]||hide(E,ITERATOR,f),Iterators[r]=f,Iterators[R]=returnThis,n)if(o={values:h?f:T(VALUES),keys:s?f:T(KEYS),entries:h?T("entries"):f},u)for(a in o)a in E||redefine(E,a,o[a]);else $export($export.P+$export.F*(BUGGY||A),r,o);return o};

},{"./$":152,"./$.export":133,"./$.has":138,"./$.hide":139,"./$.iter-create":147,"./$.iterators":151,"./$.library":154,"./$.redefine":160,"./$.set-to-string-tag":164,"./$.wks":175}],149:[function(_dereq_,module,exports){
var ITERATOR=_dereq_("./$.wks")("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR]();riter["return"]=function(){SAFE_CLOSING=!0},Array.from(riter,function(){throw 2})}catch(e){}module.exports=function(r,t){if(!t&&!SAFE_CLOSING)return!1;var n=!1;try{var e=[7],i=e[ITERATOR]();i.next=function(){n=!0},e[ITERATOR]=function(){return i},r(e)}catch(u){}return n};

},{"./$.wks":175}],150:[function(_dereq_,module,exports){
module.exports=function(e,n){return{value:n,done:!!e}};

},{}],151:[function(_dereq_,module,exports){
module.exports={};

},{}],152:[function(_dereq_,module,exports){
var $Object=Object;module.exports={create:$Object.create,getProto:$Object.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:$Object.getOwnPropertyDescriptor,setDesc:$Object.defineProperty,setDescs:$Object.defineProperties,getKeys:$Object.keys,getNames:$Object.getOwnPropertyNames,getSymbols:$Object.getOwnPropertySymbols,each:[].forEach};

},{}],153:[function(_dereq_,module,exports){
var $=_dereq_("./$"),toIObject=_dereq_("./$.to-iobject");module.exports=function(e,t){for(var r,o=toIObject(e),i=$.getKeys(o),u=i.length,c=0;u>c;)if(o[r=i[c++]]===t)return r};

},{"./$":152,"./$.to-iobject":171}],154:[function(_dereq_,module,exports){
module.exports=!0;

},{}],155:[function(_dereq_,module,exports){
var global=_dereq_("./$.global"),macrotask=_dereq_("./$.task").set,Observer=global.MutationObserver||global.WebKitMutationObserver,process=global.process,Promise=global.Promise,isNode="process"==_dereq_("./$.cof")(process),head,last,notify,flush=function(){var e,o,s;for(isNode&&(e=process.domain)&&(process.domain=null,e.exit());head;)o=head.domain,s=head.fn,o&&o.enter(),s(),o&&o.exit(),head=head.next;last=void 0,e&&e.enter()};if(isNode)notify=function(){process.nextTick(flush)};else if(Observer){var toggle=1,node=document.createTextNode("");new Observer(flush).observe(node,{characterData:!0}),notify=function(){node.data=toggle=-toggle}}else notify=Promise&&Promise.resolve?function(){Promise.resolve().then(flush)}:function(){macrotask.call(global,flush)};module.exports=function(e){var o={fn:e,next:void 0,domain:isNode&&process.domain};last&&(last.next=o),head||(head=o,notify()),last=o};

},{"./$.cof":123,"./$.global":137,"./$.task":169}],156:[function(_dereq_,module,exports){
var $=_dereq_("./$"),toObject=_dereq_("./$.to-object"),IObject=_dereq_("./$.iobject");module.exports=_dereq_("./$.fails")(function(){var e=Object.assign,t={},r={},o=Symbol(),c="abcdefghijklmnopqrst";return t[o]=7,c.split("").forEach(function(e){r[e]=e}),7!=e({},t)[o]||Object.keys(e({},r)).join("")!=c})?function(e,t){for(var r=toObject(e),o=arguments,c=o.length,n=1,i=$.getKeys,s=$.getSymbols,a=$.isEnum;c>n;)for(var b,u=IObject(o[n++]),j=s?i(u).concat(s(u)):i(u),l=j.length,f=0;l>f;)a.call(u,b=j[f++])&&(r[b]=u[b]);return r}:Object.assign;

},{"./$":152,"./$.fails":134,"./$.iobject":142,"./$.to-object":173}],157:[function(_dereq_,module,exports){
var $export=_dereq_("./$.export"),core=_dereq_("./$.core"),fails=_dereq_("./$.fails");module.exports=function(e,r){var o=(core.Object||{})[e]||Object[e],t={};t[e]=r(o),$export($export.S+$export.F*fails(function(){o(1)}),"Object",t)};

},{"./$.core":127,"./$.export":133,"./$.fails":134}],158:[function(_dereq_,module,exports){
module.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}};

},{}],159:[function(_dereq_,module,exports){
var redefine=_dereq_("./$.redefine");module.exports=function(e,r){for(var n in r)redefine(e,n,r[n]);return e};

},{"./$.redefine":160}],160:[function(_dereq_,module,exports){
module.exports=_dereq_("./$.hide");

},{"./$.hide":139}],161:[function(_dereq_,module,exports){
module.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t};

},{}],162:[function(_dereq_,module,exports){
var getDesc=_dereq_("./$").getDesc,isObject=_dereq_("./$.is-object"),anObject=_dereq_("./$.an-object"),check=function(e,t){if(anObject(e),!isObject(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,c){try{c=_dereq_("./$.ctx")(Function.call,getDesc(Object.prototype,"__proto__").set,2),c(e,[]),t=!(e instanceof Array)}catch(r){t=!0}return function(e,r){return check(e,r),t?e.__proto__=r:c(e,r),e}}({},!1):void 0),check:check};

},{"./$":152,"./$.an-object":121,"./$.ctx":128,"./$.is-object":145}],163:[function(_dereq_,module,exports){
"use strict";var core=_dereq_("./$.core"),$=_dereq_("./$"),DESCRIPTORS=_dereq_("./$.descriptors"),SPECIES=_dereq_("./$.wks")("species");module.exports=function(e){var r=core[e];DESCRIPTORS&&r&&!r[SPECIES]&&$.setDesc(r,SPECIES,{configurable:!0,get:function(){return this}})};

},{"./$":152,"./$.core":127,"./$.descriptors":130,"./$.wks":175}],164:[function(_dereq_,module,exports){
var def=_dereq_("./$").setDesc,has=_dereq_("./$.has"),TAG=_dereq_("./$.wks")("toStringTag");module.exports=function(e,r,a){e&&!has(e=a?e:e.prototype,TAG)&&def(e,TAG,{configurable:!0,value:r})};

},{"./$":152,"./$.has":138,"./$.wks":175}],165:[function(_dereq_,module,exports){
var global=_dereq_("./$.global"),SHARED="__core-js_shared__",store=global[SHARED]||(global[SHARED]={});module.exports=function(o){return store[o]||(store[o]={})};

},{"./$.global":137}],166:[function(_dereq_,module,exports){
var anObject=_dereq_("./$.an-object"),aFunction=_dereq_("./$.a-function"),SPECIES=_dereq_("./$.wks")("species");module.exports=function(e,n){var r,t=anObject(e).constructor;return void 0===t||void 0==(r=anObject(t)[SPECIES])?n:aFunction(r)};

},{"./$.a-function":119,"./$.an-object":121,"./$.wks":175}],167:[function(_dereq_,module,exports){
module.exports=function(e,r,o){if(!(e instanceof r))throw TypeError(o+": use the 'new' operator!");return e};

},{}],168:[function(_dereq_,module,exports){
var toInteger=_dereq_("./$.to-integer"),defined=_dereq_("./$.defined");module.exports=function(e){return function(r,t){var n,i,d=String(defined(r)),o=toInteger(t),u=d.length;return 0>o||o>=u?e?"":void 0:(n=d.charCodeAt(o),55296>n||n>56319||o+1===u||(i=d.charCodeAt(o+1))<56320||i>57343?e?d.charAt(o):n:e?d.slice(o,o+2):(n-55296<<10)+(i-56320)+65536)}};

},{"./$.defined":129,"./$.to-integer":170}],169:[function(_dereq_,module,exports){
var ctx=_dereq_("./$.ctx"),invoke=_dereq_("./$.invoke"),html=_dereq_("./$.html"),cel=_dereq_("./$.dom-create"),global=_dereq_("./$.global"),process=global.process,setTask=global.setImmediate,clearTask=global.clearImmediate,MessageChannel=global.MessageChannel,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",defer,channel,port,run=function(){var e=+this;if(queue.hasOwnProperty(e)){var n=queue[e];delete queue[e],n()}},listner=function(e){run.call(e.data)};setTask&&clearTask||(setTask=function(e){for(var n=[],t=1;arguments.length>t;)n.push(arguments[t++]);return queue[++counter]=function(){invoke("function"==typeof e?e:Function(e),n)},defer(counter),counter},clearTask=function(e){delete queue[e]},"process"==_dereq_("./$.cof")(process)?defer=function(e){process.nextTick(ctx(run,e,1))}:MessageChannel?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listner,defer=ctx(port.postMessage,port,1)):global.addEventListener&&"function"==typeof postMessage&&!global.importScripts?(defer=function(e){global.postMessage(e+"","*")},global.addEventListener("message",listner,!1)):defer=ONREADYSTATECHANGE in cel("script")?function(e){html.appendChild(cel("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run.call(e)}}:function(e){setTimeout(ctx(run,e,1),0)}),module.exports={set:setTask,clear:clearTask};

},{"./$.cof":123,"./$.ctx":128,"./$.dom-create":131,"./$.global":137,"./$.html":140,"./$.invoke":141}],170:[function(_dereq_,module,exports){
var ceil=Math.ceil,floor=Math.floor;module.exports=function(o){return isNaN(o=+o)?0:(o>0?floor:ceil)(o)};

},{}],171:[function(_dereq_,module,exports){
var IObject=_dereq_("./$.iobject"),defined=_dereq_("./$.defined");module.exports=function(e){return IObject(defined(e))};

},{"./$.defined":129,"./$.iobject":142}],172:[function(_dereq_,module,exports){
var toInteger=_dereq_("./$.to-integer"),min=Math.min;module.exports=function(e){return e>0?min(toInteger(e),9007199254740991):0};

},{"./$.to-integer":170}],173:[function(_dereq_,module,exports){
var defined=_dereq_("./$.defined");module.exports=function(e){return Object(defined(e))};

},{"./$.defined":129}],174:[function(_dereq_,module,exports){
var id=0,px=Math.random();module.exports=function(o){return"Symbol(".concat(void 0===o?"":o,")_",(++id+px).toString(36))};

},{}],175:[function(_dereq_,module,exports){
var store=_dereq_("./$.shared")("wks"),uid=_dereq_("./$.uid"),Symbol=_dereq_("./$.global").Symbol;module.exports=function(r){return store[r]||(store[r]=Symbol&&Symbol[r]||(Symbol||uid)("Symbol."+r))};

},{"./$.global":137,"./$.shared":165,"./$.uid":174}],176:[function(_dereq_,module,exports){
var classof=_dereq_("./$.classof"),ITERATOR=_dereq_("./$.wks")("iterator"),Iterators=_dereq_("./$.iterators");module.exports=_dereq_("./$.core").getIteratorMethod=function(r){return void 0!=r?r[ITERATOR]||r["@@iterator"]||Iterators[classof(r)]:void 0};

},{"./$.classof":122,"./$.core":127,"./$.iterators":151,"./$.wks":175}],177:[function(_dereq_,module,exports){
var anObject=_dereq_("./$.an-object"),get=_dereq_("./core.get-iterator-method");module.exports=_dereq_("./$.core").getIterator=function(e){var r=get(e);if("function"!=typeof r)throw TypeError(e+" is not iterable!");return anObject(r.call(e))};

},{"./$.an-object":121,"./$.core":127,"./core.get-iterator-method":176}],178:[function(_dereq_,module,exports){
var classof=_dereq_("./$.classof"),ITERATOR=_dereq_("./$.wks")("iterator"),Iterators=_dereq_("./$.iterators");module.exports=_dereq_("./$.core").isIterable=function(r){var e=Object(r);return void 0!==e[ITERATOR]||"@@iterator"in e||Iterators.hasOwnProperty(classof(e))};

},{"./$.classof":122,"./$.core":127,"./$.iterators":151,"./$.wks":175}],179:[function(_dereq_,module,exports){
"use strict";var ctx=_dereq_("./$.ctx"),$export=_dereq_("./$.export"),toObject=_dereq_("./$.to-object"),call=_dereq_("./$.iter-call"),isArrayIter=_dereq_("./$.is-array-iter"),toLength=_dereq_("./$.to-length"),getIterFn=_dereq_("./core.get-iterator-method");$export($export.S+$export.F*!_dereq_("./$.iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e){var r,t,o,i,n=toObject(e),a="function"==typeof this?this:Array,c=arguments,u=c.length,l=u>1?c[1]:void 0,$=void 0!==l,g=0,f=getIterFn(n);if($&&(l=ctx(l,u>2?c[2]:void 0,2)),void 0==f||a==Array&&isArrayIter(f))for(r=toLength(n.length),t=new a(r);r>g;g++)t[g]=$?l(n[g],g):n[g];else for(i=f.call(n),t=new a;!(o=i.next()).done;g++)t[g]=$?call(i,l,[o.value,g],!0):o.value;return t.length=g,t}});

},{"./$.ctx":128,"./$.export":133,"./$.is-array-iter":143,"./$.iter-call":146,"./$.iter-detect":149,"./$.to-length":172,"./$.to-object":173,"./core.get-iterator-method":176}],180:[function(_dereq_,module,exports){
"use strict";var addToUnscopables=_dereq_("./$.add-to-unscopables"),step=_dereq_("./$.iter-step"),Iterators=_dereq_("./$.iterators"),toIObject=_dereq_("./$.to-iobject");module.exports=_dereq_("./$.iter-define")(Array,"Array",function(e,t){this._t=toIObject(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,s=this._i++;return!e||s>=e.length?(this._t=void 0,step(1)):"keys"==t?step(0,s):"values"==t?step(0,e[s]):step(0,[s,e[s]])},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries");

},{"./$.add-to-unscopables":120,"./$.iter-define":148,"./$.iter-step":150,"./$.iterators":151,"./$.to-iobject":171}],181:[function(_dereq_,module,exports){
"use strict";var strong=_dereq_("./$.collection-strong");_dereq_("./$.collection")("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=strong.getEntry(this,t);return n&&n.v},set:function(t,n){return strong.def(this,0===t?0:t,n)}},strong,!0);

},{"./$.collection":126,"./$.collection-strong":124}],182:[function(_dereq_,module,exports){
var $export=_dereq_("./$.export");$export($export.S+$export.F,"Object",{assign:_dereq_("./$.object-assign")});

},{"./$.export":133,"./$.object-assign":156}],183:[function(_dereq_,module,exports){
var isObject=_dereq_("./$.is-object");_dereq_("./$.object-sap")("freeze",function(e){return function(r){return e&&isObject(r)?e(r):r}});

},{"./$.is-object":145,"./$.object-sap":157}],184:[function(_dereq_,module,exports){
var toIObject=_dereq_("./$.to-iobject");_dereq_("./$.object-sap")("getOwnPropertyDescriptor",function(t){return function(e,r){return t(toIObject(e),r)}});

},{"./$.object-sap":157,"./$.to-iobject":171}],185:[function(_dereq_,module,exports){
_dereq_("./$.object-sap")("getOwnPropertyNames",function(){return _dereq_("./$.get-names").get});

},{"./$.get-names":136,"./$.object-sap":157}],186:[function(_dereq_,module,exports){
var toObject=_dereq_("./$.to-object");_dereq_("./$.object-sap")("keys",function(e){return function(t){return e(toObject(t))}});

},{"./$.object-sap":157,"./$.to-object":173}],187:[function(_dereq_,module,exports){
var isObject=_dereq_("./$.is-object");_dereq_("./$.object-sap")("seal",function(e){return function(r){return e&&isObject(r)?e(r):r}});

},{"./$.is-object":145,"./$.object-sap":157}],188:[function(_dereq_,module,exports){
var $export=_dereq_("./$.export");$export($export.S,"Object",{setPrototypeOf:_dereq_("./$.set-proto").set});

},{"./$.export":133,"./$.set-proto":162}],189:[function(_dereq_,module,exports){

},{}],190:[function(_dereq_,module,exports){
"use strict";var $=_dereq_("./$"),LIBRARY=_dereq_("./$.library"),global=_dereq_("./$.global"),ctx=_dereq_("./$.ctx"),classof=_dereq_("./$.classof"),$export=_dereq_("./$.export"),isObject=_dereq_("./$.is-object"),anObject=_dereq_("./$.an-object"),aFunction=_dereq_("./$.a-function"),strictNew=_dereq_("./$.strict-new"),forOf=_dereq_("./$.for-of"),setProto=_dereq_("./$.set-proto").set,same=_dereq_("./$.same-value"),SPECIES=_dereq_("./$.wks")("species"),speciesConstructor=_dereq_("./$.species-constructor"),asap=_dereq_("./$.microtask"),PROMISE="Promise",process=global.process,isNode="process"==classof(process),P=global[PROMISE],Wrapper,testResolve=function(e){var r=new P(function(){});return e&&(r.constructor=Object),P.resolve(r)===r},USE_NATIVE=function(){function e(r){var t=new P(r);return setProto(t,e.prototype),t}var r=!1;try{if(r=P&&P.resolve&&testResolve(),setProto(e,P),e.prototype=$.create(P.prototype,{constructor:{value:e}}),e.resolve(5).then(function(){})instanceof e||(r=!1),r&&_dereq_("./$.descriptors")){var t=!1;P.resolve($.setDesc({},"then",{get:function(){t=!0}})),r=t}}catch(o){r=!1}return r}(),sameConstructor=function(e,r){return LIBRARY&&e===P&&r===Wrapper?!0:same(e,r)},getConstructor=function(e){var r=anObject(e)[SPECIES];return void 0!=r?r:e},isThenable=function(e){var r;return isObject(e)&&"function"==typeof(r=e.then)?r:!1},PromiseCapability=function(e){var r,t;this.promise=new e(function(e,o){if(void 0!==r||void 0!==t)throw TypeError("Bad Promise constructor");r=e,t=o}),this.resolve=aFunction(r),this.reject=aFunction(t)},perform=function(e){try{e()}catch(r){return{error:r}}},notify=function(e,r){if(!e.n){e.n=!0;var t=e.c;asap(function(){for(var o=e.v,n=1==e.s,i=0,s=function(r){var t,i,s=n?r.ok:r.fail,c=r.resolve,a=r.reject;try{s?(n||(e.h=!0),t=s===!0?o:s(o),t===r.promise?a(TypeError("Promise-chain cycle")):(i=isThenable(t))?i.call(t,c,a):c(t)):a(o)}catch(u){a(u)}};t.length>i;)s(t[i++]);t.length=0,e.n=!1,r&&setTimeout(function(){var r,t,n=e.p;isUnhandled(n)&&(isNode?process.emit("unhandledRejection",o,n):(r=global.onunhandledrejection)?r({promise:n,reason:o}):(t=global.console)&&t.error&&t.error("Unhandled promise rejection",o)),e.a=void 0},1)})}},isUnhandled=function(e){var r,t=e._d,o=t.a||t.c,n=0;if(t.h)return!1;for(;o.length>n;)if(r=o[n++],r.fail||!isUnhandled(r.promise))return!1;return!0},$reject=function(e){var r=this;r.d||(r.d=!0,r=r.r||r,r.v=e,r.s=2,r.a=r.c.slice(),notify(r,!0))},$resolve=function(e){var r,t=this;if(!t.d){t.d=!0,t=t.r||t;try{if(t.p===e)throw TypeError("Promise can't be resolved itself");(r=isThenable(e))?asap(function(){var o={r:t,d:!1};try{r.call(e,ctx($resolve,o,1),ctx($reject,o,1))}catch(n){$reject.call(o,n)}}):(t.v=e,t.s=1,notify(t,!1))}catch(o){$reject.call({r:t,d:!1},o)}}};USE_NATIVE||(P=function(e){aFunction(e);var r=this._d={p:strictNew(this,P,PROMISE),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{e(ctx($resolve,r,1),ctx($reject,r,1))}catch(t){$reject.call(r,t)}},_dereq_("./$.redefine-all")(P.prototype,{then:function(e,r){var t=new PromiseCapability(speciesConstructor(this,P)),o=t.promise,n=this._d;return t.ok="function"==typeof e?e:!0,t.fail="function"==typeof r&&r,n.c.push(t),n.a&&n.a.push(t),n.s&&notify(n,!1),o},"catch":function(e){return this.then(void 0,e)}})),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Promise:P}),_dereq_("./$.set-to-string-tag")(P,PROMISE),_dereq_("./$.set-species")(PROMISE),Wrapper=_dereq_("./$.core")[PROMISE],$export($export.S+$export.F*!USE_NATIVE,PROMISE,{reject:function(e){var r=new PromiseCapability(this),t=r.reject;return t(e),r.promise}}),$export($export.S+$export.F*(!USE_NATIVE||testResolve(!0)),PROMISE,{resolve:function(e){if(e instanceof P&&sameConstructor(e.constructor,this))return e;var r=new PromiseCapability(this),t=r.resolve;return t(e),r.promise}}),$export($export.S+$export.F*!(USE_NATIVE&&_dereq_("./$.iter-detect")(function(e){P.all(e)["catch"](function(){})})),PROMISE,{all:function(e){var r=getConstructor(this),t=new PromiseCapability(r),o=t.resolve,n=t.reject,i=[],s=perform(function(){forOf(e,!1,i.push,i);var t=i.length,s=Array(t);t?$.each.call(i,function(e,i){var c=!1;r.resolve(e).then(function(e){c||(c=!0,s[i]=e,--t||o(s))},n)}):o(s)});return s&&n(s.error),t.promise},race:function(e){var r=getConstructor(this),t=new PromiseCapability(r),o=t.reject,n=perform(function(){forOf(e,!1,function(e){r.resolve(e).then(t.resolve,o)})});return n&&o(n.error),t.promise}});

},{"./$":152,"./$.a-function":119,"./$.an-object":121,"./$.classof":122,"./$.core":127,"./$.ctx":128,"./$.descriptors":130,"./$.export":133,"./$.for-of":135,"./$.global":137,"./$.is-object":145,"./$.iter-detect":149,"./$.library":154,"./$.microtask":155,"./$.redefine-all":159,"./$.same-value":161,"./$.set-proto":162,"./$.set-species":163,"./$.set-to-string-tag":164,"./$.species-constructor":166,"./$.strict-new":167,"./$.wks":175}],191:[function(_dereq_,module,exports){
"use strict";var $at=_dereq_("./$.string-at")(!0);_dereq_("./$.iter-define")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,i=this._t,e=this._i;return e>=i.length?{value:void 0,done:!0}:(t=$at(i,e),this._i+=t.length,{value:t,done:!1})});

},{"./$.iter-define":148,"./$.string-at":168}],192:[function(_dereq_,module,exports){
"use strict";var $=_dereq_("./$"),global=_dereq_("./$.global"),has=_dereq_("./$.has"),DESCRIPTORS=_dereq_("./$.descriptors"),$export=_dereq_("./$.export"),redefine=_dereq_("./$.redefine"),$fails=_dereq_("./$.fails"),shared=_dereq_("./$.shared"),setToStringTag=_dereq_("./$.set-to-string-tag"),uid=_dereq_("./$.uid"),wks=_dereq_("./$.wks"),keyOf=_dereq_("./$.keyof"),$names=_dereq_("./$.get-names"),enumKeys=_dereq_("./$.enum-keys"),isArray=_dereq_("./$.is-array"),anObject=_dereq_("./$.an-object"),toIObject=_dereq_("./$.to-iobject"),createDesc=_dereq_("./$.property-desc"),getDesc=$.getDesc,setDesc=$.setDesc,_create=$.create,getNames=$names.get,$Symbol=global.Symbol,$JSON=global.JSON,_stringify=$JSON&&$JSON.stringify,setter=!1,HIDDEN=wks("_hidden"),isEnum=$.isEnum,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),useNative="function"==typeof $Symbol,ObjectProto=Object.prototype,setSymbolDesc=DESCRIPTORS&&$fails(function(){return 7!=_create(setDesc({},"a",{get:function(){return setDesc(this,"a",{value:7}).a}})).a})?function(e,t,r){var s=getDesc(ObjectProto,t);s&&delete ObjectProto[t],setDesc(e,t,r),s&&e!==ObjectProto&&setDesc(ObjectProto,t,s)}:setDesc,wrap=function(e){var t=AllSymbols[e]=_create($Symbol.prototype);return t._k=e,DESCRIPTORS&&setter&&setSymbolDesc(ObjectProto,e,{configurable:!0,set:function(t){has(this,HIDDEN)&&has(this[HIDDEN],e)&&(this[HIDDEN][e]=!1),setSymbolDesc(this,e,createDesc(1,t))}}),t},isSymbol=function(e){return"symbol"==typeof e},$defineProperty=function(e,t,r){return r&&has(AllSymbols,t)?(r.enumerable?(has(e,HIDDEN)&&e[HIDDEN][t]&&(e[HIDDEN][t]=!1),r=_create(r,{enumerable:createDesc(0,!1)})):(has(e,HIDDEN)||setDesc(e,HIDDEN,createDesc(1,{})),e[HIDDEN][t]=!0),setSymbolDesc(e,t,r)):setDesc(e,t,r)},$defineProperties=function(e,t){anObject(e);for(var r,s=enumKeys(t=toIObject(t)),o=0,i=s.length;i>o;)$defineProperty(e,r=s[o++],t[r]);return e},$create=function(e,t){return void 0===t?_create(e):$defineProperties(_create(e),t)},$propertyIsEnumerable=function(e){var t=isEnum.call(this,e);return t||!has(this,e)||!has(AllSymbols,e)||has(this,HIDDEN)&&this[HIDDEN][e]?t:!0},$getOwnPropertyDescriptor=function(e,t){var r=getDesc(e=toIObject(e),t);return!r||!has(AllSymbols,t)||has(e,HIDDEN)&&e[HIDDEN][t]||(r.enumerable=!0),r},$getOwnPropertyNames=function(e){for(var t,r=getNames(toIObject(e)),s=[],o=0;r.length>o;)has(AllSymbols,t=r[o++])||t==HIDDEN||s.push(t);return s},$getOwnPropertySymbols=function(e){for(var t,r=getNames(toIObject(e)),s=[],o=0;r.length>o;)has(AllSymbols,t=r[o++])&&s.push(AllSymbols[t]);return s},$stringify=function(e){if(void 0!==e&&!isSymbol(e)){for(var t,r,s=[e],o=1,i=arguments;i.length>o;)s.push(i[o++]);return t=s[1],"function"==typeof t&&(r=t),(r||!isArray(t))&&(t=function(e,t){return r&&(t=r.call(this,e,t)),isSymbol(t)?void 0:t}),s[1]=t,_stringify.apply($JSON,s)}},buggyJSON=$fails(function(){var e=$Symbol();return"[null]"!=_stringify([e])||"{}"!=_stringify({a:e})||"{}"!=_stringify(Object(e))});useNative||($Symbol=function(){if(isSymbol(this))throw TypeError("Symbol is not a constructor");return wrap(uid(arguments.length>0?arguments[0]:void 0))},redefine($Symbol.prototype,"toString",function(){return this._k}),isSymbol=function(e){return e instanceof $Symbol},$.create=$create,$.isEnum=$propertyIsEnumerable,$.getDesc=$getOwnPropertyDescriptor,$.setDesc=$defineProperty,$.setDescs=$defineProperties,$.getNames=$names.get=$getOwnPropertyNames,$.getSymbols=$getOwnPropertySymbols,DESCRIPTORS&&!_dereq_("./$.library")&&redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,!0));var symbolStatics={"for":function(e){return has(SymbolRegistry,e+="")?SymbolRegistry[e]:SymbolRegistry[e]=$Symbol(e)},keyFor:function(e){return keyOf(SymbolRegistry,e)},useSetter:function(){setter=!0},useSimple:function(){setter=!1}};$.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=wks(e);symbolStatics[e]=useNative?t:wrap(t)}),setter=!0,$export($export.G+$export.W,{Symbol:$Symbol}),$export($export.S,"Symbol",symbolStatics),$export($export.S+$export.F*!useNative,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),$JSON&&$export($export.S+$export.F*(!useNative||buggyJSON),"JSON",{stringify:$stringify}),setToStringTag($Symbol,"Symbol"),setToStringTag(Math,"Math",!0),setToStringTag(global.JSON,"JSON",!0);

},{"./$":152,"./$.an-object":121,"./$.descriptors":130,"./$.enum-keys":132,"./$.export":133,"./$.fails":134,"./$.get-names":136,"./$.global":137,"./$.has":138,"./$.is-array":144,"./$.keyof":153,"./$.library":154,"./$.property-desc":158,"./$.redefine":160,"./$.set-to-string-tag":164,"./$.shared":165,"./$.to-iobject":171,"./$.uid":174,"./$.wks":175}],193:[function(_dereq_,module,exports){
var $export=_dereq_("./$.export");$export($export.P,"Map",{toJSON:_dereq_("./$.collection-to-json")("Map")});

},{"./$.collection-to-json":125,"./$.export":133}],194:[function(_dereq_,module,exports){
_dereq_("./es6.array.iterator");var Iterators=_dereq_("./$.iterators");Iterators.NodeList=Iterators.HTMLCollection=Iterators.Array;

},{"./$.iterators":151,"./es6.array.iterator":180}],195:[function(_dereq_,module,exports){
"use strict";function EE(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function EventEmitter(){}EventEmitter.prototype._events=void 0,EventEmitter.prototype.listeners=function(t){if(!this._events||!this._events[t])return[];if(this._events[t].fn)return[this._events[t].fn];for(var e=0,n=this._events[t].length,s=new Array(n);n>e;e++)s[e]=this._events[t][e].fn;return s},EventEmitter.prototype.emit=function(t,e,n,s,r,i){if(!this._events||!this._events[t])return!1;var v,o,h=this._events[t],E=arguments.length;if("function"==typeof h.fn){switch(h.once&&this.removeListener(t,h.fn,!0),E){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,s),!0;case 5:return h.fn.call(h.context,e,n,s,r),!0;case 6:return h.fn.call(h.context,e,n,s,r,i),!0}for(o=1,v=new Array(E-1);E>o;o++)v[o-1]=arguments[o];h.fn.apply(h.context,v)}else{var f,c=h.length;for(o=0;c>o;o++)switch(h[o].once&&this.removeListener(t,h[o].fn,!0),E){case 1:h[o].fn.call(h[o].context);break;case 2:h[o].fn.call(h[o].context,e);break;case 3:h[o].fn.call(h[o].context,e,n);break;default:if(!v)for(f=1,v=new Array(E-1);E>f;f++)v[f-1]=arguments[f];h[o].fn.apply(h[o].context,v)}}return!0},EventEmitter.prototype.on=function(t,e,n){var s=new EE(e,n||this);return this._events||(this._events={}),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],s]:this._events[t].push(s):this._events[t]=s,this},EventEmitter.prototype.once=function(t,e,n){var s=new EE(e,n||this,!0);return this._events||(this._events={}),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],s]:this._events[t].push(s):this._events[t]=s,this},EventEmitter.prototype.removeListener=function(t,e,n){if(!this._events||!this._events[t])return this;var s=this._events[t],r=[];if(e&&(s.fn&&(s.fn!==e||n&&!s.once)&&r.push(s),!s.fn))for(var i=0,v=s.length;v>i;i++)(s[i].fn!==e||n&&!s[i].once)&&r.push(s[i]);return r.length?this._events[t]=1===r.length?r[0]:r:delete this._events[t],this},EventEmitter.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[t]:this._events={},this):this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.setMaxListeners=function(){return this},EventEmitter.EventEmitter=EventEmitter,EventEmitter.EventEmitter2=EventEmitter,EventEmitter.EventEmitter3=EventEmitter,module.exports=EventEmitter;

},{}],196:[function(_dereq_,module,exports){
module.exports=function(){return this}();

},{}],197:[function(_dereq_,module,exports){
var indexOf=[].indexOf;module.exports=function(e,n){if(indexOf)return e.indexOf(n);for(var r=0;r<e.length;++r)if(e[r]===n)return r;return-1};

},{}],198:[function(_dereq_,module,exports){
module.exports=Array.isArray||function(r){return"[object Array]"==Object.prototype.toString.call(r)};

},{}],199:[function(_dereq_,module,exports){
!function(e){function t(e){if(t[e]!==o)return t[e];var r;if("bug-string-char-index"==e)r="a"!="a"[0];else if("json"==e)r=t("json-stringify")&&t("json-parse");else{var n,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var i=l.stringify,s="function"==typeof i&&f;if(s){(n=function(){return 1}).toJSON=n;try{s="0"===i(0)&&"0"===i(new Number)&&'""'==i(new String)&&i(c)===o&&i(o)===o&&i()===o&&"1"===i(n)&&"[1]"==i([n])&&"[null]"==i([o])&&"null"==i(null)&&"[null,null,null]"==i([o,c,null])&&i({a:[n,!0,!1,null,"\x00\b\n\f\r	"]})==a&&"1"===i(null,n)&&"[\n 1,\n 2\n]"==i([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==i(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==i(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==i(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==i(new Date(-1))}catch(u){s=!1}}r=s}if("json-parse"==e){var h=l.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){n=h(a);var p=5==n.a.length&&1===n.a[0];if(p){try{p=!h('"	"')}catch(u){}if(p)try{p=1!==h("01")}catch(u){}if(p)try{p=1!==h("1.")}catch(u){}}}}catch(u){p=!1}r=p}}return t[e]=!!r}var r,n,o,c={}.toString,a="function"==typeof define&&define.amd,i="object"==typeof JSON&&JSON,l="object"==typeof exports&&exports&&!exports.nodeType&&exports;l&&i?(l.stringify=i.stringify,l.parse=i.parse):l=e.JSON=i||{};var f=new Date(-0xc782b5b800cec);try{f=-109252==f.getUTCFullYear()&&0===f.getUTCMonth()&&1===f.getUTCDate()&&10==f.getUTCHours()&&37==f.getUTCMinutes()&&6==f.getUTCSeconds()&&708==f.getUTCMilliseconds()}catch(s){}if(!t("json")){var u="[object Function]",h="[object Date]",p="[object Number]",g="[object String]",y="[object Array]",d="[object Boolean]",v=t("bug-string-char-index");if(!f)var b=Math.floor,C=[0,31,59,90,120,151,181,212,243,273,304,334],j=function(e,t){return C[t]+365*(e-1970)+b((e-1969+(t=+(t>1)))/4)-b((e-1901+t)/100)+b((e-1601+t)/400)};(r={}.hasOwnProperty)||(r=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=c?r=function(e){var t=this.__proto__,r=e in(this.__proto__=null,this);return this.__proto__=t,r}:(t=n.constructor,r=function(e){var r=(this.constructor||t).prototype;return e in this&&!(e in r&&this[e]===r[e])}),n=null,r.call(this,e)});var A={"boolean":1,number:1,string:1,undefined:1},T=function(e,t){var r=typeof e[t];return"object"==r?!!e[t]:!A[r]};if(n=function(e,t){var o,a,i,l=0;(o=function(){this.valueOf=0}).prototype.valueOf=0,a=new o;for(i in a)r.call(a,i)&&l++;return o=a=null,l?n=2==l?function(e,t){var n,o={},a=c.call(e)==u;for(n in e)a&&"prototype"==n||r.call(o,n)||!(o[n]=1)||!r.call(e,n)||t(n)}:function(e,t){var n,o,a=c.call(e)==u;for(n in e)a&&"prototype"==n||!r.call(e,n)||(o="constructor"===n)||t(n);(o||r.call(e,n="constructor"))&&t(n)}:(a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],n=function(e,t){var n,o,i=c.call(e)==u,l=!i&&"function"!=typeof e.constructor&&T(e,"hasOwnProperty")?e.hasOwnProperty:r;for(n in e)i&&"prototype"==n||!l.call(e,n)||t(n);for(o=a.length;n=a[--o];l.call(e,n)&&t(n));}),n(e,t)},!t("json-stringify")){var S={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},_="000000",w=function(e,t){return(_+(t||0)).slice(-e)},O="\\u00",U=function(e){var t,r='"',n=0,o=e.length,c=o>10&&v;for(c&&(t=e.split(""));o>n;n++){var a=e.charCodeAt(n);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:r+=S[a];break;default:if(32>a){r+=O+w(2,a.toString(16));break}r+=c?t[n]:v?e.charAt(n):e[n]}}return r+'"'},x=function(e,t,a,i,l,f,s){var u,v,C,A,T,S,_,O,N,D,J,M,k,m,P,Z;try{u=t[e]}catch(E){}if("object"==typeof u&&u)if(v=c.call(u),v!=h||r.call(u,"toJSON"))"function"==typeof u.toJSON&&(v!=p&&v!=g&&v!=y||r.call(u,"toJSON"))&&(u=u.toJSON(e));else if(u>-1/0&&1/0>u){if(j){for(T=b(u/864e5),C=b(T/365.2425)+1970-1;j(C+1,0)<=T;C++);for(A=b((T-j(C,0))/30.42);j(C,A+1)<=T;A++);T=1+T-j(C,A),S=(u%864e5+864e5)%864e5,_=b(S/36e5)%24,O=b(S/6e4)%60,N=b(S/1e3)%60,D=S%1e3}else C=u.getUTCFullYear(),A=u.getUTCMonth(),T=u.getUTCDate(),_=u.getUTCHours(),O=u.getUTCMinutes(),N=u.getUTCSeconds(),D=u.getUTCMilliseconds();u=(0>=C||C>=1e4?(0>C?"-":"+")+w(6,0>C?-C:C):w(4,C))+"-"+w(2,A+1)+"-"+w(2,T)+"T"+w(2,_)+":"+w(2,O)+":"+w(2,N)+"."+w(3,D)+"Z"}else u=null;if(a&&(u=a.call(t,e,u)),null===u)return"null";if(v=c.call(u),v==d)return""+u;if(v==p)return u>-1/0&&1/0>u?""+u:"null";if(v==g)return U(""+u);if("object"==typeof u){for(m=s.length;m--;)if(s[m]===u)throw TypeError();if(s.push(u),J=[],P=f,f+=l,v==y){for(k=0,m=u.length;m>k;k++)M=x(k,u,a,i,l,f,s),J.push(M===o?"null":M);Z=J.length?l?"[\n"+f+J.join(",\n"+f)+"\n"+P+"]":"["+J.join(",")+"]":"[]"}else n(i||u,function(e){var t=x(e,u,a,i,l,f,s);t!==o&&J.push(U(e)+":"+(l?" ":"")+t)}),Z=J.length?l?"{\n"+f+J.join(",\n"+f)+"\n"+P+"}":"{"+J.join(",")+"}":"{}";return s.pop(),Z}};l.stringify=function(e,t,r){var n,o,a,i;if("function"==typeof t||"object"==typeof t&&t)if((i=c.call(t))==u)o=t;else if(i==y){a={};for(var l,f=0,s=t.length;s>f;l=t[f++],i=c.call(l),(i==g||i==p)&&(a[l]=1));}if(r)if((i=c.call(r))==p){if((r-=r%1)>0)for(n="",r>10&&(r=10);n.length<r;n+=" ");}else i==g&&(n=r.length<=10?r:r.slice(0,10));return x("",(l={},l[""]=e,l),o,a,n,"",[])}}if(!t("json-parse")){var N,D,J=String.fromCharCode,M={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},k=function(){throw N=D=null,SyntaxError()},m=function(){for(var e,t,r,n,o,c=D,a=c.length;a>N;)switch(o=c.charCodeAt(N)){case 9:case 10:case 13:case 32:N++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=v?c.charAt(N):c[N],N++,e;case 34:for(e="@",N++;a>N;)if(o=c.charCodeAt(N),32>o)k();else if(92==o)switch(o=c.charCodeAt(++N)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=M[o],N++;break;case 117:for(t=++N,r=N+4;r>N;N++)o=c.charCodeAt(N),o>=48&&57>=o||o>=97&&102>=o||o>=65&&70>=o||k();e+=J("0x"+c.slice(t,N));break;default:k()}else{if(34==o)break;for(o=c.charCodeAt(N),t=N;o>=32&&92!=o&&34!=o;)o=c.charCodeAt(++N);e+=c.slice(t,N)}if(34==c.charCodeAt(N))return N++,e;k();default:if(t=N,45==o&&(n=!0,o=c.charCodeAt(++N)),o>=48&&57>=o){for(48==o&&(o=c.charCodeAt(N+1),o>=48&&57>=o)&&k(),n=!1;a>N&&(o=c.charCodeAt(N),o>=48&&57>=o);N++);if(46==c.charCodeAt(N)){for(r=++N;a>r&&(o=c.charCodeAt(r),o>=48&&57>=o);r++);r==N&&k(),N=r}if(o=c.charCodeAt(N),101==o||69==o){for(o=c.charCodeAt(++N),(43==o||45==o)&&N++,r=N;a>r&&(o=c.charCodeAt(r),o>=48&&57>=o);r++);r==N&&k(),N=r}return+c.slice(t,N)}if(n&&k(),"true"==c.slice(N,N+4))return N+=4,!0;if("false"==c.slice(N,N+5))return N+=5,!1;if("null"==c.slice(N,N+4))return N+=4,null;k()}return"$"},P=function(e){var t,r;if("$"==e&&k(),"string"==typeof e){if("@"==(v?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=m(),"]"!=e;r||(r=!0))r&&(","==e?(e=m(),"]"==e&&k()):k()),","==e&&k(),t.push(P(e));return t}if("{"==e){for(t={};e=m(),"}"!=e;r||(r=!0))r&&(","==e?(e=m(),"}"==e&&k()):k()),(","==e||"string"!=typeof e||"@"!=(v?e.charAt(0):e[0])||":"!=m())&&k(),t[e.slice(1)]=P(m());return t}k()}return e},Z=function(e,t,r){var n=E(e,t,r);n===o?delete e[t]:e[t]=n},E=function(e,t,r){var o,a=e[t];if("object"==typeof a&&a)if(c.call(a)==y)for(o=a.length;o--;)Z(a,o,r);else n(a,function(e){Z(a,e,r)});return r.call(e,t,a)};l.parse=function(e,t){var r,n;return N=0,D=""+e,r=P(m()),"$"!=m()&&k(),N=D=null,t&&c.call(t)==u?E((n={},n[""]=r,n),"",t):r}}}a&&define(function(){return l})}(this);

},{}],200:[function(_dereq_,module,exports){
var has=Object.prototype.hasOwnProperty;exports.keys=Object.keys||function(r){var t=[];for(var e in r)has.call(r,e)&&t.push(e);return t},exports.values=function(r){var t=[];for(var e in r)has.call(r,e)&&t.push(r[e]);return t},exports.merge=function(r,t){for(var e in t)has.call(t,e)&&(r[e]=t[e]);return r},exports.length=function(r){return exports.keys(r).length},exports.isEmpty=function(r){return 0==exports.length(r)};

},{}],201:[function(_dereq_,module,exports){
(function (global){
var rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rtrimLeft=/^\s+/,rtrimRight=/\s+$/;module.exports=function(r){return"string"==typeof r&&r?(r=r.replace(rtrimLeft,"").replace(rtrimRight,""),global.JSON&&JSON.parse?JSON.parse(r):rvalidchars.test(r.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))?new Function("return "+r)():void 0):null};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],202:[function(_dereq_,module,exports){
exports.encode=function(e){var n="";for(var o in e)e.hasOwnProperty(o)&&(n.length&&(n+="&"),n+=encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return n},exports.decode=function(e){for(var n={},o=e.split("&"),t=0,r=o.length;r>t;t++){var d=o[t].split("=");n[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return n};

},{}],203:[function(_dereq_,module,exports){
function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var e=setTimeout(cleanUpNextTick);draining=!0;for(var n=queue.length;n;){for(currentQueue=queue,queue=[];++queueIndex<n;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,n=queue.length}currentQueue=null,draining=!1,clearTimeout(e)}}function Item(e,n){this.fun=e,this.array=n}function noop(){}var process=module.exports={},queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];queue.push(new Item(e,n)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],204:[function(_dereq_,module,exports){
module.exports=_dereq_("./lib/");

},{"./lib/":205}],205:[function(_dereq_,module,exports){
function lookup(e,r){"object"==typeof e&&(r=e,e=void 0),r=r||{};var o,c=url(e),a=c.source,t=c.id;return r.forceNew||r["force new connection"]||!1===r.multiplex?(debug("ignoring socket cache for %s",a),o=Manager(a,r)):(cache[t]||(debug("new io instance for %s",a),cache[t]=Manager(a,r)),o=cache[t]),o.socket(c.path)}var url=_dereq_("./url"),parser=_dereq_("socket.io-parser"),Manager=_dereq_("./manager"),debug=_dereq_("debug")("socket.io-client");module.exports=exports=lookup;var cache=exports.managers={};exports.protocol=parser.protocol,exports.connect=lookup,exports.Manager=_dereq_("./manager"),exports.Socket=_dereq_("./socket");

},{"./manager":206,"./socket":208,"./url":209,"debug":211,"socket.io-parser":234}],206:[function(_dereq_,module,exports){
function Manager(e,t){return this instanceof Manager?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new parser.Encoder,this.decoder=new parser.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new Manager(e,t)}var url=_dereq_("./url"),eio=_dereq_("engine.io-client"),Socket=_dereq_("./socket"),Emitter=_dereq_("component-emitter"),parser=_dereq_("socket.io-parser"),on=_dereq_("./on"),bind=_dereq_("component-bind"),object=_dereq_("object-component"),debug=_dereq_("debug")("socket.io-client:manager"),indexOf=_dereq_("indexof"),Backoff=_dereq_("backo2");module.exports=Manager,Manager.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},Manager.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},Emitter(Manager.prototype),Manager.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},Manager.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},Manager.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},Manager.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},Manager.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},Manager.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},Manager.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},Manager.prototype.open=Manager.prototype.connect=function(e){if(debug("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;debug("opening %s",this.uri),this.engine=eio(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var o=on(t,"open",function(){n.onopen(),e&&e()}),i=on(t,"error",function(t){if(debug("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var o=new Error("Connection error");o.data=t,e(o)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var r=this._timeout;debug("connect attempt will timeout after %d",r);var c=setTimeout(function(){debug("connect attempt timed out after %d",r),o.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",r)},r);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(o),this.subs.push(i),this},Manager.prototype.onopen=function(){debug("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(on(e,"data",bind(this,"ondata"))),this.subs.push(on(this.decoder,"decoded",bind(this,"ondecoded"))),this.subs.push(on(e,"error",bind(this,"onerror"))),this.subs.push(on(e,"close",bind(this,"onclose")))},Manager.prototype.ondata=function(e){this.decoder.add(e)},Manager.prototype.ondecoded=function(e){this.emit("packet",e)},Manager.prototype.onerror=function(e){debug("error",e),this.emitAll("error",e)},Manager.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new Socket(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){t.id=n.engine.id,~indexOf(n.connected,t)||n.connected.push(t)})}return t},Manager.prototype.destroy=function(e){var t=indexOf(this.connected,e);~t&&this.connected.splice(t,1),this.connected.length||this.close()},Manager.prototype.packet=function(e){debug("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(e){for(var n=0;n<e.length;n++)t.engine.write(e[n]);t.encoding=!1,t.processPacketQueue()}))},Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},Manager.prototype.cleanup=function(){for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},Manager.prototype.close=Manager.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},Manager.prototype.onclose=function(e){debug("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)debug("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();debug("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(debug("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(debug("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(debug("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},Manager.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)};

},{"./on":207,"./socket":208,"./url":209,"backo2":97,"component-bind":99,"component-emitter":100,"debug":211,"engine.io-client":212,"indexof":197,"object-component":200,"socket.io-parser":234}],207:[function(_dereq_,module,exports){
function on(n,o,e){return n.on(o,e),{destroy:function(){n.removeListener(o,e)}}}module.exports=on;

},{}],208:[function(_dereq_,module,exports){
function Socket(t,e){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var parser=_dereq_("socket.io-parser"),Emitter=_dereq_("component-emitter"),toArray=_dereq_("to-array"),on=_dereq_("./on"),bind=_dereq_("component-bind"),debug=_dereq_("debug")("socket.io-client:socket"),hasBin=_dereq_("has-binary");module.exports=exports=Socket;var events={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},emit=Emitter.prototype.emit;Emitter(Socket.prototype),Socket.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[on(t,"open",bind(this,"onopen")),on(t,"packet",bind(this,"onpacket")),on(t,"close",bind(this,"onclose"))]}},Socket.prototype.open=Socket.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},Socket.prototype.send=function(){var t=toArray(arguments);return t.unshift("message"),this.emit.apply(this,t),this},Socket.prototype.emit=function(t){if(events.hasOwnProperty(t))return emit.apply(this,arguments),this;var e=toArray(arguments),s=parser.EVENT;hasBin(e)&&(s=parser.BINARY_EVENT);var i={type:s,data:e};return"function"==typeof e[e.length-1]&&(debug("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this},Socket.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},Socket.prototype.onopen=function(){debug("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:parser.CONNECT})},Socket.prototype.onclose=function(t){debug("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},Socket.prototype.onpacket=function(t){if(t.nsp==this.nsp)switch(t.type){case parser.CONNECT:this.onconnect();break;case parser.EVENT:this.onevent(t);break;case parser.BINARY_EVENT:this.onevent(t);break;case parser.ACK:this.onack(t);break;case parser.BINARY_ACK:this.onack(t);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit("error",t.data)}},Socket.prototype.onevent=function(t){var e=t.data||[];debug("emitting event %j",e),null!=t.id&&(debug("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?emit.apply(this,e):this.receiveBuffer.push(e)},Socket.prototype.ack=function(t){var e=this,s=!1;return function(){if(!s){s=!0;var i=toArray(arguments);debug("sending ack %j",i);var n=hasBin(i)?parser.BINARY_ACK:parser.ACK;e.packet({type:n,id:t,data:i})}}},Socket.prototype.onack=function(t){debug("calling ack %s with %j",t.id,t.data);var e=this.acks[t.id];e.apply(this,t.data),delete this.acks[t.id]},Socket.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},Socket.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)emit.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},Socket.prototype.ondisconnect=function(){debug("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},Socket.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},Socket.prototype.close=Socket.prototype.disconnect=function(){return this.connected&&(debug("performing disconnect (%s)",this.nsp),this.packet({type:parser.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this};

},{"./on":207,"component-bind":99,"component-emitter":100,"debug":211,"has-binary":227,"socket.io-parser":234,"to-array":237}],209:[function(_dereq_,module,exports){
(function (global){
function url(t,o){var r=t,o=o||global.location;return null==t&&(t=o.protocol+"//"+o.host),"string"==typeof t&&("/"==t.charAt(0)&&(t="/"==t.charAt(1)?o.protocol+t:o.hostname+t),/^(https?|wss?):\/\//.test(t)||(debug("protocol-less url %s",t),t="undefined"!=typeof o?o.protocol+"//"+t:"https://"+t),debug("parse %s",t),r=parseuri(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/",r.id=r.protocol+"://"+r.host+":"+r.port,r.href=r.protocol+"://"+r.host+(o&&o.port==r.port?"":":"+r.port),r}var parseuri=_dereq_("parseuri"),debug=_dereq_("debug")("socket.io-client:url");module.exports=url;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"debug":211,"parseuri":230}],210:[function(_dereq_,module,exports){
(function (global){
function BlobBuilderConstructor(l,o){o=o||{};for(var e=new BlobBuilder,r=0;r<l.length;r++)e.append(l[r]);return o.type?e.getBlob(o.type):e.getBlob()}var BlobBuilder=global.BlobBuilder||global.WebKitBlobBuilder||global.MSBlobBuilder||global.MozBlobBuilder,blobSupported=function(){try{var l=new Blob(["hi"]);return 2==l.size}catch(o){return!1}}(),blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;module.exports=function(){return blobSupported?global.Blob:blobBuilderSupported?BlobBuilderConstructor:void 0}();

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],211:[function(_dereq_,module,exports){
function debug(e){return debug.enabled(e)?function(n){n=coerce(n);var u=new Date,o=u-(debug[e]||u);debug[e]=u,n=e+" "+n+" +"+debug.humanize(o),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function coerce(e){return e instanceof Error?e.stack||e.message:e}module.exports=debug,debug.names=[],debug.skips=[],debug.enable=function(e){try{localStorage.debug=e}catch(n){}for(var u=(e||"").split(/[\s,]+/),o=u.length,t=0;o>t;t++)e=u[t].replace("*",".*?"),"-"===e[0]?debug.skips.push(new RegExp("^"+e.substr(1)+"$")):debug.names.push(new RegExp("^"+e+"$"))},debug.disable=function(){debug.enable("")},debug.humanize=function(e){var n=1e3,u=6e4,o=60*u;return e>=o?(e/o).toFixed(1)+"h":e>=u?(e/u).toFixed(1)+"m":e>=n?(e/n|0)+"s":e+"ms"},debug.enabled=function(e){for(var n=0,u=debug.skips.length;u>n;n++)if(debug.skips[n].test(e))return!1;for(var n=0,u=debug.names.length;u>n;n++)if(debug.names[n].test(e))return!0;return!1};try{window.localStorage&&debug.enable(localStorage.debug)}catch(e){}

},{}],212:[function(_dereq_,module,exports){
module.exports=_dereq_("./lib/");

},{"./lib/":213}],213:[function(_dereq_,module,exports){
module.exports=_dereq_("./socket"),module.exports.parser=_dereq_("engine.io-parser");

},{"./socket":214,"engine.io-parser":225}],214:[function(_dereq_,module,exports){
(function (global){
function noop(){}function Socket(e,t){if(!(this instanceof Socket))return new Socket(e,t);if(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=parseuri(e),t.host=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:global.location&&"https:"==location.protocol,t.host){var r=t.host.split(":");t.hostname=r.shift(),r.length?t.port=r.pop():t.port||(t.port=this.secure?"443":"80")}this.agent=t.agent||!1,this.hostname=t.hostname||(global.location?location.hostname:"localhost"),this.port=t.port||(global.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=parseqs.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=t.rejectUnauthorized||null,this.open()}function clone(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}var transports=_dereq_("./transports"),Emitter=_dereq_("component-emitter"),debug=_dereq_("debug")("engine.io-client:socket"),index=_dereq_("indexof"),parser=_dereq_("engine.io-parser"),parseuri=_dereq_("parseuri"),parsejson=_dereq_("parsejson"),parseqs=_dereq_("parseqs");module.exports=Socket,Socket.priorWebsocketSuccess=!1,Emitter(Socket.prototype),Socket.protocol=parser.protocol,Socket.Socket=Socket,Socket.Transport=_dereq_("./transport"),Socket.transports=_dereq_("./transports"),Socket.parser=_dereq_("engine.io-parser"),Socket.prototype.createTransport=function(e){debug('creating transport "%s"',e);var t=clone(this.query);t.EIO=parser.protocol,t.transport=e,this.id&&(t.sid=this.id);var r=new transports[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return r},Socket.prototype.open=function(){var e;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0==this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";var e;try{e=this.createTransport(e)}catch(r){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},Socket.prototype.setTransport=function(e){debug("setting transport %s",e.name);var t=this;this.transport&&(debug("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},Socket.prototype.probe=function(e){function t(){if(h.onlyBinaryUpgrades){var t=!this.supportsBinary&&h.transport.supportsBinary;c=c||t}c||(debug('probe transport "%s" opened',e),p.send([{type:"ping",data:"probe"}]),p.once("packet",function(t){if(!c)if("pong"==t.type&&"probe"==t.data){if(debug('probe transport "%s" pong',e),h.upgrading=!0,h.emit("upgrading",p),!p)return;Socket.priorWebsocketSuccess="websocket"==p.name,debug('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){c||"closed"!=h.readyState&&(debug("changing transport and sending upgrade packet"),a(),h.setTransport(p),p.send([{type:"upgrade"}]),h.emit("upgrade",p),p=null,h.upgrading=!1,h.flush())})}else{debug('probe transport "%s" failed',e);var r=new Error("probe error");r.transport=p.name,h.emit("upgradeError",r)}}))}function r(){c||(c=!0,a(),p.close(),p=null)}function s(t){var s=new Error("probe error: "+t);s.transport=p.name,r(),debug('probe transport "%s" failed because of error: %s',e,t),h.emit("upgradeError",s)}function o(){s("transport closed")}function i(){s("socket closed")}function n(e){p&&e.name!=p.name&&(debug('"%s" works - aborting "%s"',e.name,p.name),r())}function a(){p.removeListener("open",t),p.removeListener("error",s),p.removeListener("close",o),h.removeListener("close",i),h.removeListener("upgrading",n)}debug('probing transport "%s"',e);var p=this.createTransport(e,{probe:1}),c=!1,h=this;Socket.priorWebsocketSuccess=!1,p.once("open",t),p.once("error",s),p.once("close",o),this.once("close",i),this.once("upgrading",n),p.open()},Socket.prototype.onOpen=function(){if(debug("socket open"),this.readyState="open",Socket.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){debug("starting upgrade probes");for(var e=0,t=this.upgrades.length;t>e;e++)this.probe(this.upgrades[e])}},Socket.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(debug('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(parsejson(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else debug('packet received with socket readyState "%s"',this.readyState)},Socket.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Socket.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},Socket.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){debug("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},Socket.prototype.ping=function(){this.sendPacket("ping")},Socket.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},Socket.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(debug("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Socket.prototype.write=Socket.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},Socket.prototype.sendPacket=function(e,t,r){if("closing"!=this.readyState&&"closed"!=this.readyState){var s={type:e,data:t};this.emit("packetCreate",s),this.writeBuffer.push(s),this.callbackBuffer.push(r),this.flush()}},Socket.prototype.close=function(){function e(){s.onClose("forced close"),debug("socket closing - telling transport to close"),s.transport.close()}function t(){s.removeListener("upgrade",t),s.removeListener("upgradeError",t),e()}function r(){s.once("upgrade",t),s.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var s=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():e()}):this.upgrading?r():e()}return this},Socket.prototype.onError=function(e){debug("socket error %j",e),Socket.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},Socket.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){debug('socket close with reason: "%s"',e);var r=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){r.writeBuffer=[],r.callbackBuffer=[],r.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},Socket.prototype.filterUpgrades=function(e){for(var t=[],r=0,s=e.length;s>r;r++)~index(this.transports,e[r])&&t.push(e[r]);return t};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./transport":215,"./transports":216,"component-emitter":100,"debug":222,"engine.io-parser":225,"indexof":197,"parsejson":201,"parseqs":202,"parseuri":224}],215:[function(_dereq_,module,exports){
function Transport(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized}var parser=_dereq_("engine.io-parser"),Emitter=_dereq_("component-emitter");module.exports=Transport,Emitter(Transport.prototype),Transport.timestamps=0,Transport.prototype.onError=function(t,e){var r=new Error(t);return r.type="TransportError",r.description=e,this.emit("error",r),this},Transport.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},Transport.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},Transport.prototype.send=function(t){if("open"!=this.readyState)throw new Error("Transport not open");this.write(t)},Transport.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},Transport.prototype.onData=function(t){var e=parser.decodePacket(t,this.socket.binaryType);this.onPacket(e)},Transport.prototype.onPacket=function(t){this.emit("packet",t)},Transport.prototype.onClose=function(){this.readyState="closed",this.emit("close")};

},{"component-emitter":100,"engine.io-parser":225}],216:[function(_dereq_,module,exports){
(function (global){
function polling(e){var o,t=!1,r=!1,n=!1!==e.jsonp;if(global.location){var i="https:"==location.protocol,l=location.port;l||(l=i?443:80),t=e.hostname!=location.hostname||l!=e.port,r=e.secure!=i}if(e.xdomain=t,e.xscheme=r,o=new XMLHttpRequest(e),"open"in o&&!e.forceJSONP)return new XHR(e);if(!n)throw new Error("JSONP disabled");return new JSONP(e)}var XMLHttpRequest=_dereq_("xmlhttprequest"),XHR=_dereq_("./polling-xhr"),JSONP=_dereq_("./polling-jsonp"),websocket=_dereq_("./websocket");exports.polling=polling,exports.websocket=websocket;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./polling-jsonp":217,"./polling-xhr":218,"./websocket":220,"xmlhttprequest":221}],217:[function(_dereq_,module,exports){
(function (global){
function empty(){}function JSONPPolling(e){Polling.call(this,e),this.query=this.query||{},callbacks||(global.___eio||(global.___eio=[]),callbacks=global.___eio),this.index=callbacks.length;var t=this;callbacks.push(function(e){t.onData(e)}),this.query.j=this.index,global.document&&global.addEventListener&&global.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=empty)},!1)}var Polling=_dereq_("./polling"),inherit=_dereq_("component-inherit");module.exports=JSONPPolling;var rNewline=/\n/g,rEscapedNewline=/\\n/g,callbacks,index=0;inherit(JSONPPolling,Polling),JSONPPolling.prototype.supportsBinary=!1,JSONPPolling.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Polling.prototype.doClose.call(this)},JSONPPolling.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(t,i),this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},JSONPPolling.prototype.doWrite=function(e,t){function i(){r(),t()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+o.iframeId+'">';n=document.createElement(t)}catch(e){n=document.createElement("iframe"),n.name=o.iframeId,n.src="javascript:0"}n.id=o.iframeId,o.form.appendChild(n),o.iframe=n}var o=this;if(!this.form){var n,a=document.createElement("form"),l=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=s,a.method="POST",a.setAttribute("accept-charset","utf-8"),l.name="d",a.appendChild(l),document.body.appendChild(a),this.form=a,this.area=l}this.form.action=this.uri(),r(),e=e.replace(rEscapedNewline,"\\\n"),this.area.value=e.replace(rNewline,"\\n");try{this.form.submit()}catch(c){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==o.iframe.readyState&&i()}:this.iframe.onload=i};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./polling":219,"component-inherit":101}],218:[function(_dereq_,module,exports){
(function (global){
function empty(){}function XHR(t){if(Polling.call(this,t),global.location){var e="https:"==location.protocol,s=location.port;s||(s=e?443:80),this.xd=t.hostname!=global.location.hostname||s!=t.port,this.xs=t.secure!=e}}function Request(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!=t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.create()}function unloadHandler(){for(var t in Request.requests)Request.requests.hasOwnProperty(t)&&Request.requests[t].abort()}var XMLHttpRequest=_dereq_("xmlhttprequest"),Polling=_dereq_("./polling"),Emitter=_dereq_("component-emitter"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:polling-xhr");module.exports=XHR,module.exports.Request=Request,inherit(XHR,Polling),XHR.prototype.supportsBinary=!0,XHR.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,new Request(t)},XHR.prototype.doWrite=function(t,e){var s="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:s}),i=this;r.on("success",e),r.on("error",function(t){i.onError("xhr post error",t)}),this.sendXhr=r},XHR.prototype.doPoll=function(){debug("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},Emitter(Request.prototype),Request.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new XMLHttpRequest(t),s=this;try{if(debug("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async),this.supportsBinary&&(e.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}"withCredentials"in e&&(e.withCredentials=!0),this.hasXDR()?(e.onload=function(){s.onLoad()},e.onerror=function(){s.onError(e.responseText)}):e.onreadystatechange=function(){4==e.readyState&&(200==e.status||1223==e.status?s.onLoad():setTimeout(function(){s.onError(e.status)},0))},debug("xhr data %s",this.data),e.send(this.data)}catch(r){return void setTimeout(function(){s.onError(r)},0)}global.document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)},Request.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Request.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},Request.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},Request.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=empty:this.xhr.onreadystatechange=empty,t)try{this.xhr.abort()}catch(e){}global.document&&delete Request.requests[this.index],this.xhr=null}},Request.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(s){}t="application/octet-stream"===e?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(s){this.onError(s)}null!=t&&this.onData(t)},Request.prototype.hasXDR=function(){return"undefined"!=typeof global.XDomainRequest&&!this.xs&&this.enablesXDR},Request.prototype.abort=function(){this.cleanup()},global.document&&(Request.requestsCount=0,Request.requests={},global.attachEvent?global.attachEvent("onunload",unloadHandler):global.addEventListener&&global.addEventListener("beforeunload",unloadHandler,!1));

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./polling":219,"component-emitter":100,"component-inherit":101,"debug":222,"xmlhttprequest":221}],219:[function(_dereq_,module,exports){
function Polling(t){var e=t&&t.forceBase64;(!hasXHR2||e)&&(this.supportsBinary=!1),Transport.call(this,t)}var Transport=_dereq_("../transport"),parseqs=_dereq_("parseqs"),parser=_dereq_("engine.io-parser"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:polling");module.exports=Polling;var hasXHR2=function(){var t=_dereq_("xmlhttprequest"),e=new t({xdomain:!1});return null!=e.responseType}();inherit(Polling,Transport),Polling.prototype.name="polling",Polling.prototype.doOpen=function(){this.poll()},Polling.prototype.pause=function(t){function e(){debug("paused"),i.readyState="paused",t()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var o=0;this.polling&&(debug("we are currently polling - waiting to pause"),o++,this.once("pollComplete",function(){debug("pre-pause polling complete"),--o||e()})),this.writable||(debug("we are currently writing - waiting to pause"),o++,this.once("drain",function(){debug("pre-pause writing complete"),--o||e()}))}else e()},Polling.prototype.poll=function(){debug("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Polling.prototype.onData=function(t){var e=this;debug("polling got data %s",t);var i=function(t,i,o){return"opening"==e.readyState&&e.onOpen(),"close"==t.type?(e.onClose(),!1):void e.onPacket(t)};parser.decodePayload(t,this.socket.binaryType,i),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():debug('ignoring poll - transport state "%s"',this.readyState))},Polling.prototype.doClose=function(){function t(){debug("writing close packet"),e.write([{type:"close"}])}var e=this;"open"==this.readyState?(debug("transport open - closing"),t()):(debug("transport not open - deferring close"),this.once("open",t))},Polling.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")},e=this;parser.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,i)})},Polling.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=+new Date+"-"+Transport.timestamps++),this.supportsBinary||t.sid||(t.b64=1),t=parseqs.encode(t),this.port&&("https"==e&&443!=this.port||"http"==e&&80!=this.port)&&(i=":"+this.port),t.length&&(t="?"+t),e+"://"+this.hostname+i+this.path+t};

},{"../transport":215,"component-inherit":101,"debug":222,"engine.io-parser":225,"parseqs":202,"xmlhttprequest":221}],220:[function(_dereq_,module,exports){
function WS(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),Transport.call(this,t)}var Transport=_dereq_("../transport"),parser=_dereq_("engine.io-parser"),parseqs=_dereq_("parseqs"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:websocket"),WebSocket=_dereq_("ws");module.exports=WS,inherit(WS,Transport),WS.prototype.name="websocket",WS.prototype.supportsBinary=!0,WS.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,s={agent:this.agent};s.pfx=this.pfx,s.key=this.key,s.passphrase=this.passphrase,s.cert=this.cert,s.ca=this.ca,s.ciphers=this.ciphers,s.rejectUnauthorized=this.rejectUnauthorized,this.ws=new WebSocket(t,e,s),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},WS.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(WS.prototype.onData=function(t){var e=this;setTimeout(function(){Transport.prototype.onData.call(e,t)},0)}),WS.prototype.write=function(t){function e(){s.writable=!0,s.emit("drain")}var s=this;this.writable=!1;for(var r=0,o=t.length;o>r;r++)parser.encodePacket(t[r],this.supportsBinary,function(t){try{s.ws.send(t)}catch(e){debug("websocket closed before onclose event")}});setTimeout(e,0)},WS.prototype.onClose=function(){Transport.prototype.onClose.call(this)},WS.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},WS.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",s="";return this.port&&("wss"==e&&443!=this.port||"ws"==e&&80!=this.port)&&(s=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=+new Date),this.supportsBinary||(t.b64=1),t=parseqs.encode(t),t.length&&(t="?"+t),e+"://"+this.hostname+s+this.path+t},WS.prototype.check=function(){return!(!WebSocket||"__initialize"in WebSocket&&this.name===WS.prototype.name)};

},{"../transport":215,"component-inherit":101,"debug":222,"engine.io-parser":225,"parseqs":202,"ws":232}],221:[function(_dereq_,module,exports){
var hasCORS=_dereq_("has-cors");module.exports=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||hasCORS))return new XMLHttpRequest}catch(a){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(a){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}};

},{"has-cors":228}],222:[function(_dereq_,module,exports){
function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var o=arguments,e=this.useColors;if(o[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+o[0]+(e?"%c ":" ")+"+"+exports.humanize(this.diff),!e)return o;var r="color: "+this.color;o=[o[0],r,"color: inherit"].concat(Array.prototype.slice.call(o,1));var t=0,n=0;return o[0].replace(/%[a-z%]/g,function(o){"%%"!==o&&(t++,"%c"===o&&(n=t))}),o.splice(n,0,r),o}function log(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(o){try{null==o?localStorage.removeItem("debug"):localStorage.debug=o}catch(e){}}function load(){var o;try{o=localStorage.debug}catch(e){}return o}exports=module.exports=_dereq_("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(o){return JSON.stringify(o)},exports.enable(load());

},{"./debug":223}],223:[function(_dereq_,module,exports){
function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(e){function r(){}function o(){var e=o,r=+new Date,s=r-(prevTime||r);e.diff=s,e.prev=prevTime,e.curr=r,prevTime=r,null==e.useColors&&(e.useColors=exports.useColors()),null==e.color&&e.useColors&&(e.color=selectColor());var t=Array.prototype.slice.call(arguments);t[0]=exports.coerce(t[0]),"string"!=typeof t[0]&&(t=["%o"].concat(t));var n=0;t[0]=t[0].replace(/%([a-z%])/g,function(r,o){if("%%"===r)return r;n++;var s=exports.formatters[o];if("function"==typeof s){var p=t[n];r=s.call(e,p),t.splice(n,1),n--}return r}),"function"==typeof exports.formatArgs&&(t=exports.formatArgs.apply(e,t));var p=o.log||exports.log||void 0;p.apply(e,t)}r.enabled=!1,o.enabled=!0;var s=exports.enabled(e)?o:r;return s.namespace=e,s}function enable(e){exports.save(e);for(var r=(e||"").split(/[\s,]+/),o=r.length,s=0;o>s;s++)r[s]&&(e=r[s].replace(/\*/g,".*?"),"-"===e[0]?exports.skips.push(new RegExp("^"+e.substr(1)+"$")):exports.names.push(new RegExp("^"+e+"$")))}function disable(){exports.enable("")}function enabled(e){var r,o;for(r=0,o=exports.skips.length;o>r;r++)if(exports.skips[r].test(e))return!1;for(r=0,o=exports.names.length;o>r;r++)if(exports.names[r].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}exports=module.exports=debug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=_dereq_("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevColor=0,prevTime;

},{"ms":229}],224:[function(_dereq_,module,exports){
var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function(r){var e=r,t=r.indexOf("["),s=r.indexOf("]");-1!=t&&-1!=s&&(r=r.substring(0,t)+r.substring(t,s).replace(/:/g,";")+r.substring(s,r.length));for(var o=re.exec(r||""),a={},u=14;u--;)a[parts[u]]=o[u]||"";return-1!=t&&-1!=s&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a};

},{}],225:[function(_dereq_,module,exports){
(function (global){
function encodeBase64Object(e,r){var t="b"+exports.packets[e.type]+e.data.data;return r(t)}function encodeArrayBuffer(e,r,t){if(!r)return exports.encodeBase64Packet(e,t);var n=e.data,a=new Uint8Array(n),o=new Uint8Array(1+n.byteLength);o[0]=packets[e.type];for(var f=0;f<a.length;f++)o[f+1]=a[f];return t(o.buffer)}function encodeBlobAsArrayBuffer(e,r,t){if(!r)return exports.encodeBase64Packet(e,t);var n=new FileReader;return n.onload=function(){e.data=n.result,exports.encodePacket(e,r,!0,t)},n.readAsArrayBuffer(e.data)}function encodeBlob(e,r,t){if(!r)return exports.encodeBase64Packet(e,t);if(dontSendBlobs)return encodeBlobAsArrayBuffer(e,r,t);var n=new Uint8Array(1);n[0]=packets[e.type];var a=new Blob([n.buffer,e.data]);return t(a)}function map(e,r,t){for(var n=new Array(e.length),a=after(e.length,t),o=function(e,t,a){r(t,function(r,t){n[e]=t,a(r,n)})},f=0;f<e.length;f++)o(f,e[f],a)}var keys=_dereq_("./keys"),hasBinary=_dereq_("has-binary"),sliceBuffer=_dereq_("arraybuffer.slice"),base64encoder=_dereq_("base64-arraybuffer"),after=_dereq_("after"),utf8=_dereq_("utf8"),isAndroid=navigator.userAgent.match(/Android/i),isPhantomJS=/PhantomJS/i.test(navigator.userAgent),dontSendBlobs=isAndroid||isPhantomJS;exports.protocol=3;var packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},packetslist=keys(packets),err={type:"error",data:"parser error"},Blob=_dereq_("blob");exports.encodePacket=function(e,r,t,n){"function"==typeof r&&(n=r,r=!1),"function"==typeof t&&(n=t,t=null);var a=void 0===e.data?void 0:e.data.buffer||e.data;if(global.ArrayBuffer&&a instanceof ArrayBuffer)return encodeArrayBuffer(e,r,n);if(Blob&&a instanceof global.Blob)return encodeBlob(e,r,n);if(a&&a.base64)return encodeBase64Object(e,n);var o=packets[e.type];return void 0!==e.data&&(o+=t?utf8.encode(String(e.data)):String(e.data)),n(""+o)},exports.encodeBase64Packet=function(e,r){var t="b"+exports.packets[e.type];if(Blob&&e.data instanceof Blob){var n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];r(t+e)},n.readAsDataURL(e.data)}var a;try{a=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(o){for(var f=new Uint8Array(e.data),i=new Array(f.length),u=0;u<f.length;u++)i[u]=f[u];a=String.fromCharCode.apply(null,i)}return t+=global.btoa(a),r(t)},exports.decodePacket=function(e,r,t){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return exports.decodeBase64Packet(e.substr(1),r);if(t)try{e=utf8.decode(e)}catch(n){return err}var a=e.charAt(0);return Number(a)==a&&packetslist[a]?e.length>1?{type:packetslist[a],data:e.substring(1)}:{type:packetslist[a]}:err}var o=new Uint8Array(e),a=o[0],f=sliceBuffer(e,1);return Blob&&"blob"===r&&(f=new Blob([f])),{type:packetslist[a],data:f}},exports.decodeBase64Packet=function(e,r){var t=packetslist[e.charAt(0)];if(!global.ArrayBuffer)return{type:t,data:{base64:!0,data:e.substr(1)}};var n=base64encoder.decode(e.substr(1));return"blob"===r&&Blob&&(n=new Blob([n])),{type:t,data:n}},exports.encodePayload=function(e,r,t){function n(e){return e.length+":"+e}function a(e,t){exports.encodePacket(e,o?r:!1,!0,function(e){t(null,n(e))})}"function"==typeof r&&(t=r,r=null);var o=hasBinary(e);return r&&o?Blob&&!dontSendBlobs?exports.encodePayloadAsBlob(e,t):exports.encodePayloadAsArrayBuffer(e,t):e.length?void map(e,a,function(e,r){return t(r.join(""))}):t("0:")},exports.decodePayload=function(e,r,t){if("string"!=typeof e)return exports.decodePayloadAsBinary(e,r,t);"function"==typeof r&&(t=r,r=null);var n;if(""==e)return t(err,0,1);for(var a,o,f="",i=0,u=e.length;u>i;i++){var c=e.charAt(i);if(":"!=c)f+=c;else{if(""==f||f!=(a=Number(f)))return t(err,0,1);if(o=e.substr(i+1,a),f!=o.length)return t(err,0,1);if(o.length){if(n=exports.decodePacket(o,r,!0),err.type==n.type&&err.data==n.data)return t(err,0,1);var s=t(n,i+a,u);if(!1===s)return}i+=a,f=""}}return""!=f?t(err,0,1):void 0},exports.encodePayloadAsArrayBuffer=function(e,r){function t(e,r){exports.encodePacket(e,!0,!0,function(e){return r(null,e)})}return e.length?void map(e,t,function(e,t){var n=t.reduce(function(e,r){var t;return t="string"==typeof r?r.length:r.byteLength,e+t.toString().length+t+2},0),a=new Uint8Array(n),o=0;return t.forEach(function(e){var r="string"==typeof e,t=e;if(r){for(var n=new Uint8Array(e.length),f=0;f<e.length;f++)n[f]=e.charCodeAt(f);t=n.buffer}r?a[o++]=0:a[o++]=1;for(var i=t.byteLength.toString(),f=0;f<i.length;f++)a[o++]=parseInt(i[f]);a[o++]=255;for(var n=new Uint8Array(t),f=0;f<n.length;f++)a[o++]=n[f]}),r(a.buffer)}):r(new ArrayBuffer(0))},exports.encodePayloadAsBlob=function(e,r){function t(e,r){exports.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);e=n.buffer,t[0]=0}for(var o=e instanceof ArrayBuffer?e.byteLength:e.size,f=o.toString(),i=new Uint8Array(f.length+1),a=0;a<f.length;a++)i[a]=parseInt(f[a]);if(i[f.length]=255,Blob){var u=new Blob([t.buffer,i.buffer,e]);r(null,u)}})}map(e,t,function(e,t){return r(new Blob(t))})},exports.decodePayloadAsBinary=function(e,r,t){"function"==typeof r&&(t=r,r=null);for(var n=e,a=[],o=!1;n.byteLength>0;){for(var f=new Uint8Array(n),i=0===f[0],u="",c=1;255!=f[c];c++){if(u.length>310){o=!0;break}u+=f[c]}if(o)return t(err,0,1);n=sliceBuffer(n,2+u.length),u=parseInt(u);var s=sliceBuffer(n,0,u);if(i)try{s=String.fromCharCode.apply(null,new Uint8Array(s))}catch(l){var d=new Uint8Array(s);s="";for(var c=0;c<d.length;c++)s+=String.fromCharCode(d[c])}a.push(s),n=sliceBuffer(n,u)}var p=a.length;a.forEach(function(e,n){t(exports.decodePacket(e,r,!0),n,p)})};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./keys":226,"after":68,"arraybuffer.slice":69,"base64-arraybuffer":98,"blob":210,"has-binary":227,"utf8":231}],226:[function(_dereq_,module,exports){
module.exports=Object.keys||function(r){var e=[],t=Object.prototype.hasOwnProperty;for(var o in r)t.call(r,o)&&e.push(o);return e};

},{}],227:[function(_dereq_,module,exports){
(function (global){
function hasBinary(r){function e(r){if(!r)return!1;if(global.Buffer&&global.Buffer.isBuffer(r)||global.ArrayBuffer&&r instanceof ArrayBuffer||global.Blob&&r instanceof Blob||global.File&&r instanceof File)return!0;if(isArray(r)){for(var f=0;f<r.length;f++)if(e(r[f]))return!0}else if(r&&"object"==typeof r){r.toJSON&&(r=r.toJSON());for(var a in r)if(r.hasOwnProperty(a)&&e(r[a]))return!0}return!1}return e(r)}var isArray=_dereq_("isarray");module.exports=hasBinary;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"isarray":198}],228:[function(_dereq_,module,exports){
var global=_dereq_("global");try{module.exports="XMLHttpRequest"in global&&"withCredentials"in new global.XMLHttpRequest}catch(err){module.exports=!1}

},{"global":196}],229:[function(_dereq_,module,exports){
function parse(e){var r=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(r){var a=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"y":return a*y;case"days":case"day":case"d":return a*d;case"hours":case"hour":case"h":return a*h;case"minutes":case"minute":case"m":return a*m;case"seconds":case"second":case"s":return a*s;case"ms":return a}}}function short(e){return e>=d?Math.round(e/d)+"d":e>=h?Math.round(e/h)+"h":e>=m?Math.round(e/m)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function long(e){return plural(e,d,"day")||plural(e,h,"hour")||plural(e,m,"minute")||plural(e,s,"second")||e+" ms"}function plural(s,e,r){return e>s?void 0:1.5*e>s?Math.floor(s/e)+" "+r:Math.ceil(s/e)+" "+r+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(s,e){return e=e||{},"string"==typeof s?parse(s):e["long"]?long(s):short(s)};

},{}],230:[function(_dereq_,module,exports){
var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function(r){for(var t=re.exec(r||""),e={},o=14;o--;)e[parts[o]]=t[o]||"";return e};

},{}],231:[function(_dereq_,module,exports){
(function (global){
!function(r){function e(r){for(var e,n,t=[],o=0,i=r.length;i>o;)e=r.charCodeAt(o++),e>=55296&&56319>=e&&i>o?(n=r.charCodeAt(o++),56320==(64512&n)?t.push(((1023&e)<<10)+(1023&n)+65536):(t.push(e),o--)):t.push(e);return t}function n(r){for(var e,n=r.length,t=-1,o="";++t<n;)e=r[t],e>65535&&(e-=65536,o+=s(e>>>10&1023|55296),e=56320|1023&e),o+=s(e);return o}function t(r,e){return s(r>>e&63|128)}function o(r){if(0==(4294967168&r))return s(r);var e="";return 0==(4294965248&r)?e=s(r>>6&31|192):0==(4294901760&r)?(e=s(r>>12&15|224),e+=t(r,6)):0==(4292870144&r)&&(e=s(r>>18&7|240),e+=t(r,12),e+=t(r,6)),e+=s(63&r|128)}function i(r){for(var n,t=e(r),i=t.length,f=-1,u="";++f<i;)n=t[f],u+=o(n);return u}function f(){if(p>=v)throw Error("Invalid byte index");var r=255&h[p];if(p++,128==(192&r))return 63&r;throw Error("Invalid continuation byte")}function u(){var r,e,n,t,o;if(p>v)throw Error("Invalid byte index");if(p==v)return!1;if(r=255&h[p],p++,0==(128&r))return r;if(192==(224&r)){var e=f();if(o=(31&r)<<6|e,o>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&r)){if(e=f(),n=f(),o=(15&r)<<12|e<<6|n,o>=2048)return o;throw Error("Invalid continuation byte")}if(240==(248&r)&&(e=f(),n=f(),t=f(),o=(15&r)<<18|e<<12|n<<6|t,o>=65536&&1114111>=o))return o;throw Error("Invalid UTF-8 detected")}function a(r){h=e(r),v=h.length,p=0;for(var t,o=[];(t=u())!==!1;)o.push(t);return n(o)}var d="object"==typeof exports&&exports,l="object"==typeof module&&module&&module.exports==d&&module,c="object"==typeof global&&global;(c.global===c||c.window===c)&&(r=c);var h,v,p,s=String.fromCharCode,b={version:"2.0.0",encode:i,decode:a};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return b});else if(d&&!d.nodeType)if(l)l.exports=b;else{var y={},w=y.hasOwnProperty;for(var g in b)w.call(b,g)&&(d[g]=b[g])}else r.utf8=b}(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],232:[function(_dereq_,module,exports){
function ws(e,o,t){var b;return b=o?new WebSocket(e,o):new WebSocket(e)}var global=function(){return this}(),WebSocket=global.WebSocket||global.MozWebSocket;module.exports=WebSocket?ws:null,WebSocket&&(ws.prototype=WebSocket.prototype);

},{}],233:[function(_dereq_,module,exports){
(function (global){
var isArray=_dereq_("isarray"),isBuf=_dereq_("./is-buffer");exports.deconstructPacket=function(r){function e(r){if(!r)return r;if(isBuf(r)){var n={_placeholder:!0,num:t.length};return t.push(r),n}if(isArray(r)){for(var a=new Array(r.length),i=0;i<r.length;i++)a[i]=e(r[i]);return a}if("object"==typeof r&&!(r instanceof Date)){var a={};for(var f in r)a[f]=e(r[f]);return a}return r}var t=[],n=r.data,a=r;return a.data=e(n),a.attachments=t.length,{packet:a,buffers:t}},exports.reconstructPacket=function(r,e){function t(r){if(r&&r._placeholder){var n=e[r.num];return n}if(isArray(r)){for(var a=0;a<r.length;a++)r[a]=t(r[a]);return r}if(r&&"object"==typeof r){for(var i in r)r[i]=t(r[i]);return r}return r}return r.data=t(r.data),r.attachments=void 0,r},exports.removeBlobs=function(r,e){function t(r,i,f){if(!r)return r;if(global.Blob&&r instanceof Blob||global.File&&r instanceof File){n++;var o=new FileReader;o.onload=function(){f?f[i]=this.result:a=this.result,--n||e(a)},o.readAsArrayBuffer(r)}else if(isArray(r))for(var u=0;u<r.length;u++)t(r[u],u,r);else if(r&&"object"==typeof r&&!isBuf(r))for(var s in r)t(r[s],s,r)}var n=0,a=r;t(a),n||e(a)};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./is-buffer":235,"isarray":198}],234:[function(_dereq_,module,exports){
function Encoder(){}function encodeAsString(r){var t="",e=!1;return t+=r.type,(exports.BINARY_EVENT==r.type||exports.BINARY_ACK==r.type)&&(t+=r.attachments,t+="-"),r.nsp&&"/"!=r.nsp&&(e=!0,t+=r.nsp),null!=r.id&&(e&&(t+=",",e=!1),t+=r.id),null!=r.data&&(e&&(t+=","),t+=json.stringify(r.data)),debug("encoded %j as %s",r,t),t}function encodeAsBinary(r,t){function e(r){var e=binary.deconstructPacket(r),o=encodeAsString(e.packet),n=e.buffers;n.unshift(o),t(n)}binary.removeBlobs(r,e)}function Decoder(){this.reconstructor=null}function decodeString(r){var t={},e=0;if(t.type=Number(r.charAt(0)),null==exports.types[t.type])return error();if(exports.BINARY_EVENT==t.type||exports.BINARY_ACK==t.type){for(t.attachments="";"-"!=r.charAt(++e);)t.attachments+=r.charAt(e);t.attachments=Number(t.attachments)}if("/"==r.charAt(e+1))for(t.nsp="";++e;){var o=r.charAt(e);if(","==o)break;if(t.nsp+=o,e+1==r.length)break}else t.nsp="/";var n=r.charAt(e+1);if(""!=n&&Number(n)==n){for(t.id="";++e;){var o=r.charAt(e);if(null==o||Number(o)!=o){--e;break}if(t.id+=r.charAt(e),e+1==r.length)break}t.id=Number(t.id)}if(r.charAt(++e))try{t.data=json.parse(r.substr(e))}catch(s){return error()}return debug("decoded %s as %j",r,t),t}function BinaryReconstructor(r){this.reconPack=r,this.buffers=[]}function error(r){return{type:exports.ERROR,data:"parser error"}}var debug=_dereq_("debug")("socket.io-parser"),json=_dereq_("json3"),isArray=_dereq_("isarray"),Emitter=_dereq_("component-emitter"),binary=_dereq_("./binary"),isBuf=_dereq_("./is-buffer");exports.protocol=4,exports.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],exports.CONNECT=0,exports.DISCONNECT=1,exports.EVENT=2,exports.ACK=3,exports.ERROR=4,exports.BINARY_EVENT=5,exports.BINARY_ACK=6,exports.Encoder=Encoder,exports.Decoder=Decoder,Encoder.prototype.encode=function(r,t){if(debug("encoding packet %j",r),exports.BINARY_EVENT==r.type||exports.BINARY_ACK==r.type)encodeAsBinary(r,t);else{var e=encodeAsString(r);t([e])}},Emitter(Decoder.prototype),Decoder.prototype.add=function(r){var t;if("string"==typeof r)t=decodeString(r),exports.BINARY_EVENT==t.type||exports.BINARY_ACK==t.type?(this.reconstructor=new BinaryReconstructor(t),0==this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!isBuf(r)&&!r.base64)throw new Error("Unknown type: "+r);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(r),t&&(this.reconstructor=null,this.emit("decoded",t))}},Decoder.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},BinaryReconstructor.prototype.takeBinaryData=function(r){if(this.buffers.push(r),this.buffers.length==this.reconPack.attachments){var t=binary.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]};

},{"./binary":233,"./is-buffer":235,"component-emitter":100,"debug":236,"isarray":198,"json3":199}],235:[function(_dereq_,module,exports){
(function (global){
function isBuf(f){return global.Buffer&&global.Buffer.isBuffer(f)||global.ArrayBuffer&&f instanceof ArrayBuffer}module.exports=isBuf;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],236:[function(_dereq_,module,exports){
function debug(e){return debug.enabled(e)?function(n){n=coerce(n);var u=new Date,o=u-(debug[e]||u);debug[e]=u,n=e+" "+n+" +"+debug.humanize(o),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function coerce(e){return e instanceof Error?e.stack||e.message:e}module.exports=debug,debug.names=[],debug.skips=[],debug.enable=function(e){try{localStorage.debug=e}catch(n){}for(var u=(e||"").split(/[\s,]+/),o=u.length,t=0;o>t;t++)e=u[t].replace("*",".*?"),"-"===e[0]?debug.skips.push(new RegExp("^"+e.substr(1)+"$")):debug.names.push(new RegExp("^"+e+"$"))},debug.disable=function(){debug.enable("")},debug.humanize=function(e){var n=1e3,u=6e4,o=60*u;return e>=o?(e/o).toFixed(1)+"h":e>=u?(e/u).toFixed(1)+"m":e>=n?(e/n|0)+"s":e+"ms"},debug.enabled=function(e){for(var n=0,u=debug.skips.length;u>n;n++)if(debug.skips[n].test(e))return!1;for(var n=0,u=debug.names.length;u>n;n++)if(debug.names[n].test(e))return!0;return!1};try{window.localStorage&&debug.enable(localStorage.debug)}catch(e){}

},{}],237:[function(_dereq_,module,exports){
function toArray(r,o){var t=[];o=o||0;for(var a=o||0;a<r.length;a++)t[a-o]=r[a];return t}module.exports=toArray;

},{}],238:[function(_dereq_,module,exports){
!function(i,e){"use strict";var s="0.7.9",o="",r="?",n="function",a="undefined",t="object",w="string",l="major",d="model",p="name",c="type",u="vendor",m="version",f="architecture",g="console",b="mobile",h="tablet",v="smarttv",x="wearable",k="embedded",y={extend:function(i,e){for(var s in e)-1!=="browser cpu device engine os".indexOf(s)&&e[s].length%2===0&&(i[s]=e[s].concat(i[s]));return i},has:function(i,e){return"string"==typeof i?-1!==e.toLowerCase().indexOf(i.toLowerCase()):!1},lowerize:function(i){return i.toLowerCase()},major:function(i){return typeof i===w?i.split(".")[0]:e}},A={rgx:function(){for(var i,s,o,r,w,l,d,p=0,c=arguments;p<c.length&&!l;){var u=c[p],m=c[p+1];if(typeof i===a){i={};for(r in m)w=m[r],typeof w===t?i[w[0]]=e:i[w]=e}for(s=o=0;s<u.length&&!l;)if(l=u[s++].exec(this.getUA()))for(r=0;r<m.length;r++)d=l[++o],w=m[r],typeof w===t&&w.length>0?2==w.length?typeof w[1]==n?i[w[0]]=w[1].call(this,d):i[w[0]]=w[1]:3==w.length?typeof w[1]!==n||w[1].exec&&w[1].test?i[w[0]]=d?d.replace(w[1],w[2]):e:i[w[0]]=d?w[1].call(this,d,w[2]):e:4==w.length&&(i[w[0]]=d?w[3].call(this,d.replace(w[1],w[2])):e):i[w]=d?d:e;p+=2}return i},str:function(i,s){for(var o in s)if(typeof s[o]===t&&s[o].length>0){for(var n=0;n<s[o].length;n++)if(y.has(s[o][n],i))return o===r?e:o}else if(y.has(s[o],i))return o===r?e:o;return i}},E={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},S={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[p,m],[/\s(opr)\/([\w\.]+)/i],[[p,"Opera"],m],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium)\/([\w\.-]+)/i],[p,m],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[p,"IE"],m],[/(edge)\/((\d+)?[\w\.]+)/i],[p,m],[/(yabrowser)\/([\w\.]+)/i],[[p,"Yandex"],m],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[p,m],[/(dolfin)\/([\w\.]+)/i],[[p,"Dolphin"],m],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[p,"Chrome"],m],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[m,[p,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[m,[p,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[m,[p,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[m,p],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[p,[m,A.str,E.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape)\/([\w\.-]+)/i],[[p,"Netscape"],m],[/fxios\/([\w\.-]+)/i],[m,[p,"Firefox"]],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[p,m]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,y.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[f,/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[f,y.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[d,u,[c,h]],[/applecoremedia\/[\w\.]+ \((ipad)/],[d,[u,"Apple"],[c,h]],[/(apple\s{0,1}tv)/i],[[d,"Apple TV"],[u,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,d,[c,h]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[d,[u,"Amazon"],[c,h]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[d,A.str,E.device.amazon.model],[u,"Amazon"],[c,b]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[d,u,[c,b]],[/\((ip[honed|\s\w*]+);/i],[d,[u,"Apple"],[c,b]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,d,[c,b]],[/\(bb10;\s(\w+)/i],[d,[u,"BlackBerry"],[c,b]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],[d,[u,"Asus"],[c,h]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[d,"Xperia Tablet"],[c,h]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[u,"Sony"],[d,"Xperia Phone"],[c,b]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[u,d,[c,g]],[/android.+;\s(shield)\sbuild/i],[d,[u,"Nvidia"],[c,g]],[/(playstation\s[3portablevi]+)/i],[d,[u,"Sony"],[c,g]],[/(sprint\s(\w+))/i],[[u,A.str,E.device.sprint.vendor],[d,A.str,E.device.sprint.model],[c,b]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,d,[c,h]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[d,/_/g," "],[c,b]],[/(nexus\s9)/i],[d,[u,"HTC"],[c,h]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[d,[u,"Microsoft"],[c,g]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[u,"Microsoft"],[c,b]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i],[d,[u,"Motorola"],[c,b]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[d,[u,"Motorola"],[c,h]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],d,[c,h]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],d,[c,b]],[/(samsung);smarttv/i],[u,d,[c,v]],[/\(dtv[\);].+(aquos)/i],[d,[u,"Sharp"],[c,v]],[/sie-(\w+)*/i],[d,[u,"Siemens"],[c,b]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],d,[c,b]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[d,[u,"Acer"],[c,h]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],d,[c,h]],[/(lg) netcast\.tv/i],[u,d,[c,v]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[d,[u,"LG"],[c,b]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[d,[u,"Lenovo"],[c,h]],[/linux;.+((jolla));/i],[u,d,[c,b]],[/((pebble))app\/[\d\.]+\s/i],[u,d,[c,x]],[/android.+;\s(glass)\s\d/i],[d,[u,"Google"],[c,x]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[[d,/_/g," "],[u,"Xiaomi"],[c,b]],[/(mobile|tablet);.+rv\:.+gecko\//i],[[c,y.lowerize],u,d]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[p,m],[/rv\:([\w\.]+).*(gecko)/i],[m,p]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[p,m],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[p,[m,A.str,E.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[p,"Windows"],[m,A.str,E.os.windows.version]],[/\((bb)(10);/i],[[p,"BlackBerry"],m],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[p,m],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[p,"Symbian"],m],[/\((series40);/i],[p],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[p,"Firefox OS"],m],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[p,m],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[p,"Chromium OS"],m],[/(sunos)\s?([\w\.]+\d)*/i],[[p,"Solaris"],m],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[p,m],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[p,"iOS"],[m,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[p,"Mac OS"],[m,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[p,m]]},T=function(e,s){if(!(this instanceof T))return new T(e,s).getResult();var r=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:o),n=s?y.extend(S,s):S;return this.getBrowser=function(){var i=A.rgx.apply(this,n.browser);return i.major=y.major(i.version),i},this.getCPU=function(){return A.rgx.apply(this,n.cpu)},this.getDevice=function(){return A.rgx.apply(this,n.device)},this.getEngine=function(){return A.rgx.apply(this,n.engine)},this.getOS=function(){return A.rgx.apply(this,n.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(i){return r=i,this},this.setUA(r),this};T.VERSION=s,T.BROWSER={NAME:p,MAJOR:l,VERSION:m},T.CPU={ARCHITECTURE:f},T.DEVICE={MODEL:d,VENDOR:u,TYPE:c,CONSOLE:g,MOBILE:b,SMARTTV:v,TABLET:h,WEARABLE:x,EMBEDDED:k},T.ENGINE={NAME:p,VERSION:m},T.OS={NAME:p,VERSION:m},typeof exports!==a?(typeof module!==a&&module.exports&&(exports=module.exports=T),exports.UAParser=T):typeof define===n&&define.amd?define(function(){return T}):i.UAParser=T;var N=i.jQuery||i.Zepto;if(typeof N!==a){var z=new T;N.ua=z.getResult(),N.ua.get=function(){return z.getUA()},N.ua.set=function(i){z.setUA(i);var e=z.getResult();for(var s in e)N.ua[s]=e[s]}}}("object"==typeof window?window:this);

},{}],239:[function(_dereq_,module,exports){
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?void(this._wrapped=n):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.6.0";var A=j.each=j.forEach=function(n,t,e){if(null==n)return n;if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return;return n};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var O="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},j.find=j.detect=function(n,t,r){var e;return k(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var k=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?-1!=n.indexOf(t):k(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,j.property(t))},j.where=function(n,t){return j.filter(n,j.matches(t))},j.findWhere=function(n,t){return j.find(n,j.matches(t))},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);var e=-(1/0),u=-(1/0);return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;o>u&&(e=n,u=o)}),e},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);var e=1/0,u=1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;u>o&&(e=n,u=o)}),e},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=j.values(n)),n[j.random(n.length-1)]):j.shuffle(n).slice(0,Math.max(0,t))};var E=function(n){return null==n?j.identity:j.isFunction(n)?n:j.property(n)};j.sortBy=function(n,t,r){return t=E(t),j.pluck(j.map(n,function(n,e,u){return{value:n,index:e,criteria:t.call(r,n,e,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=E(r),A(t,function(i,a){var o=r.call(e,i,a,t);n(u,o,i)}),u}};j.groupBy=F(function(n,t,r){j.has(n,t)?n[t].push(r):n[t]=[r]}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=E(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.partition=function(n,t){var r=[],e=[];return A(n,function(n){(t(n)?r:e).push(n)}),[r,e]},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.contains(t,n)})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===j&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:j.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=j.now();o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o,c=function(){var l=j.now()-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=j.now();var l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u),i=u=null),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return j.partial(t,n)},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=function(n){if(!j.isObject(n))return[];if(w)return w(n);var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)void 0===n[r]&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return void 0===n},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.constant=function(n){return function(){return n}},j.property=function(n){return function(t){return t[n]}},j.matches=function(n){return function(t){if(t===n)return!0;for(var r in n)if(n[r]!==t[r])return!1;return!0}},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},j.now=Date.now||function(){return(new Date).getTime()};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};T.unescape=j.invert(T.escape);var I={escape:new RegExp("["+j.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(T.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(I[n],function(t){return T[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return j})}).call(this);

},{}]},{},[24])(24)
});